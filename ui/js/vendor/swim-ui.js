// swim-ui-3.9.0; copyright 2015-2019 SWIM.AI inc.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@swim/codec"),require("@swim/structure"),require("@swim/util"),require("@swim/math"),require("@swim/time"),require("@swim/streamlet")):"function"==typeof define&&define.amd?define(["exports","@swim/codec","@swim/structure","@swim/util","@swim/math","@swim/time","@swim/streamlet"],e):e((t=t||self).swim=t.swim||{},t.swim,t.swim,t.swim,t.swim,t.swim,t.swim)}(this,function(t,e,i,r,n,o,s){"use strict";var a=function(){function t(){}return t.prototype.isDefined=function(){return 0!==this.value()},t.prototype.plus=function(e,i){return void 0===i&&(i=this.units()),t.from(this.toValue(i)+t.fromAny(e).toValue(i),i)},t.prototype.opposite=function(e){return void 0===e&&(e=this.units()),t.from(-this.toValue(e),e)},t.prototype.minus=function(e,i){return void 0===i&&(i=this.units()),t.from(this.toValue(i)-t.fromAny(e).toValue(i),i)},t.prototype.times=function(e,i){return void 0===i&&(i=this.units()),t.from(this.toValue(i)*e,i)},t.prototype.divide=function(e,i){return void 0===i&&(i=this.units()),t.from(this.toValue(i)/e,i)},t.prototype.norm=function(e,i){return void 0===i&&(i=this.units()),t.from(this.toValue(i)/t.fromAny(e).toValue(i),i)},t.prototype.deg=function(){return t.deg(this.degValue())},t.prototype.rad=function(){return t.rad(this.radValue())},t.prototype.grad=function(){return t.grad(this.gradValue())},t.prototype.turn=function(){return t.turn(this.turnValue())},t.prototype.toValue=function(t){switch(t){case"deg":return this.degValue();case"grad":return this.gradValue();case"rad":return this.radValue();case"turn":return this.turnValue();default:throw new Error("unknown angle units: "+t)}},t.prototype.to=function(t){switch(t){case"deg":return this.deg();case"grad":return this.grad();case"rad":return this.rad();case"turn":return this.turn();default:throw new Error("unknown angle units: "+t)}},t.zero=function(e){return void 0===e&&(e="rad"),t.from(0,e)},t.deg=function(e){return new t.Deg(e)},t.rad=function(e){return new t.Rad(e)},t.grad=function(e){return new t.Grad(e)},t.turn=function(e){return new t.Turn(e)},t.from=function(e,i){switch(void 0===i&&(i="rad"),i){case"deg":return t.deg(e);case"rad":return t.rad(e);case"grad":return t.grad(e);case"turn":return t.turn(e);default:throw new Error("unknown angle units: "+i)}},t.fromAny=function(e,i){if(e instanceof t)return e;if("number"==typeof e)return t.from(e,i);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.fromValue=function(e){if(2===e.length){var r=e.getItem(0).numberValue(),n=e.getItem(1);if(void 0!==r&&isFinite(r)&&n instanceof i.Attr&&n.toValue()===i.Value.extant())switch(n.key.value){case"deg":return t.deg(r);case"rad":return t.rad(r);case"grad":return t.grad(r);case"turn":return t.turn(r)}}},t.parse=function(i,r){for(var n=e.Unicode.stringInput(i);n.isCont()&&e.Unicode.isWhitespace(n.head());)n=n.step();var o=t.Parser.parse(n,r);if(o.isDone())for(;n.isCont()&&e.Unicode.isWhitespace(n.head());)n=n.step();return n.isCont()&&!o.isError()&&(o=e.Parser.error(e.Diagnostic.unexpected(n))),o.bind()},t.form=function(e,i){return void 0!==i&&(i=t.fromAny(i)),void 0!==e||void 0!==i?new t.Form(e,i):(t._form||(t._form=new t.Form),t._form)},t.PI=Math.PI,t.TAU=2*t.PI,t}(),u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function h(t,e){function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}function l(t,e,i,r){var n,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s}var p=function(t){function e(e){var i=t.call(this)||this;return i._value=e,i}return h(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return"deg"},e.prototype.degValue=function(){return this._value},e.prototype.gradValue=function(){return 10*this._value/9},e.prototype.radValue=function(){return this._value*a.PI/180},e.prototype.turnValue=function(){return this._value/360},e.prototype.deg=function(){return this},e.prototype.equals=function(t){return t instanceof e&&this._value===t._value},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=r.Murmur3.seed(e)),r.Murmur3.mash(r.Murmur3.mix(e._hashSeed,r.Murmur3.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Angle").write(46).write("deg").write(40).debug(this._value).write(41)},e.prototype.toString=function(){return this._value+"deg"},e}(a);a.Deg=p;var c=function(t){function e(e){var i=t.call(this)||this;return i._value=e,i}return h(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return"rad"},e.prototype.degValue=function(){return 180*this._value/a.PI},e.prototype.gradValue=function(){return 200*this._value/a.PI},e.prototype.radValue=function(){return this._value},e.prototype.turnValue=function(){return this._value/a.TAU},e.prototype.rad=function(){return this},e.prototype.equals=function(t){return t instanceof e&&this._value===t._value},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=r.Murmur3.seed(e)),r.Murmur3.mash(r.Murmur3.mix(e._hashSeed,r.Murmur3.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Angle").write(46).write("rad").write(40).debug(this._value).write(41)},e.prototype.toString=function(){return this._value+"rad"},e}(a);a.Rad=c;var d=function(t){function e(e){var i=t.call(this)||this;return i._value=e,i}return h(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return"grad"},e.prototype.degValue=function(){return.9*this._value},e.prototype.gradValue=function(){return this._value},e.prototype.radValue=function(){return this._value*a.PI/200},e.prototype.turnValue=function(){return this._value/400},e.prototype.grad=function(){return this},e.prototype.equals=function(t){return t instanceof e&&this._value===t._value},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=r.Murmur3.seed(e)),r.Murmur3.mash(r.Murmur3.mix(e._hashSeed,r.Murmur3.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Angle").write(46).write("grad").write(40).debug(this._value).write(41)},e.prototype.toString=function(){return this._value+"grad"},e}(a);a.Grad=d;var f=function(t){function e(e){var i=t.call(this)||this;return i._value=e,i}return h(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return"turn"},e.prototype.degValue=function(){return 360*this._value},e.prototype.gradValue=function(){return 400*this._value},e.prototype.radValue=function(){return this._value*a.TAU},e.prototype.turnValue=function(){return this._value},e.prototype.turn=function(){return this},e.prototype.equals=function(t){return t instanceof e&&this._value===t._value},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=r.Murmur3.seed(e)),r.Murmur3.mash(r.Murmur3.mix(e._hashSeed,r.Murmur3.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Angle").write(46).write("turn").write(40).debug(this._value).write(41)},e.prototype.toString=function(){return this._value+"turn"},e}(a);a.Turn=f;var v=function(t){function i(e,i,r,n){var o=t.call(this)||this;return o._defaultUnits=e,o._valueParser=i,o._unitsOutput=r,o._step=n,o}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this._defaultUnits,this._valueParser,this._unitsOutput,this._step)},i.parse=function(t,r,n,o,s){void 0===s&&(s=1);var u=0;if(1===s)if((n=n?n.feed(t):e.Base10.parseDecimal(t)).isDone())s=2;else if(n.isError())return n.asError();if(2===s){for(o=o||e.Unicode.stringOutput();t.isCont()&&(u=t.head(),e.Unicode.isAlpha(u));)t=t.step(),o.push(u);if(!t.isEmpty()){var h=n.bind(),l=o.bind()||r;switch(l){case"deg":return e.Parser.done(a.deg(h));case"":case"rad":return e.Parser.done(a.rad(h));case"grad":return e.Parser.done(a.grad(h));case"turn":return e.Parser.done(a.turn(h));default:return e.Parser.error(e.Diagnostic.message("unknown units: "+l,t))}}}return new i(r,n,o,s)},i}(e.Parser);a.Parser=v;var y=function(t){function e(e,i){var r=t.call(this)||this;return r._defaultUnits=e,r._unit=i,r}return h(e,t),e.prototype.unit=function(t){return 0===arguments.length?void 0!==this._unit?this._unit:a.zero(this._defaultUnits):new e(this._defaultUnits,t)},e.prototype.mold=function(t){return t=a.fromAny(t,this._defaultUnits),i.Text.from(t.toString())},e.prototype.cast=function(t){var e,i=t.toValue();try{if(!(e=a.fromValue(i))){var r=i.stringValue(void 0);void 0!==r&&(e=a.parse(r,this._defaultUnits))}}catch(t){}return e},e}(i.Form);a.Form=y;var m=function(){function t(){}return t.prototype.isDefined=function(){return 0!==this.value()},t.prototype.plus=function(e,i){return void 0===i&&(i=this.units()),t.from(this.toValue(i)+t.fromAny(e).toValue(i),i)},t.prototype.opposite=function(e){return void 0===e&&(e=this.units()),t.from(-this.toValue(e),e)},t.prototype.minus=function(e,i){return void 0===i&&(i=this.units()),t.from(this.toValue(i)-t.fromAny(e).toValue(i),i)},t.prototype.times=function(e,i){return void 0===i&&(i=this.units()),t.from(this.toValue(i)*e,i)},t.prototype.divide=function(e,i){return void 0===i&&(i=this.units()),t.from(this.toValue(i)/e,i)},t.prototype.emValue=function(){return this.pxValue()/t.emUnit(this.node())},t.prototype.remValue=function(){return this.pxValue()/t.remUnit()},t.prototype.pctValue=function(){return this.px().value()/this.unitValue()},t.prototype.px=function(e){return t.px(this.pxValue(e),this.node())},t.prototype.em=function(){return t.em(this.emValue(),this.node())},t.prototype.rem=function(){return t.rem(this.remValue(),this.node())},t.prototype.pct=function(){return t.pct(this.pctValue(),this.node())},t.prototype.toValue=function(t){switch(t){case"px":return this.pxValue();case"em":return this.emValue();case"rem":return this.remValue();case"%":return this.pctValue();default:throw new Error("unknown length units: "+t)}},t.prototype.to=function(t){switch(t){case"px":return this.px();case"em":return this.em();case"rem":return this.rem();case"%":return this.pct();default:throw new Error("unknown length units: "+t)}},t.zero=function(e,i){return t.from(0,e,i)},t.px=function(e,i){return new t.Px(e,i)},t.em=function(e,i){return new t.Em(e,i)},t.rem=function(e,i){return new t.Rem(e,i)},t.pct=function(e,i){return new t.Pct(e,i)},t.unitless=function(e,i){return new t.Unitless(e,i)},t.from=function(e,i,r){switch("string"!=typeof i&&(r=i,i="px"),i){case"px":return t.px(e,r);case"em":return t.em(e,r);case"rem":return t.rem(e,r);case"%":return t.pct(e,r);case"":return t.unitless(e,r);default:throw new Error("unknown length units: "+i)}},t.fromAny=function(e,i,r){if("string"!=typeof i&&(r=i,i=void 0),e instanceof t)return e;if("number"==typeof e)return t.from(e,i,r);if("string"==typeof e&&"string"!=typeof i)return t.parse(e,i,r);throw new TypeError(""+e)},t.fromValue=function(e,r){if(2===e.length){var n=e.getItem(0).numberValue(void 0),o=e.getItem(1);if(void 0!==n&&isFinite(n)&&o instanceof i.Attr&&o.toValue()===i.Value.extant())switch(o.key.value){case"px":return t.px(n,r);case"em":return t.em(n,r);case"rem":return t.rem(n,r);case"pct":return t.pct(n,r)}}},t.parse=function(i,r,n){"string"!=typeof r&&(n=r,r=void 0);for(var o=e.Unicode.stringInput(i);o.isCont()&&e.Unicode.isWhitespace(o.head());)o=o.step();var s=t.Parser.parse(o,r,n);if(s.isDone())for(;o.isCont()&&e.Unicode.isWhitespace(o.head());)o=o.step();return o.isCont()&&!s.isError()&&(s=e.Parser.error(e.Diagnostic.unexpected(o))),s.bind()},t.form=function(e,i,r){return void 0!==r&&(r=t.fromAny(r)),void 0!==e||i||void 0!==r?new t.Form(e,i,r):(t._form||(t._form=new t.Form),t._form)},t.widthUnit=function(t){for(;t;){if(t instanceof HTMLElement&&t.offsetParent instanceof HTMLElement)return t.offsetParent.offsetWidth;t=t.parentNode||void 0}return 0},t.emUnit=function(t){for(;t;){if(t instanceof Element){var e=getComputedStyle(t).fontSize;if(null!==e)return parseFloat(e)}t=t.parentNode||void 0}return 0},t.remUnit=function(){var t=getComputedStyle(document.documentElement).fontSize;return null!==t?parseFloat(t):0},t}(),w=function(t){function e(e,i){var r=t.call(this)||this;return r._value=e,r._node=i,r}return h(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return"px"},e.prototype.unitValue=function(){return 1},e.prototype.node=function(){return this._node},e.prototype.pxValue=function(){return this._value},e.prototype.px=function(){return this},e.prototype.equals=function(t){return t instanceof e&&(this._value===t._value&&this._node===t._node)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=r.Murmur3.seed(e)),r.Murmur3.mash(r.Murmur3.mix(e._hashSeed,r.Murmur3.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Length").write(46).write("px").write(40).debug(this._value),this._node&&(t=t.write(", ").debug(this._node)),t=t.write(41)},e.prototype.toString=function(){return this._value+"px"},e}(m);m.Px=w;var g=function(t){function e(e,i){var r=t.call(this)||this;return r._value=e,r._node=i,r}return h(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return"em"},e.prototype.node=function(){return this._node},e.prototype.unitValue=function(){return m.emUnit(this._node)},e.prototype.pxValue=function(){return this.unitValue()*this._value},e.prototype.em=function(){return this},e.prototype.equals=function(t){return t instanceof e&&(this._value===t._value&&this._node===t._node)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=r.Murmur3.seed(e)),r.Murmur3.mash(r.Murmur3.mix(e._hashSeed,r.Murmur3.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Length").write(46).write("em").write(40).debug(this._value),this._node&&(t=t.write(", ").debug(this._node)),t=t.write(41)},e.prototype.toString=function(){return this._value+"em"},e}(m);m.Em=g;var _=function(t){function e(e,i){var r=t.call(this)||this;return r._value=e,r._node=i,r}return h(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return"rem"},e.prototype.node=function(){return this._node},e.prototype.unitValue=function(){return m.remUnit()},e.prototype.pxValue=function(){return this.unitValue()*this._value},e.prototype.rem=function(){return this},e.prototype.equals=function(t){return t instanceof e&&(this._value===t._value&&this._node===t._node)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=r.Murmur3.seed(e)),r.Murmur3.mash(r.Murmur3.mix(e._hashSeed,r.Murmur3.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Length").write(46).write("rem").write(40).debug(this._value),this._node&&(t=t.write(", ").debug(this._node)),t=t.write(41)},e.prototype.toString=function(){return this._value+"rem"},e}(m);m.Rem=_;var b=function(t){function e(e,i){var r=t.call(this)||this;return r._value=e,r._node=i,r}return h(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return"%"},e.prototype.node=function(){return this._node},e.prototype.unitValue=function(){return m.widthUnit(this._node)},e.prototype.pxValue=function(t){return void 0===t&&(t=this.unitValue()),t*this._value/100},e.prototype.pct=function(){return this},e.prototype.equals=function(t){return t instanceof e&&(this._value===t._value&&this._node===t._node)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=r.Murmur3.seed(e)),r.Murmur3.mash(r.Murmur3.mix(e._hashSeed,r.Murmur3.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Length").write(46).write("pct").write(40).debug(this._value),this._node&&(t=t.write(", ").debug(this._node)),t=t.write(41)},e.prototype.toString=function(){return this._value+"%"},e}(m);m.Pct=b;var x=function(t){function e(e,i){var r=t.call(this)||this;return r._value=e,r._node=i,r}return h(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return""},e.prototype.unitValue=function(){return 0},e.prototype.node=function(){return this._node},e.prototype.pxValue=function(){return this._value},e.prototype.equals=function(t){return t instanceof e&&(this._value===t._value&&this._node===t._node)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=r.Murmur3.seed(e)),r.Murmur3.mash(r.Murmur3.mix(e._hashSeed,r.Murmur3.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Length").write(46).write("unitless").write(40).debug(this._value),this._node&&(t=t.write(", ").debug(this._node)),t=t.write(41)},e.prototype.toString=function(){return this._value+""},e}(m);m.Unitless=x;var S=function(t){function i(e,i,r,n,o){var s=t.call(this)||this;return s._defaultUnits=e,s._node=i,s._valueParser=r,s._unitsOutput=n,s._step=o,s}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this._defaultUnits,this._node,this._valueParser,this._unitsOutput,this._step)},i.parse=function(t,r,n,o,s,a){void 0===a&&(a=1);var u=0;if(1===a)if((o=o?o.feed(t):e.Base10.parseDecimal(t)).isDone())a=2;else if(o.isError())return o.asError();if(2===a){for(s=s||e.Unicode.stringOutput();t.isCont()&&(u=t.head(),e.Unicode.isAlpha(u)||37===u);)t=t.step(),s.push(u);if(!t.isEmpty()){var h=o.bind(),l=s.bind()||r;switch(l){case"px":return e.Parser.done(m.px(h,n));case"em":return e.Parser.done(m.em(h,n));case"rem":return e.Parser.done(m.rem(h,n));case"%":return e.Parser.done(m.pct(h,n));case"":case void 0:return e.Parser.done(m.unitless(h,n));default:return e.Parser.error(e.Diagnostic.message("unknown units: "+l,t))}}}return new i(r,n,o,s,a)},i}(e.Parser);m.Parser=S;var A=function(t){function e(e,i,r){var n=t.call(this)||this;return n._defaultUnits=e,n._node=i,n._unit=r,n}return h(e,t),e.prototype.unit=function(t){return 0===arguments.length?void 0!==this._unit?this._unit:m.zero(this._defaultUnits,this._node):new e(this._defaultUnits,this._node,t)},e.prototype.mold=function(t){return t=m.fromAny(t,this._defaultUnits),i.Text.from(t.toString())},e.prototype.cast=function(t){var e,i=t.toValue();try{if(!(e=m.fromValue(i,this._node))){var r=i.stringValue(void 0);void 0!==r&&(e=m.parse(r,this._defaultUnits,this._node))}}catch(t){}return e},e}(i.Form);m.Form=A;var C=function(){function t(){}return t.prototype.contrast=function(t){return this.lightness()<.67?this.brighter(t):this.darker(t)},t.transparent=function(e){return t.Rgb.transparent(e)},t.black=function(){return t.Rgb.black()},t.white=function(){return t.Rgb.white()},t.rgb=function(e,i,r,n){return 1===arguments.length?t.fromAny(e).rgb():new t.Rgb(e,i,r,n)},t.hsl=function(e,i,r,n){return 1===arguments.length?t.fromAny(e).hsl():(e="number"==typeof e?e:a.fromAny(e).degValue(),new t.Hsl(e,i,r,n))},t.fromName=function(e){switch(e){case"transparent":return t.transparent();case"black":return t.black();case"white":return t.white();default:return}},t.fromAny=function(e){if(e instanceof t)return e;if("string"==typeof e)return t.parse(e);if(e&&"object"==typeof e){var i=e;if(void 0!==i.r&&void 0!==i.g&&void 0!==i.b)return new t.Rgb(i.r,i.g,i.b,i.a);var r=e;if(void 0!==r.h&&void 0!==r.s&&void 0!==r.l){var n="number"==typeof r.h?r.h:a.fromAny(r.h).degValue();return new t.Hsl(n,r.s,r.l,r.a)}}throw new TypeError(""+e)},t.fromValue=function(e){var i;return(i=t.Rgb.fromValue(e))||(i=t.Hsl.fromValue(e)),i},t.parse=function(i){for(var r=e.Unicode.stringInput(i);r.isCont()&&e.Unicode.isWhitespace(r.head());)r=r.step();var n=t.Parser.parse(r);if(n.isDone())for(;r.isCont()&&e.Unicode.isWhitespace(r.head());)r=r.step();return r.isCont()&&!n.isError()&&(n=e.Parser.error(e.Diagnostic.unexpected(r))),n.bind()},t.isInit=function(e){return t.Rgb.isInit(e)||t.Hsl.isInit(e)},t.form=function(e){return void 0!==e&&(e=t.fromAny(e)),e!==t.transparent()?new t.Form(e):(t._form||(t._form=new t.Form(t.transparent())),t._form)},t}(),V=function(t){function n(e,i,r,n){void 0===n&&(n=1);var o=t.call(this)||this;return o.r=e,o.g=i,o.b=r,o.a=n,o}return h(n,t),n.prototype.isDefined=function(){return 0!==this.r||0!==this.g||0!==this.b||1!==this.a},n.prototype.alpha=function(t){return void 0===t?this.a:this.a!==t?new n(this.r,this.g,this.b,t):this},n.prototype.lightness=function(){var t=this.r/255,e=this.g/255,i=this.b/255,r=Math.min(t,e,i);return(Math.max(t,e,i)+r)/2},n.prototype.brighter=function(t){return 1!==(t=void 0===t?1/.7:Math.pow(1/.7,t))?new n(this.r*t,this.g*t,this.b*t,this.a):this},n.prototype.darker=function(t){return 1!==(t=void 0===t?.7:Math.pow(.7,t))?new n(this.r*t,this.g*t,this.b*t,this.a):this},n.prototype.rgb=function(){return this},n.prototype.hsl=function(){var t=this.r/255,e=this.g/255,i=this.b/255,r=Math.min(t,e,i),n=Math.max(t,e,i),o=NaN,s=n-r,a=(n+r)/2;return s?(o=t===n?(e-i)/s+6*+(e<i):e===n?(i-t)/s+2:(t-e)/s+4,s/=a<.5?n+r:2-(n+r),o*=60):s=a>0&&a<1?0:o,new C.Hsl(o,s,a,this.a)},n.prototype.equals=function(t){return t instanceof n&&(this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a)},n.prototype.hashCode=function(){return void 0===n._hashSeed&&(n._hashSeed=r.Murmur3.seed(n)),r.Murmur3.mash(r.Murmur3.mix(r.Murmur3.mix(r.Murmur3.mix(r.Murmur3.mix(n._hashSeed,r.Murmur3.hash(this.r)),r.Murmur3.hash(this.g)),r.Murmur3.hash(this.b)),r.Murmur3.hash(this.a)))},n.prototype.debug=function(t){t=t.write("Color").write(46).write("rgb").write(40).debug(this.r).write(", ").debug(this.g).write(", ").debug(this.b),1!==this.a&&(t=t.write(", ").debug(this.a)),t=t.write(41)},n.prototype.toHexString=function(){var t=Math.min(Math.max(0,Math.round(this.r||0)),255),i=Math.min(Math.max(0,Math.round(this.g||0)),255),r=Math.min(Math.max(0,Math.round(this.b||0)),255),n="#",o=e.Base16.lowercase().alphabet();return n+=o.charAt(t>>>4&15),n+=o.charAt(15&t),n+=o.charAt(i>>>4&15),n+=o.charAt(15&i),n+=o.charAt(r>>>4&15),n+=o.charAt(15&r)},n.prototype.toString=function(){var t=this.a;if(1===(t=isNaN(t)?1:Math.max(0,Math.min(this.a,1))))return this.toHexString();var e=1===t?"rgb":"rgba";return e+="(",e+=Math.max(0,Math.min(Math.round(this.r)||0,255)),e+=",",e+=Math.max(0,Math.min(Math.round(this.g)||0,255)),e+=",",e+=Math.max(0,Math.min(Math.round(this.b)||0,255)),1!==t&&(e+=",",e+=t),e+=")"},n.transparent=function(t){return void 0===t&&(t=0),new n(0,0,0,t)},n.black=function(){return new n(0,0,0,1)},n.white=function(){return new n(255,255,255,1)},n.fromValue=function(t){var e,r,n,o,s,a=t.tag();if("rgb"===a||"rgba"===a?(t=t.header(a),e=!0):e=!1,t.forEach(function(t,a){var u=t.key.stringValue();void 0!==u?"r"===u?r=t.toValue().numberValue(r):"g"===u?n=t.toValue().numberValue(n):"b"===u?o=t.toValue().numberValue(o):"a"===u&&(s=t.toValue().numberValue(s)):t instanceof i.Value&&e&&(0===a?r=t.numberValue(r):1===a?n=t.numberValue(n):2===a?o=t.numberValue(o):3===a&&(s=t.numberValue(s)))}),void 0!==r&&void 0!==n&&void 0!==o)return C.rgb(r,n,o,s)},n.parse=function(t){return C.parse(t).rgb()},n.isInit=function(t){if(t&&"object"==typeof t){var e=t;return void 0!==e.r&&void 0!==e.g&&void 0!==e.b}return!1},n}(C);C.Rgb=V;var P=function(t){function e(e,i,r,n){void 0===n&&(n=1);var o=t.call(this)||this;return o.h=e,o.s=i,o.l=r,o.a=n,o}return h(e,t),e.prototype.isDefined=function(){return 0!==this.h||0!==this.s||0!==this.l||1!==this.a},e.prototype.alpha=function(t){return void 0===t?this.a:this.a!==t?new e(this.h,this.s,this.l,t):this},e.prototype.lightness=function(){return this.l},e.prototype.brighter=function(t){return 1!==(t=void 0===t?1/.7:Math.pow(1/.7,t))?new e(this.h,this.s,this.l*t,this.a):this},e.prototype.darker=function(t){return 1!==(t=void 0===t?.7:Math.pow(.7,t))?new e(this.h,this.s,this.l*t,this.a):this},e.toRgb=function(t,e,i){return 255*(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)},e.prototype.rgb=function(){var t=this.h%360+360*+(this.h<0),i=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*i,o=2*r-n;return new C.Rgb(e.toRgb(t>=240?t-240:t+120,o,n),e.toRgb(t,o,n),e.toRgb(t<120?t+240:t-120,o,n),this.a)},e.prototype.hsl=function(){return this},e.prototype.equals=function(t){return t instanceof e&&(this.h===t.h&&this.s===t.s&&this.l===t.l&&this.a===t.a)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=r.Murmur3.seed(e)),r.Murmur3.mash(r.Murmur3.mix(r.Murmur3.mix(r.Murmur3.mix(r.Murmur3.mix(e._hashSeed,r.Murmur3.hash(this.h)),r.Murmur3.hash(this.s)),r.Murmur3.hash(this.l)),r.Murmur3.hash(this.a)))},e.prototype.debug=function(t){t=t.write("Color").write(46).write("hsl").write(40).debug(this.h).write(", ").debug(this.s).write(", ").debug(this.l),1!==this.a&&(t=t.write(", ").debug(this.a)),t=t.write(41)},e.prototype.toHexString=function(){return this.rgb().toHexString()},e.prototype.toString=function(){var t=this.a,e=1===(t=isNaN(t)?1:Math.max(0,Math.min(this.a,1)))?"hsl":"hsla";return e+="(",e+=Math.max(0,Math.min(Math.round(this.h)||0,360)),e+=",",e+=Math.max(0,Math.min(100*Math.round(this.s)||0,100))+"%",e+=",",e+=Math.max(0,Math.min(100*Math.round(this.l)||0,100))+"%",1!==t&&(e+=",",e+=t),e+=")"},e.transparent=function(t){return void 0===t&&(t=0),new e(0,0,0,t)},e.black=function(){return new e(0,0,0,1)},e.white=function(){return new e(0,1,1,1)},e.fromValue=function(t){var e,r,n,o,s,u=t.tag();if("hsl"===u||"hsla"===u?(t=t.header(u),e=!0):e=!1,t.forEach(function(t,u){var h=t.key.stringValue();void 0!==h?"h"===h?r=t.toValue().cast(a.form(),r):"s"===h?n=t.toValue().numberValue(n):"l"===h?o=t.toValue().numberValue(o):"a"===h&&(s=t.toValue().numberValue(s)):t instanceof i.Value&&e&&(0===u?r=t.cast(a.form(),r):1===u?n=t.numberValue(n):2===u?o=t.numberValue(o):3===u&&(s=t.numberValue(s)))}),void 0!==r&&void 0!==n&&void 0!==o)return C.hsl(r,n,o,s)},e.parse=function(t){return C.parse(t).hsl()},e.isInit=function(t){if(t&&"object"==typeof t){var e=t;return void 0!==e.h&&void 0!==e.s&&void 0!==e.l}return!1},e}(C);C.Hsl=P;var M=function(){function t(t,e){void 0===e&&(e=""),this.value=t,this.units=e}return t.prototype.scale=function(t){return"%"===this.units?this.value*t/100:this.value},t}(),R=function(t){function i(e,i){var r=t.call(this)||this;return r.valueParser=e,r.step=i,r}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this.valueParser,this.step)},i.parse=function(t,r,n){if(void 0===n&&(n=1),1===n)if((r=r?r.feed(t):e.Base10.parseNumber(t)).isDone())n=2;else if(r.isError())return r.asError();if(2===n){if(t.isCont()&&37===t.head())return t=t.step(),e.Parser.done(new M(r.bind(),"%"));if(!t.isEmpty())return e.Parser.done(new M(r.bind()))}return new i(r,n)},i}(e.Parser);M.Parser=R;var O=function(t){function i(e,i){var r=t.call(this)||this;return r._value=e,r._step=i,r}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this._value,this._step)},i.parse=function(t,r,n){void 0===r&&(r=0),void 0===n&&(n=1);var o=0;if(1===n)if(t.isCont()&&35===t.head())t=t.step(),n=2;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected("#",t));if(n>=2){for(;n<=9&&t.isCont()&&(o=t.head(),e.Base16.isDigit(o));)t=t.step(),r=r<<4|e.Base16.decodeDigit(o),n+=1;if(!t.isEmpty())return 5===n?e.Parser.done(new V(r>>8&15|r>>4&240,r>>4&15|240&r,r<<4&240|15&r)):6===n?e.Parser.done(new V(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|240&r,(r<<4&240|15&r)/255)):8===n?e.Parser.done(new V(r>>16&255,r>>8&255,255&r)):10===n?e.Parser.done(new V(r>>24&255,r>>16&255,r>>8&255,(255&r)/255)):e.Parser.error(e.Diagnostic.unexpected(t))}return new i(r,n)},i}(e.Parser);C.HexParser=O;var D=function(t){function i(e,i,r,n,o){var s=t.call(this)||this;return s.rParser=e,s.gParser=i,s.bParser=r,s.aParser=n,s.step=o,s}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this.rParser,this.gParser,this.bParser,this.aParser,this.step)},i.parse=function(t,r,n,o,s,a){var u=0;if(1===a)if(t.isCont()&&114===t.head())t=t.step(),a=2;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected("r",t));if(2===a)if(t.isCont()&&103===t.head())t=t.step(),a=3;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected("g",t));if(3===a)if(t.isCont()&&98===t.head())t=t.step(),a=4;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected("b",t));if(4===a&&(t.isCont()&&97===t.head()?(t=t.step(),a=5):t.isEmpty()||(a=5)),5===a){for(;t.isCont()&&(u=t.head(),e.Unicode.isSpace(u));)t=t.step();if(t.isCont()&&40===u)t=t.step(),a=6;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected("(",t))}if(6===a){if(r)r=r.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t=t.step();t.isEmpty()||(r=R.parse(t))}if(r)if(r.isDone())a=7;else if(r.isError())return r.asError()}if(7===a){for(;t.isCont()&&(u=t.head(),e.Unicode.isSpace(u));)t=t.step();if(t.isCont())44===u&&(t=t.step()),a=8;else if(t.isDone())return e.Parser.error(e.Diagnostic.unexpected(t))}if(8===a){if(n)n=n.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t=t.step();t.isEmpty()||(n=R.parse(t))}if(n)if(n.isDone())a=9;else if(n.isError())return n.asError()}if(9===a){for(;t.isCont()&&(u=t.head(),e.Unicode.isSpace(u));)t=t.step();if(t.isCont())44===u&&(t=t.step()),a=10;else if(t.isDone())return e.Parser.error(e.Diagnostic.unexpected(t))}if(10===a){if(o)o=o.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t=t.step();t.isEmpty()||(o=R.parse(t))}if(o)if(o.isDone())a=11;else if(o.isError())return o.asError()}if(11===a){for(;t.isCont()&&(u=t.head(),e.Unicode.isSpace(u));)t=t.step();if(t.isCont()){if(41===u)return t=t.step(),e.Parser.done(new V(r.bind().scale(255),n.bind().scale(255),o.bind().scale(255)));44!==u&&47!==u||(t=t.step()),a=12}else if(t.isDone())return e.Parser.error(e.Diagnostic.unexpected(t))}if(12===a){if(s)s=s.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t=t.step();t.isEmpty()||(s=R.parse(t))}if(s)if(s.isDone())a=13;else if(s.isError())return s.asError()}if(13===a){for(;t.isCont()&&(u=t.head(),e.Unicode.isSpace(u));)t=t.step();if(t.isCont()&&41===u)return t=t.step(),e.Parser.done(new V(r.bind().scale(255),n.bind().scale(255),o.bind().scale(255),s.bind().scale(1)));if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected(")",t))}return new i(r,n,o,s,a)},i.parseRest=function(t){return i.parse(t,void 0,void 0,void 0,void 0,5)},i}(e.Parser);C.RgbParser=D;var E=function(t){function i(e,i,r,n,o){var s=t.call(this)||this;return s.hParser=e,s.sParser=i,s.lParser=r,s.aParser=n,s.step=o,s}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this.hParser,this.sParser,this.lParser,this.aParser,this.step)},i.parse=function(t,r,n,o,s,a){var u=0;if(1===a)if(t.isCont()&&104===t.head())t=t.step(),a=2;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected("h",t));if(2===a)if(t.isCont()&&115===t.head())t=t.step(),a=3;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected("s",t));if(3===a)if(t.isCont()&&108===t.head())t=t.step(),a=4;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected("l",t));if(4===a&&(t.isCont()&&97===t.head()?(t=t.step(),a=5):t.isEmpty()||(a=5)),5===a){for(;t.isCont()&&(u=t.head(),e.Unicode.isSpace(u));)t=t.step();if(t.isCont()&&40===u)t=t.step(),a=6;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected("(",t))}if(6===a){if(r)r=r.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t=t.step();t.isEmpty()||(r=v.parse(t,"deg"))}if(r)if(r.isDone())a=7;else if(r.isError())return r.asError()}if(7===a){for(;t.isCont()&&(u=t.head(),e.Unicode.isSpace(u));)t=t.step();if(t.isCont())44===u&&(t=t.step()),a=8;else if(t.isDone())return e.Parser.error(e.Diagnostic.unexpected(t))}if(8===a){if(n)n=n.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t=t.step();t.isEmpty()||(n=R.parse(t))}if(n)if(n.isDone()){if("%"!==n.bind().units)return e.Parser.error(e.Diagnostic.expected("%",t));a=9}else if(n.isError())return n.asError()}if(9===a){for(;t.isCont()&&(u=t.head(),e.Unicode.isSpace(u));)t=t.step();if(t.isCont())44===u&&(t=t.step()),a=10;else if(t.isDone())return e.Parser.error(e.Diagnostic.unexpected(t))}if(10===a){if(o)o=o.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t=t.step();t.isCont()&&(o=R.parse(t))}if(o)if(o.isDone()){if("%"!==o.bind().units)return e.Parser.error(e.Diagnostic.expected("%",t));a=11}else if(o.isError())return o.asError()}if(11===a){for(;t.isCont()&&(u=t.head(),e.Unicode.isSpace(u));)t=t.step();if(t.isCont()){if(41===u)return t=t.step(),e.Parser.done(new P(r.bind().degValue(),n.bind().scale(1),o.bind().scale(1)));44!==u&&47!==u||(t=t.step()),a=12}else if(t.isDone())return e.Parser.error(e.Diagnostic.unexpected(t))}if(12===a){if(s)s=s.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t=t.step();t.isEmpty()||(s=R.parse(t))}if(s)if(s.isDone())a=13;else if(s.isError())return s.asError()}if(13===a){for(;t.isCont()&&(u=t.head(),e.Unicode.isSpace(u));)t=t.step();if(t.isCont()&&41===u)return t=t.step(),e.Parser.done(new P(r.bind().degValue(),n.bind().scale(1),o.bind().scale(1),s.bind().scale(1)));if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected(")",t))}return new i(r,n,o,s,a)},i.parseRest=function(t){return i.parse(t,void 0,void 0,void 0,void 0,5)},i}(e.Parser);C.HslParser=E;var T=function(t){function i(e,i){var r=t.call(this)||this;return r.identOutput=e,r.step=i,r}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this.identOutput,this.step)},i.parse=function(t,r,n){void 0===n&&(n=1);var o=0;if(1===n)if(t.isCont()){if(35===t.head())return O.parse(t);n=2}else if(t.isDone())return e.Parser.error(e.Diagnostic.unexpected(t));if(2===n){for(r=r||e.Unicode.stringOutput();t.isCont()&&(o=t.head(),e.Unicode.isAlpha(o));)t=t.step(),r.write(o);if(!t.isEmpty()){var s=r.bind();switch(s){case"rgb":case"rgba":return D.parseRest(t);case"hsl":case"hsla":return E.parseRest(t);default:var a=C.fromName(s);return void 0!==a?e.Parser.done(a):e.Parser.error(e.Diagnostic.message("unknown color: "+s,t))}}}return new i(r,n)},i}(e.Parser);C.Parser=T;var k=function(t){function e(e){var i=t.call(this)||this;return i._unit=e,i}return h(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t){return t=C.fromAny(t),i.Text.from(t.toString())},e.prototype.cast=function(t){var e,i=t.toValue();try{if(!(e=C.fromValue(i))){var r=i.stringValue(void 0);void 0!==r&&(e=C.parse(r))}}catch(t){}return e},e}(i.Form);C.Form=k;var I={fromAny:function(t){return"string"!=typeof t||"large"!==t&&"larger"!==t&&"medium"!==t&&"small"!==t&&"smaller"!==t&&"x-large"!==t&&"x-small"!==t&&"xx-large"!==t&&"xx-small"!==t?m.fromAny(t):t},fromValue:function(t){var e=t.stringValue(void 0);return void 0!==e?I.fromAny(e):m.form().cast(t)}},U={fromAny:function(t){return"string"==typeof t&&"normal"===t?t:m.fromAny(t)},fromValue:function(t){var e=t.stringValue(void 0);return void 0!==e?U.fromAny(e):m.form().cast(t)}},z={fromValue:function(t){var e;return t.forEach(function(t){if(t instanceof i.Value){var r=t.stringValue(void 0);void 0!==r&&(void 0===e?e=r:"string"==typeof e?e=[e,r]:e.push(r))}}),e},format:function(t){var i,r=t.length;if(r>0){i=e.Unicode.isAlpha(t.charCodeAt(0));for(var n=t.offsetByCodePoints(0,1);i&&n<r;n=t.offsetByCodePoints(n,1)){var o=t.charCodeAt(n);i=e.Unicode.isAlpha(o)||45===o}}else i=!1;if(i)return t;var s=e.Unicode.stringOutput();s.write(34);for(n=0;n<r;n=t.offsetByCodePoints(n,1)){if(10===(o=t.charCodeAt(n))||34===o||39===o)s.write(92).write(o);else if(o>=32)s.write(o);else{var a=e.Base16.uppercase();s.write(92).write(a.encodeDigit(o>>>20&15)).write(a.encodeDigit(o>>>16&15)).write(a.encodeDigit(o>>>12&15)).write(a.encodeDigit(o>>>8&15)).write(a.encodeDigit(o>>>4&15)).write(a.encodeDigit(15&o))}}return s.write(34),s.toString()}},F=function(t){function i(e,i,r,n){var o=t.call(this)||this;return o.output=e,o.quote=i,o.code=r,o.step=n,o}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this.output,this.quote,this.code,this.step)},i.parse=function(t,r,n,o,s){void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=1);var a=0;if(1===s){for(;t.isCont()&&(a=t.head(),e.Unicode.isSpace(a));)t=t.step();if(t.isCont())if(e.Unicode.isAlpha(a))r=r||e.Unicode.stringOutput(),s=2;else{if(34!==a&&(39!==a||n!==a&&0!==n))return e.Parser.error(e.Diagnostic.expected("font family",t));t=t.step(),r=r||e.Unicode.stringOutput(),n=a,s=3}else if(t.isDone())return e.Parser.error(e.Diagnostic.expected("font family",t))}if(2===s){for(;t.isCont()&&(a=t.head(),e.Unicode.isAlpha(a)||45===a);)t=t.step(),r.write(a);if(!t.isEmpty())return e.Parser.done(r.bind())}t:for(;;){if(3===s){for(;t.isCont()&&(a=t.head())>=32&&a!==n&&92!==a;)t=t.step(),r.write(a);if(t.isCont()){if(a===n)return t=t.step(),e.Parser.done(r.bind());if(92!==a)return e.Parser.error(e.Diagnostic.expected(n,t));t=t.step(),s=4}else if(t.isDone())return e.Parser.error(e.Diagnostic.expected(n,t))}if(4===s)if(t.isCont()){if(a=t.head(),!e.Base16.isDigit(a)){if(10===a){t.step(),s=3;continue}t.step(),r.write(a),s=3;continue}s=5}else if(t.isDone())return e.Parser.error(e.Diagnostic.expected("escape character",t));if(s>=5)for(;;){if(t.isCont()&&(a=t.head(),e.Base16.isDigit(a))){if(t=t.step(),o=16*o+e.Base16.decodeDigit(a),s<=11){s+=1;continue}if(0===o)return e.Parser.error(e.Diagnostic.message("zero escape",t));r.write(o),o=0,s=3;continue t}if(!t.isEmpty())return e.Parser.error(e.Diagnostic.unexpected(t));break}break}return new i(r,n,o,s)},i}(e.Parser),j=function(){function t(t,e,i,r,n,o,s){this._style=t,this._variant=e,this._weight=i,this._stretch=r,this._size=n,this._height=o,this._family=s}return t.prototype.style=function(e){return void 0===e?this._style:this._style===e?this:new t(e,this._variant,this._weight,this._stretch,this._size,this._height,this._family)},t.prototype.variant=function(e){return void 0===e?this._variant:this._variant===e?this:new t(this._style,e,this._weight,this._stretch,this._size,this._height,this._family)},t.prototype.weight=function(e){return void 0===e?this._weight:this._weight===e?this:new t(this._style,this._variant,e,this._stretch,this._size,this._height,this._family)},t.prototype.stretch=function(e){return void 0===e?this._stretch:this._stretch===e?this:new t(this._style,this._variant,this._weight,e,this._size,this._height,this._family)},t.prototype.size=function(e){return void 0===e?this._size:(e=null!==e?I.fromAny(e):null,r.Objects.equal(this._size,e)?this:new t(this._style,this._variant,this._weight,this._stretch,e,this._height,this._family))},t.prototype.height=function(e){return void 0===e?this._height:(e=null!==e?U.fromAny(e):null,r.Objects.equal(this._height,e)?this:new t(this._style,this._variant,this._weight,this._stretch,this._size,e,this._family))},t.prototype.family=function(e){return void 0===e?Array.isArray(this._family)?this._family.slice(0):this._family:r.Objects.equal(this._family,e)?this:(Array.isArray(e)&&1===e.length&&(e=e[0]),new t(this._style,this._variant,this._weight,this._stretch,this._size,this._height,e))},t.prototype.toAny=function(){return{style:this._style,variant:this._variant,weight:this._weight,stretch:this._stretch,size:this._size,height:this._height,family:Array.isArray(this._family)?this._family.slice(0):this._family}},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._style===e._style&&this._variant===e._variant&&this._weight===e._weight&&this._stretch===e._stretch&&r.Objects.equal(this._size,e._size)&&r.Objects.equal(this._height,e._height)&&r.Objects.equal(this._family,e._family))},t.prototype.debug=function(t){if(t=t.write("Font").write(46).write("family").write(40).write(41),"string"==typeof this._family)t=t.debug(this._family);else if(Array.isArray(this._family)&&this._family.length){t=t.debug(this._family[0]);for(var e=1;e<this._family.length;e+=1)t=t.write(", ").debug(this._family[e])}t=t.write(41),null!==this._style&&(t=t.write(46).write("style").write(40).debug(this._style).write(41)),null!==this._variant&&(t=t.write(46).write("variant").write(40).debug(this._variant).write(41)),null!==this._weight&&(t=t.write(46).write("weight").write(40).debug(this._weight).write(41)),null!==this._stretch&&(t=t.write(46).write("stretch").write(40).debug(this._stretch).write(41)),null!==this._size&&(t=t.write(46).write("size").write(40).debug(this._size).write(41)),null!==this._height&&(t=t.write(46).write("height").write(40).debug(this._height).write(41))},t.prototype.toString=function(){var t="";if(null===this._style&&"normal"!==this._variant&&"normal"!==this._weight&&"normal"!==this._stretch||(t+=this._style||"normal"),null===this._variant&&"normal"!==this._weight&&"normal"!==this._stretch||(t&&(t+=" "),t+=this._variant||"normal"),null===this._weight&&"normal"!==this._stretch||(t&&(t+=" "),t+=this._weight||"normal"),null!==this._stretch&&(t&&(t+=" "),t+=this._stretch),null!==this._size&&(t&&(t+=" "),t+=this._size.toString(),null!==this._height&&(t+="/",t+=this._height.toString())),"string"==typeof this._family)t&&(t+=" "),t+=z.format(this._family);else if(Array.isArray(this._family)&&this._family.length){t&&(t+=" "),t+=z.format(this._family[0]);for(var e=1;e<this._family.length;e+=1)t+=", ",t+=z.format(this._family[e])}return t},t.style=function(e,i){return Array.isArray(i)&&1===i.length&&(i=i[0]),new t(e,null,null,null,null,null,i)},t.variant=function(e,i){return Array.isArray(i)&&1===i.length&&(i=i[0]),new t(null,e,null,null,null,null,i)},t.weight=function(e,i){return Array.isArray(i)&&1===i.length&&(i=i[0]),new t(null,null,e,null,null,null,i)},t.stretch=function(e,i){return Array.isArray(i)&&1===i.length&&(i=i[0]),new t(null,null,null,e,null,null,i)},t.size=function(e,i){return e=null!==e?I.fromAny(e):null,Array.isArray(i)&&1===i.length&&(i=i[0]),new t(null,null,null,null,e,null,i)},t.family=function(e){return Array.isArray(e)&&1===e.length&&(e=e[0]),new t(null,null,null,null,null,null,e)},t.from=function(e,i,r,n,o,s,a){return void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===n&&(n=null),void 0===o&&(o=null),void 0===s&&(s=null),o=null!==o?I.fromAny(o):null,s=null!==s?U.fromAny(s):null,Array.isArray(a)&&1===a.length&&(a=a[0]),new t(e,i,r,n,o,s,a)},t.fromAny=function(e){if(e instanceof t)return e;if("object"==typeof e&&e)return t.from(e.style,e.variant,e.weight,e.stretch,e.size,e.height,e.family);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.fromValue=function(e){var i=e.header("font");if(i){var r=i.get("style").stringValue(null),n=i.get("variant").stringValue(null),o=i.get("weight").stringValue(null),s=i.get("stretch").stringValue(null),a=I.fromValue(i.get("size")),u=U.fromValue(i.get("height")),h=z.fromValue(i.get("family"));if(void 0!==h)return t.from(r,n,o,s,a,u,h)}},t.parse=function(i){for(var r=e.Unicode.stringInput(i);r.isCont()&&e.Unicode.isWhitespace(r.head());)r=r.step();var n=t.Parser.parse(r);if(n.isDone())for(;r.isCont()&&e.Unicode.isWhitespace(r.head());)r=r.step();return r.isCont()&&!n.isError()&&(n=e.Parser.error(e.Diagnostic.unexpected(r))),n.bind()},t.isInit=function(t){return!(!t||"object"!=typeof t)&&void 0!==t.family},t.form=function(e){return void 0!==e?(e=t.fromAny(e),new t.Form(e)):(t._form||(t._form=new t.Form),t._form)},t}(),N=function(t){function i(e,i,r,n,o,s,a,u,h,l,p){var c=t.call(this)||this;return c.style=e,c.variant=i,c.weight=r,c.stretch=n,c.size=o,c.height=s,c.family=a,c.identOutput=u,c.lengthParser=h,c.familyParser=l,c.step=p,c}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this.style,this.variant,this.weight,this.stretch,this.size,this.height,this.family,this.identOutput,this.lengthParser,this.familyParser,this.step)},i.parse=function(t,r,n,o,s,a,u,h,l,p,c,d){void 0===d&&(d=1);for(var f=0;;){if(1===d){for(;t.isCont()&&(f=t.head(),e.Unicode.isSpace(f));)t.step();if(t.isCont())d=e.Unicode.isAlpha(f)?2:34===f||39===f?11:4;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.unexpected(t))}if(2===d){for(l=l||e.Unicode.stringOutput();t.isCont()&&(f=t.head(),e.Unicode.isAlpha(f)||45===f);)t=t.step(),l.write(f);if(!t.isEmpty()){var v=l.bind();switch(l=void 0,v){case"italic":case"oblique":if(void 0!==r)return e.Parser.error(e.Diagnostic.message("reapeated font style: "+v,t));r=v,d=3;break;case"small-caps":if(void 0!==n)return e.Parser.error(e.Diagnostic.message("reapeated font variant: "+v,t));n=v,d=3;break;case"bold":case"bolder":case"lighter":if(void 0!==o)return e.Parser.error(e.Diagnostic.message("reapeated font weight: "+v,t));o=v,d=3;break;case"ultra-condensed":case"extra-condensed":case"semi-condensed":case"condensed":case"expanded":case"semi-expanded":case"extra-expanded":case"ultra-expanded":if(void 0!==s)return e.Parser.error(e.Diagnostic.message("reapeated font stretch: "+v,t));s=v,d=3;break;case"normal":if(void 0===r)r=v;else if(void 0===n)n=v;else if(void 0===o)o=v;else{if(void 0!==s)return e.Parser.error(e.Diagnostic.message("reapeated font property: "+v,t));s=v}d=3;break;case"large":case"larger":case"medium":case"small":case"smaller":case"x-large":case"x-small":case"xx-large":case"xx-small":a=v,d=5;break;default:h=v,d=12}}}if(3===d){if(t.isCont()){if(f=t.head(),e.Unicode.isSpace(f)){t.step(),d=1;continue}return e.Parser.error(e.Diagnostic.expected("font property, size, or family",t))}if(!t.isEmpty())return e.Parser.error(e.Diagnostic.unexpected(t))}if(4===d)if((p=p?p.feed(t):S.parse(t)).isDone()){var y=p.bind();if(""===y.units()){var m=y.value();switch(m){case 100:case 200:case 300:case 400:case 500:case 600:case 700:case 800:case 900:if(void 0!==o)return e.Parser.error(e.Diagnostic.message("reapeated font weight: "+m,t));o=String(m);break;default:return e.Parser.error(e.Diagnostic.message("unknown font property: "+m,t))}d=3;continue}a=y,p=void 0,d=5}else if(p.isError())return p.asError();if(5===d)if(t.isCont())if(f=t.head(),e.Unicode.isSpace(f))t.step(),d=6;else{if(47!==f)return e.Parser.error(e.Diagnostic.expected("font family",t));t.step(),d=7}else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.unexpected(t));if(6===d){for(;t.isCont()&&(f=t.head(),e.Unicode.isSpace(f));)t.step();if(t.isCont())47===f?(t.step(),d=7):d=11;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.unexpected(t))}if(7===d){for(;t.isCont()&&(f=t.head(),e.Unicode.isSpace(f));)t.step();if(t.isCont())d=e.Unicode.isAlpha(f)?8:9;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.unexpected(t))}if(8===d){for(l=l||e.Unicode.stringOutput();t.isCont()&&(f=t.head(),e.Unicode.isAlpha(f));)t=t.step(),l.write(f);if(!t.isEmpty()){v=l.bind();switch(l=void 0,v){case"normal":u=v,d=10;break;default:return e.Parser.error(e.Diagnostic.message("unknown line height: "+v,t))}}}if(9===d)if((p=p?p.feed(t):S.parse(t)).isDone())u=p.bind(),p=void 0,d=10;else if(p.isError())return p.asError();if(10===d)if(t.isCont()){if(f=t.head(),!e.Unicode.isSpace(f))return e.Parser.error(e.Diagnostic.expected("font family",t));t.step(),d=11}else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.unexpected(t));if(11===d)if((c=c?c.feed(t):F.parse(t)).isDone())Array.isArray(h)?h.push(c.bind()):h=void 0!==h?[h,c.bind()]:c.bind(),c=void 0,d=12;else if(c.isError())return c.asError();if(12===d){for(;t.isCont()&&(f=t.head(),e.Unicode.isSpace(f));)t.step();if(t.isCont()&&44===f){t.step(),d=11;continue}if(!t.isEmpty())return e.Parser.done(j.from(r,n,o,s,a,u,h))}break}return new i(r,n,o,s,a,u,h,l,p,c,d)},i.parseRest=function(t,e,r,n,o,s,a,u){var h=void 0!==u?12:void 0!==s?5:3;return i.parse(t,e,r,n,o,s,a,u,void 0,void 0,void 0,h)},i}(e.Parser);j.Parser=N;var q=function(t){function e(e){var i=t.call(this)||this;return i._unit=e,i}return h(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t){t=j.fromAny(t);var e=i.Record.create(7);if(null!==t._style&&e.slot("style",t._style),null!==t._variant&&e.slot("variant",t._variant),null!==t._weight&&e.slot("weight",t._weight),null!==t._stretch&&e.slot("stretch",t._stretch),t._size instanceof m?e.slot("size",m.form().mold(t._size)):null!==t._size&&e.slot("size",t._size),t._height instanceof m?e.slot("height",m.form().mold(t._height)):null!==t._height&&e.slot("height",t._height),Array.isArray(t._family)){for(var r=i.Record.create(t._family.length),n=0;n<t._family.length;n+=1)r.push(t._family[n]);e.slot("family",r)}else e.slot("family",t._family);return i.Record.of(i.Attr.of("font",e))},e.prototype.cast=function(t){var e,i=t.toValue();try{if(!(e=j.fromValue(i))){var r=i.stringValue();void 0!==r&&(e=j.parse(r))}}catch(t){}return e},e}(i.Form);j.Form=q;var B=function(){function t(){}return t.prototype.translate=function(e,i){return this.transform(t.translate(e,i))},t.prototype.translateX=function(e){return this.transform(t.translateX(e))},t.prototype.translateY=function(e){return this.transform(t.translateY(e))},t.prototype.scale=function(e,i){return this.transform(t.scale(e,i))},t.prototype.scaleX=function(e){return this.transform(t.scaleX(e))},t.prototype.scaleY=function(e){return this.transform(t.scaleY(e))},t.prototype.rotate=function(e){return this.transform(t.rotate(e))},t.prototype.skew=function(e,i){return this.transform(t.skew(e,i))},t.prototype.skewX=function(e){return this.transform(t.skewX(e))},t.prototype.skewY=function(e){return this.transform(t.skewY(e))},t.prototype.toAttributeString=function(){return this.toString()},t.identity=function(){return t._identity||(t._identity=new t.Identity),t._identity},t.translate=function(e,i){return new t.Translate(e,i)},t.translateX=function(e){return new t.Translate(e,0)},t.translateY=function(e){return new t.Translate(0,e)},t.scale=function(e,i){return new t.Scale(e,i)},t.scaleX=function(e){return new t.Scale(e,1)},t.scaleY=function(e){return new t.Scale(1,e)},t.rotate=function(e){return new t.Rotate(e)},t.skew=function(e,i){return new t.Skew(e,i)},t.skewX=function(e){return new t.Skew(e,0)},t.skewY=function(e){return new t.Skew(0,e)},t.affine=function(e,i,r,n,o,s){return new t.Affine(e,i,r,n,o,s)},t.list=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return new t.List(e)},t.fromAny=function(e){if(e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.fromValue=function(e){switch(e.tag()){case"identity":return t.Identity.fromValue(e);case"translate":return t.Translate.fromValue(e);case"scale":return t.Scale.fromValue(e);case"rotate":return t.Rotate.fromValue(e);case"skew":return t.Skew.fromValue(e);case"matrix":return t.Affine.fromValue(e);default:return t.List.fromValue(e)}},t.parse=function(i){for(var r=e.Unicode.stringInput(i);r.isCont()&&e.Unicode.isWhitespace(r.head());)r=r.step();var n=t.ListParser.parse(r);if(n.isDone())for(;r.isCont()&&e.Unicode.isWhitespace(r.head());)r=r.step();return r.isCont()&&!n.isError()&&(n=e.Parser.error(e.Diagnostic.unexpected(r))),n.bind()},t.form=function(e){return void 0!==e?new t.Form(t.fromAny(e)):(t._form||(t._form=new t.Form),t._form)},t}(),W=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.transform=function(t,e){return t instanceof B?t:(Array.isArray(t)&&(e=t[1],t=t[0]),"number"==typeof t&&"number"==typeof e?[t,e]:[t=m.fromAny(t),e=m.fromAny(e)])},e.prototype.transformX=function(t,e){return t},e.prototype.transformY=function(t,e){return e},e.prototype.inverse=function(){return this},e.prototype.toAffine=function(){return new B.Affine(1,0,0,1,0,0)},e.prototype.toValue=function(){return i.Record.of(i.Attr.of("identity"))},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equals=function(t){return t instanceof e},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=r.Murmur3.seed(e)),e._hashSeed},e.prototype.debug=function(t){t=t.write("Transform").write(46).write("identity").write(40).write(41)},e.prototype.toString=function(){return"none"},e.fromValue=function(t){if("identity"===t.tag())return B.identity()},e}(B);B.Identity=W;var L=function(t){function n(e,i){var r=t.call(this)||this;return r._x=m.fromAny(e),r._y=m.fromAny(i),r}return h(n,t),Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),n.prototype.transform=function(t,e){return t instanceof B?t instanceof B.Identity?this:new B.List([this,t]):(Array.isArray(t)&&(e=t[1],t=t[0]),"number"==typeof t&&"number"==typeof e?[t+this._x.pxValue(),e+this._y.pxValue()]:(t=m.fromAny(t),e=m.fromAny(e),[t.plus(this._x),e.plus(this._y)]))},n.prototype.transformX=function(t,e){return t+this._x.pxValue()},n.prototype.transformY=function(t,e){return e+this._y.pxValue()},n.prototype.inverse=function(){return new n(this._x.opposite(),this._y.opposite())},n.prototype.toAffine=function(){return new B.Affine(1,0,0,1,this._x.pxValue(),this._y.pxValue())},n.prototype.toValue=function(){return i.Record.of(i.Attr.of("translate",i.Record.of(i.Slot.of("x",this._x.toString()),i.Slot.of("y",this._y.toString()))))},n.prototype.conformsTo=function(t){return t instanceof n},n.prototype.equals=function(t){return t instanceof n&&(this._x.equals(t._x)&&this._y.equals(t._y))},n.prototype.hashCode=function(){return void 0===n._hashSeed&&(n._hashSeed=r.Murmur3.seed(n)),r.Murmur3.mash(r.Murmur3.mix(r.Murmur3.mix(n._hashSeed,this._x.hashCode()),this._y.hashCode()))},n.prototype.debug=function(t){t=t.write("Transform").write(46).write("translate"),t=this._x.isDefined()&&!this._y.isDefined()?t.write("X").write(40).debug(this._x).write(41):!this._x.isDefined()&&this._y.isDefined()?t.write("Y").write(40).debug(this._y).write(41):t.write(40).debug(this._x).write(", ").debug(this._y).write(41)},n.prototype.toString=function(){return this._x.isDefined()&&!this._y.isDefined()?"translate("+this._x+",0)":!this._x.isDefined()&&this._y.isDefined()?"translate(0,"+this._y+")":"translate("+this._x+","+this._y+")"},n.prototype.toAttributeString=function(){return this._x.isDefined()&&!this._y.isDefined()?"translate("+this._x.pxValue()+",0)":!this._x.isDefined()&&this._y.isDefined()?"translate(0,"+this._y.pxValue()+")":"translate("+this._x.pxValue()+","+this._y.pxValue()+")"},n.fromAny=function(t){if(t instanceof n)return t;if("string"==typeof t)return n.parse(t);throw new TypeError(""+t)},n.fromValue=function(t){var e=t.header("translate");if(e.isDefined()){var r=m.zero(),o=m.zero();return e.forEach(function(t,e){var n=t.key.stringValue();void 0!==n?"x"===n?r=t.toValue().cast(m.form(),r):"y"===n&&(o=t.toValue().cast(m.form(),o)):t instanceof i.Value&&(0===e?r=t.cast(m.form(),r):1===e&&(o=t.cast(m.form(),o)))},this),new n(r,o)}},n.parse=function(t){for(var i=e.Unicode.stringInput(t);i.isCont()&&e.Unicode.isWhitespace(i.head());)i=i.step();var r=B.TranslateParser.parse(i);if(r.isDone())for(;i.isCont()&&e.Unicode.isWhitespace(i.head());)i=i.step();return i.isCont()&&!r.isError()&&(r=e.Parser.error(e.Diagnostic.unexpected(i))),r.bind()},n}(B);B.Translate=L;var H=function(t){function n(e,i){var r=t.call(this)||this;return r._x=+e,r._y=+i,r}return h(n,t),Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),n.prototype.transform=function(t,e){return t instanceof B?t instanceof B.Identity?this:new B.List([this,t]):(Array.isArray(t)&&(e=t[1],t=t[0]),"number"==typeof t&&"number"==typeof e?[t*this._x,e*this._y]:(t=m.fromAny(t),e=m.fromAny(e),[t.times(this._x),e.times(this._y)]))},n.prototype.transformX=function(t,e){return t*this._x},n.prototype.transformY=function(t,e){return e*this._y},n.prototype.inverse=function(){return new n(1/(this._x||1),1/(this._y||1))},n.prototype.toAffine=function(){return new B.Affine(this._x,0,0,this._y,0,0)},n.prototype.toValue=function(){return i.Record.of(i.Attr.of("scale",i.Record.of(i.Slot.of("x",this._x),i.Slot.of("y",this._y))))},n.prototype.conformsTo=function(t){return t instanceof n},n.prototype.equals=function(t){return t instanceof n&&(this._x===t._x&&this._y===t._y)},n.prototype.hashCode=function(){return void 0===n._hashSeed&&(n._hashSeed=r.Murmur3.seed(n)),r.Murmur3.mash(r.Murmur3.mix(r.Murmur3.mix(n._hashSeed,r.Murmur3.hash(this._x)),r.Murmur3.hash(this._y)))},n.prototype.debug=function(t){t=t.write("Transform").write(46).write("scale"),t=this._x&&!this._y?t.write("X").write(40).debug(this._x).write(41):!this._x&&this._y?t.write("Y").write(40).debug(this._y).write(41):t.write(40).debug(this._x).write(", ").debug(this._y).write(41)},n.prototype.toString=function(){return this._x&&!this._y?"scaleX("+this._x+")":!this._x&&this._y?"scaleY("+this._y+")":"scale("+this._x+","+this._y+")"},n.fromAny=function(t){if(t instanceof n)return t;if("string"==typeof t)return n.parse(t);throw new TypeError(""+t)},n.fromValue=function(t){var e=t.header("scale");if(e.isDefined()){var r=0,o=0;return e.forEach(function(t,e){var n=t.key.stringValue();void 0!==n?"x"===n?r=t.toValue().numberValue(r):"y"===n&&(o=t.toValue().numberValue(o)):t instanceof i.Value&&(0===e?r=t.numberValue(r):1===e&&(o=t.numberValue(o)))},this),new n(r,o)}},n.parse=function(t){for(var i=e.Unicode.stringInput(t);i.isCont()&&e.Unicode.isWhitespace(i.head());)i=i.step();var r=B.ScaleParser.parse(i);if(r.isDone())for(;i.isCont()&&e.Unicode.isWhitespace(i.head());)i=i.step();return i.isCont()&&!r.isError()&&(r=e.Parser.error(e.Diagnostic.unexpected(i))),r.bind()},n}(B);B.Scale=H;var X=function(t){function n(e){var i=t.call(this)||this;return i._a=a.fromAny(e,"deg"),i}return h(n,t),Object.defineProperty(n.prototype,"angle",{get:function(){return this._a},enumerable:!0,configurable:!0}),n.prototype.transform=function(t,e){if(t instanceof B)return t instanceof B.Identity?this:new B.List([this,t]);Array.isArray(t)&&(e=t[1],t=t[0]),t=m.fromAny(t),e=m.fromAny(e);var i=this._a.radValue(),r=Math.cos(i),n=Math.sin(i);return"number"==typeof t&&"number"==typeof e?[t*r-e*n,t*n+e*r]:[t.times(r).minus(e.times(n)),t.times(n).plus(e.times(r))]},n.prototype.transformX=function(t,e){var i=this._a.radValue();return t*Math.cos(i)-e*Math.sin(i)},n.prototype.transformY=function(t,e){var i=this._a.radValue();return t*Math.sin(i)+e*Math.cos(i)},n.prototype.inverse=function(){return new n(this._a.opposite())},n.prototype.toAffine=function(){var t=this._a.radValue();return new B.Affine(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0)},n.prototype.toValue=function(){return i.Record.of(i.Attr.of("rotate",this._a.toString()))},n.prototype.conformsTo=function(t){return t instanceof n},n.prototype.equals=function(t){return t instanceof n&&this._a.equals(t._a)},n.prototype.hashCode=function(){return void 0===n._hashSeed&&(n._hashSeed=r.Murmur3.seed(n)),r.Murmur3.mash(r.Murmur3.mix(n._hashSeed,this._a.hashCode()))},n.prototype.debug=function(t){t=t.write("Transform").write(46).write("rotate").write(40).debug(this._a).write(41)},n.prototype.toString=function(){return"rotate("+this._a+")"},n.fromAny=function(t){if(t instanceof n)return t;if("string"==typeof t)return n.parse(t);throw new TypeError(""+t)},n.fromValue=function(t){var e=t.header("rotate");if(e.isDefined()){var r=a.zero();return e.forEach(function(t,e){"a"===t.key.stringValue()?r=t.toValue().cast(a.form(),r):t instanceof i.Value&&0===e&&(r=t.cast(a.form(),r))},this),new n(r)}},n.parse=function(t){for(var i=e.Unicode.stringInput(t);i.isCont()&&e.Unicode.isWhitespace(i.head());)i=i.step();var r=B.RotateParser.parse(i);if(r.isDone())for(;i.isCont()&&e.Unicode.isWhitespace(i.head());)i=i.step();return i.isCont()&&!r.isError()&&(r=e.Parser.error(e.Diagnostic.unexpected(i))),r.bind()},n}(B);B.Rotate=X;var Y=function(t){function n(e,i){var r=t.call(this)||this;return r._x=a.fromAny(e,"deg"),r._y=a.fromAny(i,"deg"),r}return h(n,t),Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),n.prototype.transform=function(t,e){return t instanceof B?t instanceof B.Identity?this:new B.List([this,t]):(Array.isArray(t)&&(e=t[1],t=t[0]),t=m.fromAny(t),e=m.fromAny(e),"number"==typeof t&&"number"==typeof e?[t+e*Math.tan(this._x.radValue()),t*Math.tan(this._y.radValue())+e]:[t.plus(e.times(Math.tan(this._x.radValue()))),t.times(Math.tan(this._y.radValue())).plus(e)])},n.prototype.transformX=function(t,e){return t+e*Math.tan(this._x.radValue())},n.prototype.transformY=function(t,e){return t*Math.tan(this._y.radValue())+e},n.prototype.inverse=function(){return new n(this._x.opposite(),this._y.opposite())},n.prototype.toAffine=function(){var t=this._x.radValue(),e=this._y.radValue();return new B.Affine(1,Math.tan(e),Math.tan(t),1,0,0)},n.prototype.toValue=function(){return i.Record.of(i.Attr.of("skew",i.Record.of(i.Slot.of("x",this._x.toString()),i.Slot.of("y",this._y.toString()))))},n.prototype.conformsTo=function(t){return t instanceof n},n.prototype.equals=function(t){return t instanceof n&&(this._x.equals(t._x)&&this._y.equals(t._y))},n.prototype.hashCode=function(){return void 0===n._hashSeed&&(n._hashSeed=r.Murmur3.seed(n)),r.Murmur3.mash(r.Murmur3.mix(r.Murmur3.mix(n._hashSeed,this._x.hashCode()),this._y.hashCode()))},n.prototype.debug=function(t){t=t.write("Transform").write(46).write("skew"),t=this._x.isDefined()&&!this._y.isDefined()?t.write("X").write(40).debug(this._x).write(41):!this._x.isDefined()&&this._y.isDefined()?t.write("Y").write(40).debug(this._y).write(41):t.write(40).debug(this._x).write(", ").debug(this._y).write(41)},n.prototype.toString=function(){return this._x.isDefined()&&!this._y.isDefined()?"skewX("+this._x+")":!this._x.isDefined()&&this._y.isDefined()?"skewY("+this._y+")":"skew("+this._x+","+this._y+")"},n.fromAny=function(t){if(t instanceof n)return t;if("string"==typeof t)return n.parse(t);throw new TypeError(""+t)},n.fromValue=function(t){var e=t.header("skew");if(e.isDefined()){var r=a.zero(),o=a.zero();return e.forEach(function(t,e){var n=t.key.stringValue();void 0!==n?"x"===n?r=t.toValue().cast(a.form(),r):"y"===n&&(o=t.toValue().cast(a.form(),o)):t instanceof i.Value&&(0===e?r=t.cast(a.form(),r):1===e&&(o=t.cast(a.form(),o)))},this),new n(r,o)}},n.parse=function(t){for(var i=e.Unicode.stringInput(t);i.isCont()&&e.Unicode.isWhitespace(i.head());)i=i.step();var r=B.SkewParser.parse(i);if(r.isDone())for(;i.isCont()&&e.Unicode.isWhitespace(i.head());)i=i.step();return i.isCont()&&!r.isError()&&(r=e.Parser.error(e.Diagnostic.unexpected(i))),r.bind()},n}(B);B.Skew=Y;var G=function(t){function n(e,i,r,n,o,s){void 0===e&&(e=1),void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=1),void 0===o&&(o=0),void 0===s&&(s=0);var a=t.call(this)||this;return a._x0=+e,a._y0=+i,a._x1=+r,a._y1=+n,a._tx=+o,a._ty=+s,a}return h(n,t),Object.defineProperty(n.prototype,"x0",{get:function(){return this._x0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y0",{get:function(){return this._y0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"x1",{get:function(){return this._x1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y1",{get:function(){return this._y1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"tx",{get:function(){return this._tx},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ty",{get:function(){return this._ty},enumerable:!0,configurable:!0}),n.prototype.transform=function(t,e){return t instanceof B?t instanceof B.Identity?this:this.multiply(t.toAffine()):(Array.isArray(t)&&(e=t[1],t=t[0]),t=m.fromAny(t),e=m.fromAny(e),"number"==typeof t&&"number"==typeof e?[t*this._x0+e*this._x1+this._tx,t*this._y0+e*this._y1+this._ty]:[t.times(this._x0).plus(e.times(this._x1)).plus(this._tx),t.times(this._y0).plus(e.times(this._y1)).plus(this._ty)])},n.prototype.transformX=function(t,e){return t*this._x0+e*this._x1+this._tx},n.prototype.transformY=function(t,e){return t*this._y0+e*this._y1+this._ty},n.prototype.inverse=function(){var t=this._x0,e=this._y0,i=this._x1,r=this._y1,o=this._tx,s=this._ty,a=t*r-i*e;if(Math.abs(a)>=Number.MIN_VALUE)return new n(r/a,-e/a,-i/a,t/a,(i*s-r*o)/a,(e*o-t*s)/a);throw new Error("non-invertible affine transform with determinant "+a)},n.prototype.multiply=function(t){return new n(this._x0*t._x0+this._x1*t._y0,this._y0*t._x0+this._y1*t._y0,this._x0*t._x1+this._x1*t._y1,this._y0*t._x1+this._y1*t._y1,this._x0*t._tx+this._x1*t._ty,this._y0*t._tx+this._y1*t._ty)},n.prototype.toAffine=function(){return this},n.prototype.toValue=function(){return i.Record.of(i.Attr.of("matrix",i.Record.of(this._x0,this._y0,this._x1,this._y1,this._tx,this._ty)))},n.prototype.conformsTo=function(t){return t instanceof n},n.prototype.equals=function(t){return t instanceof n&&(this._x0===t._x0&&this._y0===t._y0&&this._x1===t._x1&&this._y1===t._y1&&this._tx===t._tx&&this._ty===t._ty)},n.prototype.hashCode=function(){return void 0===n._hashSeed&&(n._hashSeed=r.Murmur3.seed(n)),r.Murmur3.mash(r.Murmur3.mix(r.Murmur3.mix(r.Murmur3.mix(r.Murmur3.mix(r.Murmur3.mix(r.Murmur3.mix(n._hashSeed,r.Murmur3.hash(this._x0)),r.Murmur3.hash(this._y0)),r.Murmur3.hash(this._x1)),r.Murmur3.hash(this._y1)),r.Murmur3.hash(this._tx)),r.Murmur3.hash(this._ty)))},n.prototype.debug=function(t){t=t.write("Transform").write(46).write("affine").write(40).debug(this._x0).write(", ").debug(this._y0).write(", ").debug(this._x1).write(", ").debug(this._y1).write(", ").debug(this._tx).write(", ").debug(this._ty).write(41)},n.prototype.toString=function(){return"matrix("+this._x0+","+this._y0+","+this._x1+","+this._y1+","+this._tx+","+this._ty+")"},n.identity=function(){return n._identityMatrix||(n._identityMatrix=new n),n._identityMatrix},n.fromAny=function(t){if(t instanceof n)return t;if("string"==typeof t)return n.parse(t);throw new TypeError(""+t)},n.fromValue=function(t){var e=t.header("matrix");if(e.isDefined()){var r=0,o=0,s=0,a=0,u=0,h=0;return e.forEach(function(t,e){var n=t.key.stringValue();if(void 0!==n)"x0"===n?r=t.toValue().numberValue(r):"y0"===n?o=t.toValue().numberValue(o):"x1"===n?s=t.toValue().numberValue(s):"y1"===n?a=t.toValue().numberValue(a):"tx"===n?u=t.toValue().numberValue(u):"ty"===n&&(h=t.toValue().numberValue(h));else if(t instanceof i.Value)switch(e){case 0:r=t.numberValue(r);break;case 1:o=t.numberValue(o);break;case 2:s=t.numberValue(s);break;case 3:a=t.numberValue(a);break;case 4:u=t.numberValue(u);break;case 5:h=t.numberValue(h)}},this),new n(r,o,s,a,u,h)}},n.parse=function(t){for(var i=e.Unicode.stringInput(t);i.isCont()&&e.Unicode.isWhitespace(i.head());)i=i.step();var r=B.AffineParser.parse(i);if(r.isDone())for(;i.isCont()&&e.Unicode.isWhitespace(i.head());)i=i.step();return i.isCont()&&!r.isError()&&(r=e.Parser.error(e.Diagnostic.unexpected(i))),r.bind()},n}(B);B.Affine=G;var K=function(t){function e(i){for(var r=t.call(this)||this,n=[],o=0;o<i.length;o+=1){var s=B.fromAny(i[o]);s instanceof e?n.push.apply(n,s._transforms):!s||s instanceof B.Identity||n.push(s)}return r._transforms=n,r}return h(e,t),Object.defineProperty(e.prototype,"transforms",{get:function(){return this._transforms},enumerable:!0,configurable:!0}),e.prototype.transform=function(t,e){if(t instanceof B)return t instanceof B.Identity?this:new B.List([this,t]);Array.isArray(t)&&(e=t[1],t=t[0]);var i=this._transforms;if("number"==typeof t&&"number"==typeof e){for(var r=[t,e],n=0,o=i.length;n<o;n+=1)r=i[n].transform(r);return r}for(r=[m.fromAny(t),m.fromAny(e)],n=0,o=i.length;n<o;n+=1)r=i[n].transform(r);return r},e.prototype.transformX=function(t,e){for(var i=this._transforms,r=0,n=i.length;r<n;r+=1)t=i[r].transformX(t,e),e=i[r].transformX(t,e);return t},e.prototype.transformY=function(t,e){for(var i=this._transforms,r=0,n=i.length;r<n;r+=1)t=i[r].transformX(t,e),e=i[r].transformX(t,e);return e},e.prototype.inverse=function(){for(var t=this._transforms,i=t.length,r=new Array(i),n=0;n<i;n+=1)r[n]=t[i-n-1].inverse();return new e(r)},e.prototype.toAffine=function(){for(var t=G.identity(),e=this._transforms,i=0,r=e.length;i<r;i+=1)t=t.multiply(e[i].toAffine());return t},e.prototype.toValue=function(){for(var t=this._transforms,e=t.length,r=i.Record.create(e),n=0;n<e;n+=1)r.push(t[n].toValue());return r},e.prototype.conformsTo=function(t){if(t instanceof e){var i=this._transforms.length;if(i===t._transforms.length){for(var r=0;r<i;r+=1)if(!this._transforms[r].conformsTo(t._transforms[r]))return!1;return!0}}return!1},e.prototype.equals=function(t){if(t instanceof e){var i=this._transforms.length;if(i===t._transforms.length){for(var r=0;r<i;r+=1)if(!this._transforms[r].equals(t._transforms[r]))return!1;return!0}}return!1},e.prototype.hashCode=function(){void 0===e._hashSeed&&(e._hashSeed=r.Murmur3.seed(e));for(var t=e._hashSeed,i=this._transforms,n=0,o=i.length;n<o;n+=1)t=r.Murmur3.mix(t,i[n].hashCode());return r.Murmur3.mash(t)},e.prototype.debug=function(t){t=t.write("Transform").write(46).write("list").write(40);var e=this._transforms,i=e.length;if(i>0){t=t.debug(e[0]);for(var r=1;r<i;r+=1)t=t.write(", ").debug(e[r])}t=t.write(41)},e.prototype.toString=function(){var t=this._transforms,e=t.length;if(e>0){for(var i=t[0].toString(),r=1;r<e;r+=1)i=i+" "+t[r].toString();return i}return""},e.prototype.toAttributeString=function(){var t=this._transforms,e=t.length;if(e>0){for(var i=t[0].toAttributeString(),r=1;r<e;r+=1)i=i+" "+t[r].toAttributeString();return i}return""},e.fromAny=function(t){if(t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.fromValue=function(t){var i=[];if(t.forEach(function(t){var e=B.fromValue(t.toValue());e&&i.push(e)},this),i.length)return new e(i)},e.parse=function(t){var i=B.parse(t);return i instanceof e?i:new e([i])},e}(B);B.List=K;var Q=function(t){function i(e,i,r,n){var o=t.call(this)||this;return o.identOutput=e,o.xParser=i,o.yParser=r,o.step=n,o}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this.identOutput,this.xParser,this.yParser,this.step)},i.parse=function(t,r,n,o,s){void 0===s&&(s=1);var a=0;if(1===s){for(r=r||e.Unicode.stringOutput();t.isCont()&&(a=t.head(),e.Unicode.isAlpha(a));)t=t.step(),r.write(a);if(!t.isEmpty())switch(u=r.bind()){case"translateX":case"translateY":case"translate":s=2;break;default:return e.Parser.error(e.Diagnostic.message("unknown transform function: "+u,t))}}if(2===s){for(;t.isCont()&&(a=t.head(),e.Unicode.isSpace(a));)t=t.step();if(t.isCont()&&40===a)t.step(),s=3;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected("(",t))}if(3===s){if(n)n=n.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();t.isEmpty()||(n=S.parse(t,"px"))}if(n)if(n.isDone())s=4;else if(n.isError())return n.asError()}if(4===s){for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();if(t.isCont())if(41===(a=t.head())){switch(t.step(),u=r.bind()){case"translateX":return e.Parser.done(B.translateX(n.bind()));case"translateY":return e.Parser.done(B.translateY(n.bind()));default:return e.Parser.error(e.Diagnostic.message("unknown transform function: "+u,t))}}else{if(44!==a)return e.Parser.error(e.Diagnostic.expected(",",t));t.step(),s=5}else if(t.isDone())return e.Parser.error(e.Diagnostic.unexpected(t))}if(5===s){if(o)o=o.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();t.isEmpty()||(o=S.parse(t,"px"))}if(o)if(o.isDone())s=6;else if(o.isError())return o.asError()}if(6===s){for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();var u;if(t.isCont()&&41===t.head())switch(t.step(),u=r.bind()){case"translate":return e.Parser.done(B.translate(n.bind(),o.bind()));default:return e.Parser.error(e.Diagnostic.message("unknown transform function: "+u,t))}else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected(")",t))}return new i(r,n,o,s)},i.parseRest=function(t,e){return i.parse(t,e,void 0,void 0,2)},i}(e.Parser);B.TranslateParser=Q;var Z=function(t){function i(e,i,r,n){var o=t.call(this)||this;return o.identOutput=e,o.xParser=i,o.yParser=r,o.step=n,o}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this.identOutput,this.xParser,this.yParser,this.step)},i.parse=function(t,r,n,o,s){void 0===s&&(s=1);var a=0;if(1===s){for(r=r||e.Unicode.stringOutput();t.isCont()&&(a=t.head(),e.Unicode.isAlpha(a));)t=t.step(),r.write(a);if(!t.isEmpty())switch(u=r.bind()){case"scaleX":case"scaleY":case"scale":s=2;break;default:return e.Parser.error(e.Diagnostic.message("unknown transform function: "+u,t))}}if(2===s){for(;t.isCont()&&(a=t.head(),e.Unicode.isSpace(a));)t=t.step();if(t.isCont()&&40===a)t.step(),s=3;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected("(",t))}if(3===s){if(n)n=n.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();t.isEmpty()||(n=e.Base10.parseNumber(t))}if(n)if(n.isDone())s=4;else if(n.isError())return n.asError()}if(4===s){for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();if(t.isCont())if(41===(a=t.head())){switch(t.step(),u=r.bind()){case"scaleX":return e.Parser.done(B.scaleX(n.bind()));case"scaleY":return e.Parser.done(B.scaleY(n.bind()));default:return e.Parser.error(e.Diagnostic.message("unknown transform function: "+u,t))}}else{if(44!==a)return e.Parser.error(e.Diagnostic.expected(",",t));t.step(),s=5}else if(t.isDone())return e.Parser.error(e.Diagnostic.unexpected(t))}if(5===s){if(o)o=o.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();t.isEmpty()||(o=e.Base10.parseNumber(t))}if(o)if(o.isDone())s=6;else if(o.isError())return o.asError()}if(6===s){for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();var u;if(t.isCont()&&41===t.head())switch(t.step(),u=r.bind()){case"scale":return e.Parser.done(B.scale(n.bind(),o.bind()));default:return e.Parser.error(e.Diagnostic.message("unknown transform function: "+u,t))}else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected(")",t))}return new i(r,n,o,s)},i.parseRest=function(t,e){return i.parse(t,e,void 0,void 0,2)},i}(e.Parser);B.ScaleParser=Z;var J=function(t){function i(e,i,r){var n=t.call(this)||this;return n.identOutput=e,n.aParser=i,n.step=r,n}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this.identOutput,this.aParser,this.step)},i.parse=function(t,r,n,o){void 0===o&&(o=1);var s=0;if(1===o){for(r=r||e.Unicode.stringOutput();t.isCont()&&(s=t.head(),e.Unicode.isAlpha(s));)t=t.step(),r.write(s);if(!t.isEmpty())switch(a=r.bind()){case"rotate":o=2;break;default:return e.Parser.error(e.Diagnostic.message("unknown transform function: "+a,t))}}if(2===o){for(;t.isCont()&&(s=t.head(),e.Unicode.isSpace(s));)t=t.step();if(t.isCont()&&40===s)t.step(),o=3;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected("(",t))}if(3===o){if(n)n=n.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();t.isEmpty()||(n=v.parse(t,"deg"))}if(n)if(n.isDone())o=4;else if(n.isError())return n.asError()}if(4===o){for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();var a;if(t.isCont()&&41===t.head())switch(t.step(),a=r.bind()){case"rotate":return e.Parser.done(B.rotate(n.bind()));default:return e.Parser.error(e.Diagnostic.message("unknown transform function: "+a,t))}else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected(")",t))}return new i(r,n,o)},i.parseRest=function(t,e){return i.parse(t,e,void 0,2)},i}(e.Parser);B.RotateParser=J;var $=function(t){function i(e,i,r,n){var o=t.call(this)||this;return o.identOutput=e,o.xParser=i,o.yParser=r,o.step=n,o}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this.identOutput,this.xParser,this.yParser,this.step)},i.parse=function(t,r,n,o,s){void 0===s&&(s=1);var a=0;if(1===s){for(r=r||e.Unicode.stringOutput();t.isCont()&&(a=t.head(),e.Unicode.isAlpha(a));)t=t.step(),r.write(a);if(!t.isEmpty())switch(u=r.bind()){case"skewX":case"skewY":case"skew":s=2;break;default:return e.Parser.error(e.Diagnostic.message("unknown transform function: "+u,t))}}if(2===s){for(;t.isCont()&&(a=t.head(),e.Unicode.isSpace(a));)t=t.step();if(t.isCont()&&40===a)t.step(),s=3;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected("(",t))}if(3===s){if(n)n=n.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();t.isEmpty()||(n=v.parse(t,"deg"))}if(n)if(n.isDone())s=4;else if(n.isError())return n.asError()}if(4===s){for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();if(t.isCont())if(41===(a=t.head())){switch(t.step(),u=r.bind()){case"skewX":return e.Parser.done(B.skewX(n.bind()));case"skewY":return e.Parser.done(B.skewY(n.bind()));default:return e.Parser.error(e.Diagnostic.message("unknown transform function: "+u,t))}}else{if(44!==a)return e.Parser.error(e.Diagnostic.expected(",",t));t.step(),s=5}else if(t.isDone())return e.Parser.error(e.Diagnostic.unexpected(t))}if(5===s){if(o)o=o.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();t.isEmpty()||(o=v.parse(t,"deg"))}if(o)if(o.isDone())s=6;else if(o.isError())return o.asError()}if(6===s){for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();var u;if(t.isCont()&&41===t.head())switch(t.step(),u=r.bind()){case"skew":return e.Parser.done(B.skew(n.bind(),o.bind()));default:return e.Parser.error(e.Diagnostic.message("unknown transform function: "+u,t))}else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected(")",t))}return new i(r,n,o,s)},i.parseRest=function(t,e){return i.parse(t,e,void 0,void 0,2)},i}(e.Parser);B.SkewParser=$;var tt=function(t){function i(e,i,r,n){var o=t.call(this)||this;return o.identOutput=e,o.entries=i,o.entryParser=r,o.step=n,o}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this.identOutput,this.entries,this.entryParser,this.step)},i.parse=function(t,r,n,o,s){void 0===n&&(n=[]),void 0===s&&(s=1);var a=0;if(1===s){for(r=r||e.Unicode.stringOutput();t.isCont()&&(a=t.head(),e.Unicode.isAlpha(a));)t=t.step(),r.write(a);if(!t.isEmpty())switch(u=r.bind()){case"matrix":s=2;break;default:return e.Parser.error(e.Diagnostic.message("unknown transform function: "+u,t))}}if(2===s){for(;t.isCont()&&(a=t.head(),e.Unicode.isSpace(a));)t=t.step();if(t.isCont()&&40===a)t.step(),s=3;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.expected("(",t))}for(;;){if(3===s){if(o)o=o.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();t.isEmpty()||(o=e.Base10.parseNumber(t))}if(o)if(o.isDone())n.push(o.bind()),o=void 0,s=4;else if(o.isError())return o.asError()}if(4===s){for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();if(t.isCont()){if(41!==(a=t.head())){if(n.length>=6)return e.Parser.error(e.Diagnostic.expected(")",t));if(44===a){t.step(),s=3;continue}return e.Parser.error(e.Diagnostic.expected(",",t))}var u;switch(t.step(),u=r.bind()){case"matrix":return e.Parser.done(B.affine.apply(B,n));default:return e.Parser.error(e.Diagnostic.message("unknown transform function: "+u,t))}}else if(t.isDone())return e.Parser.error(e.Diagnostic.unexpected(t))}break}return new i(r,n,o,s)},i.parseRest=function(t,e){return i.parse(t,e,void 0,void 0,2)},i}(e.Parser);B.AffineParser=tt;var et=function(t){function i(e,i){var r=t.call(this)||this;return r.transform=e,r.transformParser=i,r}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this.transform,this.transformParser)},i.parse=function(t,r,n){for(void 0===r&&(r=B.identity());;){if(!n){for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();if(t.isCont())n=B.Parser.parse(t);else if(t.isDone())return e.Parser.done(r)}if(n){if((n=n.feed(t)).isDone()){r=r.transform(n.bind()),n=void 0;continue}if(n.isError())return n.asError()}break}return new i(r,n)},i}(e.Parser);B.ListParser=et;var it=function(t){function i(e){var i=t.call(this)||this;return i.identOutput=e,i}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this.identOutput)},i.parse=function(t,r){var n=0;for(r=r||e.Unicode.stringOutput();t.isCont()&&(n=t.head(),e.Unicode.isAlpha(n));)t=t.step(),r.write(n);if(!t.isEmpty()){var o=r.bind();switch(o){case"translateX":case"translateY":case"translate":return B.TranslateParser.parseRest(t,r);case"scaleX":case"scaleY":case"scale":return B.ScaleParser.parseRest(t,r);case"rotate":return B.RotateParser.parseRest(t,r);case"skewX":case"skewY":case"skew":return B.SkewParser.parseRest(t,r);case"matrix":return B.AffineParser.parseRest(t,r);case"none":return e.Parser.done(B.identity());default:return e.Parser.error(e.Diagnostic.message("unknown transform function: "+o,t))}}return new i(r)},i}(e.Parser);B.Parser=it;var rt=function(t){function e(e){var i=t.call(this)||this;return i._unit=e,i}return h(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t){return(t=B.fromAny(t)).toValue()},e.prototype.cast=function(t){var e=t.toValue();try{if(e instanceof i.Record)return B.fromValue(e);var r=e.stringValue(void 0);if(void 0!==r)return B.parse(r)}catch(t){}},e}(i.Form);B.Form=rt;var nt=function(){function t(){}return t.step=function(e,i){return new t.Step(e,i)},t.number=function(e,i){return new t.Number(e,i)},t.time=function(e,i){return new t.DateTime(e,i)},t.angle=function(e,i){return new t.Angle(e,i)},t.len=function(e,i){return new t.Length(e,i)},t.array=function(e,i){return new t.Array(e,i)},t.interpolator=function(e,i){return new t.Interpolator(e,i)},t.from=function(e,r){return e instanceof n.R2Shape||r instanceof n.R2Shape?t.shape(e,r):e instanceof o.DateTime||e instanceof Date||r instanceof o.DateTime||r instanceof Date?t.time(e,r):e instanceof a||r instanceof a?t.angle(e,r):e instanceof m||r instanceof m?t.len(e,r):e instanceof C||r instanceof C?t.color(e,r):e instanceof B||r instanceof B?t.transform(e,r):e instanceof i.Item||r instanceof i.Item?t.structure(e,r):"number"==typeof e||"number"==typeof r?t.number(e,r):Array.isArray(e)||Array.isArray(r)?t.array(e,r):e instanceof t&&r instanceof t?t.interpolator(e,r):t.step(e,r)},t.fromAny=function(e){if(e instanceof t)return e;if("string"==typeof e)switch(e){case"step":return t.step();case"number":return t.number();case"shape":return t.shape();case"time":return t.time();case"angle":return t.angle();case"length":return t.len();case"transform":return t.transform();case"color":return t.color();case"array":return t.array()}throw new TypeError(""+e)},t.form=function(e,i){return void 0===e&&(e=t.valueForm()),e!==t.valueForm()||void 0!==i?new t.Form(e,void 0!==i?t.fromAny(i):void 0):(t._form||(t._form=new t.Form(e)),t._form)},t.valueForm=function(){throw new Error},t}(),ot=function(t){function e(e,i){var r=t.call(this)||this;return void 0===i?i=e:void 0===e&&(e=i),r.y0=e,r.y1=i,r}return h(e,t),e.prototype.interpolate=function(t){var e=t<1?this.y0:this.y1;if(void 0===e)throw new TypeError;return e},e.prototype.deinterpolate=function(t){return t===this.y1?1:0},e.prototype.range=function(t,i){if(void 0===t){if(void 0===this.y0||void 0===this.y1)throw new TypeError;return[this.y0,this.y1]}return void 0===i?new e((t=t)[0],t[1]):new e(t,i)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.y0===t.y0&&this.y1===t.y1)},e}(nt);nt.Step=ot;var st=function(t){function e(e,i){var r=t.call(this)||this;return void 0===e&&void 0===i?i=e=0:void 0===i?i=e:void 0===e&&(e=i),r.y0=+e,r.dy=+i-r.y0,r}return h(e,t),e.prototype.interpolate=function(t){return this.y0+this.dy*t},e.prototype.deinterpolate=function(t){return this.dy?(+t-this.y0)/this.dy:this.dy},e.prototype.range=function(t,i){return void 0===t?[this.y0,this.y0+this.dy]:void 0===i?new e((t=t)[0],t[1]):new e(t,i)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.y0===t.y0&&this.dy===t.dy)},e}(nt);nt.Number=st;var at=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.range=function(t,e){return void 0===t?[this.interpolate(0),this.interpolate(1)]:void 0===e?(t=t,nt.shape(t[0],t[1])):nt.shape(t,e)},e.shape=function(t,i){if(void 0===t&&void 0===i)return new e.Identity;if(void 0!==t&&(t=n.Shape.fromAny(t)),void 0!==i&&(i=n.Shape.fromAny(i)),t||i?i?t||(t=i):i=t:i=t=n.PointR2.origin(),t instanceof n.PointR2&&i instanceof n.PointR2)return new e.PointR2(t,i);if(t instanceof n.SegmentR2&&i instanceof n.SegmentR2)return new e.SegmentR2(t,i);if(t instanceof n.BoxR2&&i instanceof n.BoxR2)return new e.BoxR2(t,i);if(t instanceof n.CircleR2&&i instanceof n.CircleR2)return new e.CircleR2(t,i);if(t instanceof n.R2Shape&&i instanceof n.R2Shape)return t instanceof n.BoxR2||(t=new n.BoxR2(t.xMin,t.yMin,t.xMax,t.yMax)),i instanceof n.BoxR2||(i=new n.BoxR2(i.xMin,i.yMin,i.xMax,i.yMax)),new e.BoxR2(t,i);throw new TypeError(t+", "+i)},e}(nt);nt.Shape=at,nt.shape=at.shape;var ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.interpolate=function(t){return n.PointR2.origin()},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e},e}(at);at.Identity=ut;var ht=function(t){function e(e,i){var r=t.call(this)||this;return void 0!==e&&(e=n.Shape.fromAny(e)),void 0!==i&&(i=n.Shape.fromAny(i)),e||i?i?e||(e=i):i=e:i=e=n.PointR2.origin(),r.x=e.x,r.dx=i.x-r.x,r.y=e.y,r.dy=i.y-r.y,r}return h(e,t),e.prototype.interpolate=function(t){var e=this.x+this.dx*t,i=this.y+this.dy*t;return new n.PointR2(e,i)},e.prototype.deinterpolate=function(t){if((t=n.Shape.fromAny(t))instanceof n.PointR2){var e=t.x-this.x,i=t.y-this.y,r=e*this.dx+i*this.dy,o=Math.sqrt(e*e+i*i);return o?r/o:o}return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x===t.x&&this.dx===t.dx&&this.y===t.y&&this.dy===t.dy)},e}(at);at.PointR2=ht;var lt=function(t){function e(e,i){var r=t.call(this)||this;return void 0!==e&&(e=n.Shape.fromAny(e)),void 0!==i&&(i=n.Shape.fromAny(i)),e||i?i?e||(e=i):i=e:i=e=new n.SegmentR2(0,0,0,0),r.x0=e.x0,r.dx0=i.x0-r.x0,r.y0=e.y0,r.dy0=i.y0-r.y0,r.x1=e.x1,r.dx1=i.x1-r.x1,r.y1=e.y1,r.dy1=i.y1-r.y1,r}return h(e,t),e.prototype.interpolate=function(t){var e=this.x0+this.dx0*t,i=this.y0+this.dy0*t,r=this.x1+this.dx1*t,o=this.y1+this.dy1*t;return new n.SegmentR2(e,i,r,o)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.dx0===t.dx0&&this.y0===t.y0&&this.dy0===t.dy0&&this.x1===t.x1&&this.dx1===t.dx1&&this.y1===t.y1&&this.dy1===t.dy1)},e}(at);at.SegmentR2=lt;var pt=function(t){function e(e,i){var r=t.call(this)||this;return void 0!==e&&(e=n.Shape.fromAny(e)),void 0!==i&&(i=n.Shape.fromAny(i)),e||i?i?e||(e=i):i=e:i=e=new n.BoxR2(0,0,0,0),r.xMin=e.xMin,r.dxMin=i.xMin-r.xMin,r.yMin=e.yMin,r.dyMin=i.yMin-r.yMin,r.xMax=e.xMax,r.dxMax=i.xMax-r.xMax,r.yMax=e.yMax,r.dyMax=i.yMax-r.yMax,r}return h(e,t),e.prototype.interpolate=function(t){var e=this.xMin+this.dxMin*t,i=this.yMin+this.dyMin*t,r=this.xMax+this.dxMax*t,o=this.yMax+this.dyMax*t;return new n.BoxR2(e,i,r,o)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.xMin===t.xMin&&this.dxMin===t.dxMin&&this.yMin===t.yMin&&this.dyMin===t.dyMin&&this.xMax===t.xMax&&this.dxMax===t.dxMax&&this.yMax===t.yMax&&this.dyMax===t.dyMax)},e}(at);at.BoxR2=pt;var ct=function(t){function e(e,i){var r=t.call(this)||this;return void 0!==e&&(e=n.Shape.fromAny(e)),void 0!==i&&(i=n.Shape.fromAny(i)),e||i?i?e||(e=i):i=e:i=e=new n.CircleR2(0,0,0),r.cx=e.cx,r.dcx=i.cx-r.cx,r.cy=e.cy,r.dcy=i.cy-r.cy,r.r=e.r,r.dr=i.r-r.r,r}return h(e,t),e.prototype.interpolate=function(t){var e=this.cx+this.dcx*t,i=this.cy+this.dcy*t,r=this.r+this.dr*t;return new n.CircleR2(e,i,r)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.cx===t.cx&&this.dcx===t.dcx&&this.cy===t.cy&&this.dcy===t.dcy&&this.r===t.r&&this.dr===t.dr)},e}(at);at.CircleR2=ct;var dt=function(t){function e(e,i,r){var n=t.call(this)||this;return void 0===e&&void 0===i?i=e=0:void 0===i?i=e:void 0===e&&(e=i),e=o.DateTime.fromAny(e),i=o.DateTime.fromAny(i),n.t0=e.time(),n.dt=i.time()-n.t0,n.zone=r||e.zone(),n}return h(e,t),e.prototype.interpolate=function(t){return new o.DateTime(this.t0+this.dt*t,this.zone)},e.prototype.deinterpolate=function(t){return t=o.DateTime.time(t),this.dt?(t-this.t0)/this.dt:this.dt},e.prototype.range=function(t,i){return void 0===t?[new o.DateTime(this.t0,this.zone),new o.DateTime(this.t0+this.dt,this.zone)]:void 0===i?new e((t=t)[0],t[1],this.zone):new e(t,i,this.zone)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.t0===t.t0&&this.dt===t.dt)},e}(nt);nt.DateTime=dt;var ft=function(t){function e(e,i){var r=t.call(this)||this;return void 0!==e&&(e=a.fromAny(e)),void 0!==i&&(i=a.fromAny(i)),e||i?i?e=e?e.to(i.units()):i:i=e:i=e=a.zero(),r.v0=e.value(),r.dv=i.value()-r.v0,r.units=i.units(),r}return h(e,t),e.prototype.interpolate=function(t){return a.from(this.v0+this.dv*t,this.units)},e.prototype.deinterpolate=function(t){var e=a.fromAny(t).toValue(this.units);return this.dv?(e-this.v0)/this.dv:this.dv},e.prototype.range=function(t,i){return void 0===t?[a.from(this.v0,this.units),a.from(this.v0+this.dv,this.units)]:void 0===i?new e((t=t)[0],t[1]):new e(t,i)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.v0===t.v0&&this.dv===t.dv&&this.units===t.units)},e}(nt);nt.Angle=ft;var vt=function(t){function e(e,i){var r=t.call(this)||this;return void 0!==e&&(e=m.fromAny(e)),void 0!==i&&(i=m.fromAny(i)),i||i?i?e=e?e.to(i.units()):i:i=e:i=e=m.zero(),r.v0=e.value(),r.dv=i.value()-r.v0,r.units=i.units(),r}return h(e,t),e.prototype.interpolate=function(t){return m.from(this.v0+this.dv*t,this.units)},e.prototype.deinterpolate=function(t){var e=m.fromAny(t).toValue(this.units);return this.dv?(e-this.v0)/this.dv:this.dv},e.prototype.range=function(t,i){return void 0===t?[m.from(this.v0,this.units),m.from(this.v0+this.dv,this.units)]:void 0===i?new e((t=t)[0],t[1]):new e(t,i)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.v0===t.v0&&this.dv===t.dv&&this.units===t.units)},e}(nt);nt.Length=vt;var yt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.range=function(t,e){return void 0===t?[this.interpolate(0),this.interpolate(1)]:void 0===e?(t=t,nt.color(t[0],t[1])):nt.color(t,e)},e.color=function(t,i){return void 0===t&&void 0===i?new e.Identity:(void 0!==t&&(t=C.fromAny(t)),void 0!==i&&(i=C.fromAny(i)),t||i?i?t||(t=i):i=t:i=t=C.transparent(),t instanceof P&&i instanceof P?e.hsl(t,i):e.rgb(t.rgb(),i.rgb()))},e.rgb=function(t,i){return new e.Rgb(t,i)},e.hsl=function(t,i){return new e.Hsl(t,i)},e}(nt);nt.Color=yt,nt.color=yt.color;var mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.interpolate=function(t){return C.transparent()},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e},e}(yt);yt.Identity=mt;var wt=function(t){function e(e,i){var r=t.call(this)||this;return void 0!==e&&(e=C.rgb(e)),void 0!==i&&(i=C.rgb(i)),e||i?i?e||(e=i):i=e:i=e=V.transparent(),r.r0=e.r,r.dr=i.r-r.r0,r.g0=e.g,r.dg=i.g-r.g0,r.b0=e.b,r.db=i.b-r.b0,r.a0=e.a,r.da=i.a-r.a0,r}return h(e,t),e.prototype.interpolate=function(t){var e=this.r0+this.dr*t,i=this.g0+this.dg*t,r=this.b0+this.db*t,n=this.a0+this.da*t;return new V(e,i,r,n)},e.prototype.deinterpolate=function(t){var e=(t=C.rgb(t)).r-this.r0,i=t.g-this.g0,r=t.b-this.b0,n=t.a-this.a0,o=e*this.dr+i*this.dg+r*this.db+n*this.da,s=Math.sqrt(e*e+i*i+r*r+n*n);return s?o/s:s},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.r0===t.r0&&this.dr===t.dr&&this.g0===t.g0&&this.dg===t.dg&&this.b0===t.b0&&this.db===t.db&&this.a0===t.a0&&this.da===t.da)},e}(yt);yt.Rgb=wt;var gt=function(t){function e(e,i){var r=t.call(this)||this;return void 0!==e&&(e=C.hsl(e)),void 0!==i&&(i=C.hsl(i)),e||i?i?e||(e=i):i=e:i=e=P.transparent(),r.h0=e.h,r.dh=i.h-r.h0,r.s0=e.s,r.ds=i.s-r.s0,r.l0=e.l,r.dl=i.l-r.l0,r.a0=e.a,r.da=i.a-r.a0,r}return h(e,t),e.prototype.interpolate=function(t){var e=this.h0+this.dh*t,i=this.s0+this.ds*t,r=this.l0+this.dl*t,n=this.a0+this.da*t;return new P(e,i,r,n)},e.prototype.deinterpolate=function(t){var e=(t=C.hsl(t)).h-this.h0,i=t.s-this.s0,r=t.l-this.l0,n=t.a-this.a0,o=e*this.dh+i*this.ds+r*this.dl+n*this.da,s=Math.sqrt(e*e+i*i+r*r+n*n);return s?o/s:s},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.h0===t.h0&&this.dh===t.dh&&this.s0===t.s0&&this.ds===t.ds&&this.l0===t.l0&&this.dl===t.dl&&this.a0===t.a0&&this.da===t.da)},e}(yt);yt.Hsl=gt;var _t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.range=function(t,e){return void 0===t?[this.interpolate(0),this.interpolate(1)]:void 0===e?(t=t,nt.transform(t[0],t[1])):nt.transform(t,e)},e.transform=function(t,i){return void 0===t&&void 0===i?new e.Identity:(void 0!==t&&(t=B.fromAny(t)),void 0!==i&&(i=B.fromAny(i)),t||i?i?t||(t=i):i=t:i=t=B.identity(),t instanceof L&&i instanceof L?e.translate(t,i):t instanceof H&&i instanceof H?e.scale(t,i):t instanceof X&&i instanceof X?e.rotate(t,i):t instanceof Y&&i instanceof Y?e.skew(t,i):t instanceof K&&i instanceof K&&t.conformsTo(i)?e.list(t,i):e.affine(t.toAffine(),i.toAffine()))},e.translate=function(t,i){return new e.Translate(t,i)},e.scale=function(t,i){return new e.Scale(t,i)},e.rotate=function(t,i){return new e.Rotate(t,i)},e.skew=function(t,i){return new e.Skew(t,i)},e.affine=function(t,i){return new e.Affine(t,i)},e.list=function(t,i){return new e.List(t,i)},e}(nt);nt.Transform=_t,nt.transform=_t.transform;var bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.interpolate=function(t){return B.identity()},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e},e}(_t);_t.Identity=bt;var xt=function(t){function e(e,i){var r,n,o,s,a=t.call(this)||this;return void 0!==e?(r=(e=L.fromAny(e)).x,n=e.y):(r=void 0,n=void 0),void 0!==i?(o=(i=L.fromAny(i)).x,s=i.y):(o=void 0,s=void 0),r||o?o?r=r?r.to(o.units()):o:o=r:o=r=m.zero(),n||s?s?n=n?n.to(s.units()):s:s=n:s=n=m.zero(),a.x0=r.value(),a.dx=o.value()-a.x0,a.xUnits=o.units(),a.y0=n.value(),a.dy=s.value()-a.y0,a.yUnits=s.units(),a}return h(e,t),e.prototype.interpolate=function(t){var e=m.from(this.x0+this.dx*t,this.xUnits),i=m.from(this.y0+this.dy*t,this.yUnits);return new L(e,i)},e.prototype.deinterpolate=function(t){if((t=B.fromAny(t))instanceof L){var e=t.x.units(),i=m.fromAny(this.x0,this.xUnits).toValue(e),r=m.fromAny(this.y0,this.yUnits).toValue(e),n=m.fromAny(this.dx,this.xUnits).toValue(e),o=m.fromAny(this.dy,this.yUnits).toValue(e),s=t.x.toValue(e)-i,a=t.y.toValue(e)-r,u=s*n+a*o,h=Math.sqrt(s*s+a*a);return h?u/h:h}return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.dx===t.dx&&this.xUnits===t.xUnits&&this.y0===t.y0&&this.dy===t.dy&&this.yUnits===t.yUnits)},e}(_t);_t.Translate=xt;var St=function(t){function e(e,i){var r,n,o,s,a=t.call(this)||this;return void 0!==e?(r=(e=H.fromAny(e)).x,n=e.y):(r=void 0,n=void 0),void 0!==i?(o=(i=H.fromAny(i)).x,s=i.y):(o=void 0,s=void 0),void 0!==r||o?void 0===o?o=r:void 0===r&&(r=o):o=r=1,void 0===n&&void 0===s?s=n=1:void 0===s?s=n:void 0===n&&(n=s),a.x0=r,a.dx=o-a.x0,a.y0=n,a.dy=s-a.y0,a}return h(e,t),e.prototype.interpolate=function(t){var e=this.x0+this.dx*t,i=this.y0+this.dy*t;return new H(e,i)},e.prototype.deinterpolate=function(t){if((t=B.fromAny(t))instanceof H){var e=t.x-this.x0,i=t.y-this.y0,r=e*this.dx+i*this.dy,n=Math.sqrt(e*e+i*i);return n?r/n:n}return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.dx===t.dx&&this.y0===t.y0&&this.dy===t.dy)},e}(_t);_t.Scale=St;var At=function(t){function e(e,i){var r,n,o=t.call(this)||this;return r=void 0!==e?(e=X.fromAny(e)).angle:void 0,n=void 0!==i?(i=X.fromAny(i)).angle:void 0,r||n?n?r=r?r.to(n.units()):n:n=r:n=r=a.zero(),o.v0=r.value(),o.dv=n.value()-o.v0,o.units=n.units(),o}return h(e,t),e.prototype.interpolate=function(t){var e=a.from(this.v0+this.dv*t,this.units);return new X(e)},e.prototype.deinterpolate=function(t){if((t=B.fromAny(t))instanceof X){var e=t.angle.toValue(this.units);return this.dv?(e-this.v0)/this.dv:this.dv}return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.v0===t.v0&&this.dv===t.dv&&this.units===t.units)},e}(_t);_t.Rotate=At;var Ct=function(t){function e(e,i){var r,n,o,s,u=t.call(this)||this;return void 0!==e?(r=(e=Y.fromAny(e)).x,n=e.y):(r=void 0,n=void 0),void 0!==i?(o=(i=Y.fromAny(i)).x,s=i.y):(o=void 0,s=void 0),r||o?o?r=r?r.to(o.units()):o:o=r:o=r=a.zero(),n||s?s?n=n?n.to(s.units()):s:s=n:s=n=a.zero(),u.x0=r.value(),u.dx=o.value()-u.x0,u.xUnits=o.units(),u.y0=n.value(),u.dy=s.value()-u.y0,u.yUnits=s.units(),u}return h(e,t),e.prototype.interpolate=function(t){var e=a.from(this.x0+this.dx*t,this.xUnits),i=a.from(this.y0+this.dy*t,this.yUnits);return new Y(e,i)},e.prototype.deinterpolate=function(t){if((t=B.fromAny(t))instanceof Y){var e=t.x.units(),i=a.fromAny(this.x0,this.xUnits).toValue(e),r=a.fromAny(this.y0,this.yUnits).toValue(e),n=a.fromAny(this.dx,this.xUnits).toValue(e),o=a.fromAny(this.dy,this.yUnits).toValue(e),s=t.x.toValue(e)-i,u=t.y.toValue(e)-r,h=s*n+u*o,l=Math.sqrt(s*s+u*u);return l?h/l:l}return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.dx===t.dx&&this.xUnits===t.xUnits&&this.y0===t.y0&&this.dy===t.dy&&this.yUnits===t.yUnits)},e}(_t);_t.Skew=Ct;var Vt=function(t){function e(e,i){var r=t.call(this)||this;return void 0!==e&&(e=G.fromAny(e)),void 0!==i&&(i=G.fromAny(i)),e||i?i?e||(e=i):i=e:i=e=new G,r.f0=e,r.f1=i,r}return h(e,t),e.prototype.interpolate=function(t){return this.f1},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.f0.equals(t.f0)&&this.f1.equals(t.f1))},e}(_t);_t.Affine=Vt;var Pt=function(t){function e(e,i){var r=t.call(this)||this;void 0!==e&&(e=K.fromAny(e)),void 0!==i&&(i=K.fromAny(i)),e||i?i?e||(e=i):i=e:i=e=new K([]),r.interpolators=[];for(var n=Math.min(e.transforms.length,i.transforms.length),o=0;o<n;o+=1)r.interpolators.push(nt.transform(e.transforms[o],i.transforms[o]));return r}return h(e,t),e.prototype.interpolate=function(t){for(var e=[],i=0;i<this.interpolators.length;i+=1)e.push(this.interpolators[i].interpolate(t));return new K(e)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){var i=this.interpolators.length;if(i===t.interpolators.length){for(var r=0;r<i;r+=1)if(!this.interpolators[r].equals(t.interpolators[r]))return!1;return!0}}return!1},e}(_t),Mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.range=function(t,e){return void 0===t?[this.interpolate(0),this.interpolate(1)]:void 0===e?(t=t,nt.structure(t[0],t[1])):nt.structure(t,e)},e.structure=function(t,r){if(void 0===t&&void 0===r)return new e.Absent;if(void 0!==t&&(t=i.Item.fromAny(t)),void 0!==r&&(r=i.Item.fromAny(r)),t||r?r?t||(t=r):r=t:r=t=i.Item.absent(),t instanceof i.Field&&r instanceof i.Field)return t instanceof i.Attr&&r instanceof i.Attr||t instanceof i.Attr&&r.key instanceof Text||r instanceof i.Attr&&t.key instanceof Text?new e.Attr(t,r):new e.Slot(t,r);var n=t.toValue(),o=r.toValue();return n instanceof i.Record&&o instanceof i.Record?new e.Record(n,o):n instanceof i.Num&&o instanceof i.Num?new e.Num(n,o):n instanceof i.BinaryOperator&&o instanceof i.BinaryOperator?new e.BinaryOperator(n,o):n instanceof i.UnaryOperator&&o instanceof i.UnaryOperator?new e.UnaryOperator(n,o):n instanceof i.InvokeOperator&&o instanceof i.InvokeOperator?new e.InvokeOperator(n,o):new e.Value(n,o)},e}(nt);nt.Structure=Mt,nt.structure=Mt.structure;var Rt=function(t){function e(e,r){var n=t.call(this)||this;if(!e&&!r)throw new TypeError;if(r?e||(e=r):r=e,!(e.key instanceof i.Text))throw new TypeError(""+e.key);if(!(r.key instanceof i.Text))throw new TypeError(""+r.key);return e.commit(),r.commit(),n.keyInterpolator=nt.structure(e.key,r.key),n.valueInterpolator=nt.structure(e.value,r.value),n}return h(e,t),e.prototype.interpolate=function(t){var e=this.keyInterpolator.interpolate(t),r=this.valueInterpolator.interpolate(t);return i.Attr.of(e,r)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.keyInterpolator.equals(t.keyInterpolator)&&this.valueInterpolator.equals(t.valueInterpolator))},e}(Mt);Mt.Attr=Rt;var Ot=function(t){function e(e,i){var r=t.call(this)||this;if(!e&&!i)throw new TypeError;return i?e||(e=i):i=e,e.commit(),i.commit(),r.keyInterpolator=nt.structure(e.key,i.key),r.valueInterpolator=nt.structure(e.value,i.value),r}return h(e,t),e.prototype.interpolate=function(t){var e=this.keyInterpolator.interpolate(t),r=this.valueInterpolator.interpolate(t);return i.Slot.of(e,r)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.keyInterpolator.equals(t.keyInterpolator)&&this.valueInterpolator.equals(t.valueInterpolator))},e}(Mt);Mt.Slot=Ot;var Dt=function(t){function e(e,r){var n=t.call(this)||this;return void 0!==e&&(e=i.Value.fromAny(e)),void 0!==r&&(r=i.Value.fromAny(r)),e||r?r?e||(e=r):r=e:r=e=i.Value.absent(),n.v0=e.commit(),n.v1=r.commit(),n}return h(e,t),e.prototype.interpolate=function(t){return t<1?this.v0:this.v1},e.prototype.deinterpolate=function(t){return(t=i.Item.fromAny(t)).equals(this.v1)?1:0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.v0.equals(t.v0)&&this.v1.equals(t.v1))},e}(Mt);Mt.Value=Dt;var Et=function(t){function e(e,r){var n=t.call(this)||this;void 0!==e&&(e=i.Record.fromAny(e)),void 0!==r&&(r=i.Record.fromAny(r)),e||r?r?e||(e=r):r=e:r=e=i.Record.empty(),e.commit(),r.commit(),n.interpolators=[];for(var o=Math.min(e.length,r.length),s=0;s<o;s+=1)n.interpolators.push(nt.structure(e.getItem(s),r.getItem(s)));return n}return h(e,t),e.prototype.interpolate=function(t){for(var e=this.interpolators.length,r=i.Record.create(e),n=0;n<e;n+=1)r.push(this.interpolators[n].interpolate(t));return r},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){var i=this.interpolators.length;if(i===t.interpolators.length){for(var r=0;r<i;r+=1)if(!this.interpolators[r].equals(t.interpolators[r]))return!1;return!0}}return!1},e}(Mt);Mt.Record=Et;var Tt=function(t){function e(e,i){var r=t.call(this)||this;return void 0===e&&void 0===i?i=e=0:void 0===i?i=e:void 0===e&&(e=i),r.y0=+e,r.dy=+i-r.y0,r}return h(e,t),e.prototype.interpolate=function(t){return i.Num.from(this.y0+this.dy*t)},e.prototype.deinterpolate=function(t){return(t=i.Item.fromAny(t))instanceof i.Num?this.dy?(t.value-this.y0)/this.dy:this.dy:0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.y0===t.y0&&this.dy===t.dy)},e}(Mt);Mt.Num=Tt;var kt=function(t){function e(e,i){var r=t.call(this)||this;if(!e&&!i)throw new TypeError;return i?e||(e=i):i=e,e.commit(),i.commit(),r.ifTermInterpolator=nt.structure(e.ifTerm(),i.ifTerm()),r.thenTermInterpolator=nt.structure(e.thenTerm(),i.thenTerm()),r.elseTermInterpolator=nt.structure(e.elseTerm(),i.elseTerm()),r}return h(e,t),e.prototype.interpolate=function(t){var e=this.ifTermInterpolator.interpolate(t),i=this.thenTermInterpolator.interpolate(t),r=this.elseTermInterpolator.interpolate(t);return e.conditional(i,r)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.ifTermInterpolator.equals(t.ifTermInterpolator)&&this.thenTermInterpolator.equals(t.thenTermInterpolator)&&this.elseTermInterpolator.equals(t.elseTermInterpolator))},e}(Mt);Mt.ConditionalOperator=kt;var It=function(t){function e(e,i){var r=t.call(this)||this;if(!e&&!i)throw new TypeError;if(i?e||(e=i):i=e,r.operator=e.operator(),r.operator!==i.operator())throw new Error(i.operator());return e.commit(),i.commit(),r.operand1Interpolator=nt.structure(e.operand1(),i.operand1()),r.operand2Interpolator=nt.structure(e.operand2(),i.operand2()),r}return h(e,t),e.prototype.interpolate=function(t){var e=this.operand1Interpolator.interpolate(t),i=this.operand2Interpolator.interpolate(t);switch(this.operator){case"||":return e.or(i);case"&&":return e.and(i);case"|":return e.bitwiseOr(i);case"^":return e.bitwiseXor(i);case"&":return e.bitwiseAnd(i);case"<":return e.lt(i);case"<=":return e.le(i);case"==":return e.eq(i);case"!=":return e.ne(i);case">=":return e.ge(i);case">":return e.gt(i);case"+":return e.plus(i);case"-":return e.minus(i);case"*":return e.times(i);case"/":return e.divide(i);case"%":return e.modulo(i);default:throw new Error(this.operator)}},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1Interpolator.equals(t.operand1Interpolator)&&this.operator===t.operator&&this.operand2Interpolator.equals(t.operand2Interpolator))},e}(Mt);Mt.BinaryOperator=It;var Ut=function(t){function e(e,i){var r=t.call(this)||this;if(!e&&!i)throw new TypeError;if(i?e||(e=i):i=e,r.operator=e.operator(),r.operator!==i.operator())throw new Error(i.operator());return e.commit(),i.commit(),r.operandInterpolator=nt.structure(e.operand(),i.operand()),r}return h(e,t),e.prototype.interpolate=function(t){var e=this.operandInterpolator.interpolate(t);switch(this.operator){case"!":return e.not();case"~":return e.bitwiseNot();case"-":return e.negative();default:throw new Error(this.operator)}},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operator===t.operator&&this.operandInterpolator.equals(t.operandInterpolator))},e}(Mt);Mt.UnaryOperator=Ut;var zt=function(t){function e(e,i){var r=t.call(this)||this;if(!e&&!i)throw new TypeError;return i?e||(e=i):i=e,e.commit(),i.commit(),r.funcInterpolator=nt.structure(e.func(),i.func()),r.argsInterpolator=nt.structure(e.args(),i.args()),r}return h(e,t),e.prototype.interpolate=function(t){var e=this.funcInterpolator.interpolate(t),r=this.argsInterpolator.interpolate(t);return i.Selector.literal(e).invoke(r)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.funcInterpolator.equals(t.funcInterpolator)&&this.argsInterpolator.equals(t.argsInterpolator))},e}(Mt);Mt.InvokeOperator=zt;var Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.interpolate=function(t){return i.Item.absent()},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e},e}(Mt);Mt.Absent=Ft;var jt=function(t){function e(e,i){var r=t.call(this)||this;e||i?i?e||(e=i):i=e:i=e=[],r.interpolators=[];for(var n=Math.min(e.length,i.length),o=0;o<n;o+=1)r.interpolators.push(nt.from(e[o],i[o]));return r}return h(e,t),e.prototype.interpolate=function(t){for(var e=this.interpolators.length,i=new Array(e),r=0;r<this.interpolators.length;r+=1)i[r]=this.interpolators[r].interpolate(t);return i},e.prototype.deinterpolate=function(t){return 0},e.prototype.range=function(t,i){return void 0===t?[this.interpolate(0),this.interpolate(1)]:void 0===i?new e((t=t)[0],t[1]):new e(t,i)},e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){var i=this.interpolators.length;if(i===t.interpolators.length){for(var r=0;r<i;r+=1)if(!this.interpolators[r].equals(t.interpolators[r]))return!1;return!0}}return!1},e}(nt);nt.Array=jt;var Nt=function(t){function e(e,i){var r=t.call(this)||this;if(!e&&!i)throw new Error;return i?e||(e=i):i=e,r.i0=e,r.i1=i,r.i00=r.i1.range(r.i0.interpolate(0),r.i1.interpolate(0)),r.i11=r.i1.range(r.i0.interpolate(1),r.i1.interpolate(1)),r}return h(e,t),e.prototype.interpolate=function(t){return 0===t?this.i0:1===t?this.i1:this.i1.range(this.i00.interpolate(t),this.i11.interpolate(t))},e.prototype.deinterpolate=function(t){return 0},e.prototype.range=function(t,i){return void 0===t?[this.i0,this.i1]:void 0===i?(t=t,new e(nt.fromAny(t[0]),nt.fromAny(t[1]))):(t=t,new e(nt.fromAny(t),nt.fromAny(i)))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.i0.equals(t.i0)&&this.i1.equals(t.i1))},e}(nt);nt.Interpolator=Nt;var qt=function(t){function e(e,i){var r=t.call(this)||this;return r._valueForm=e,r._unit=i,r}return h(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(this._valueForm,t)},e.prototype.mold=function(t){if(void 0!==t){t=nt.fromAny(t);var e=this._valueForm.mold(t.interpolate(0)),r=this._valueForm.mold(t.interpolate(1));if(e.isDefined()&&r.isDefined())return i.Record.of(i.Attr.of("interpolate",i.Record.of(e,r)))}return i.Item.extant()},e.prototype.cast=function(t){var e=t.toValue().header("interpolate");if(e.length>=2){var i=this._valueForm.cast(e.getItem(0).toValue()),r=this._valueForm.cast(e.getItem(1).toValue());if(void 0!==i&&void 0!==r)return nt.from(i,r)}},e}(i.Form);nt.Form=qt;var Bt=function(){function t(){}return t.linear=function(e,i,r,n){return Array.isArray(e)?Array.isArray(i)?(i=i,new t.Linear(e[0],e[1],nt.from(i[0],i[1]))):(i=i,new t.Linear(e[0],e[1],nt.fromAny(i))):(e=e,i=i,void 0===n?(r=r,new t.Linear(e,i,nt.fromAny(r))):(r=r,n=n,new t.Linear(e,i,nt.from(r,n))))},t.time=function(e,i,r,n){return Array.isArray(e)?Array.isArray(i)?(i=i,new t.Time(e[0],e[1],nt.from(i[0],i[1]))):new t.Time(e[0],e[1],nt.fromAny(i)):(e=e,i=i,void 0===n?(r=r,new t.Time(e,i,nt.fromAny(r))):(r=r,n=n,new t.Time(e,i,nt.from(r,n))))},t.from=function(e,i,r,n){if("time"===e){n=r,r=i;var s=o.DateTime.current();i=s,e=s.time(s.time()-864e5)}else"linear"===e&&(n=r,r=i,i=1,e=0);if(e instanceof o.DateTime||e instanceof Date||i instanceof o.DateTime||i instanceof Date)return void 0===n?(r=r,new t.Time(e,i,nt.fromAny(r))):new t.Time(e,i,nt.from(r,n));if("number"==typeof e&&"number"==typeof i)return void 0===n?(r=r,new t.Linear(e,i,nt.fromAny(r))):new t.Linear(e,i,nt.from(r,n));throw new TypeError(""+arguments)},t.form=function(e,i,r){return void 0===e&&(e=t.domainForm()),void 0===i&&(i=t.interpolatorForm()),e!==t.domainForm()||i!==t.interpolatorForm()||void 0!==r?new t.Form(e,i,r):(t._form||(t._form=new t.Form(e,i)),t._form)},t.domainForm=function(){throw new Error},t.interpolatorForm=function(){throw new Error},t}(),Wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e}(Bt);Bt.Continuous=Wt;var Lt=function(t){function e(e,i,r){var n=t.call(this)||this;return n.x0=e,n.dx=i-n.x0,n.fx=r,n}return h(e,t),e.prototype.norm=function(t){return this.dx?(t-this.x0)/this.dx:this.dx},e.prototype.scale=function(t){var e=this.norm(t);return this.fx.interpolate(e)},e.prototype.unscale=function(t){var e=this.fx.deinterpolate(t);return this.x0+this.dx*e},e.prototype.clampScale=function(t){var e=Math.min(Math.max(0,this.norm(t)),1);return this.fx.interpolate(e)},e.prototype.domain=function(t,i){if(void 0===t)return[this.x0,this.x0+this.dx];void 0===i&&(i=t[1],t=t[0]);var r=i-t;return t===this.x0&&r===this.dx?this:new e(t,i,this.fx)},e.prototype.range=function(t,i){return void 0===t?this.fx.range():void 0===i?(t=t,new e(this.x0,this.x0+this.dx,this.fx.range(t))):(t=t,new e(this.x0,this.x0+this.dx,this.fx.range(t,i)))},e.prototype.interpolator=function(t){return void 0===t?this.fx:(t=nt.fromAny(t),new e(this.x0,this.x0+this.dx,t))},e.prototype.clampDomain=function(t,i,r,n,o){var s=this.x0,a=this.x0+this.dx;void 0!==t&&(s<a&&s<t?s=t:a<s&&a<t&&(a=t)),void 0!==i&&(s<a&&a>i?a=i:a<s&&s>i&&(a=i));var u=+this.scale(s),h=+this.scale(a)-u,l=Math.abs(h/(a-s));if(void 0!==r&&l<1/r){var p=h*r;s=((c=s+a)-p)/2,a=(c+p)/2}else if(void 0!==n&&l>1/n){var c,d=h*n;s=((c=s+a)-d)/2,a=(c+d)/2}var f=a-s;return void 0===o&&(o=1e-12),Math.abs(s-this.x0)<o&&Math.abs(f-this.dx)<o?this:new e(s,a,this.fx)},e.prototype.solveDomain=function(t,i,r,n,o){var s,a=this.fx.range(),u=+a[0],h=+a[1],l=+i-(s=void 0===r||void 0===n||t===r||i===n?(h-u)/(this.dx||1):(+n-+i)/(r-t))*t,p=(u-l)/s,c=(h-l)/s,d=c-p;return void 0===o&&(o=1e-12),Math.abs(p-this.x0)<o&&Math.abs(d-this.dx)<o?this:new e(p,c,this.fx)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.dx===t.dx&&this.fx.equals(t.fx))},e}(Wt);Bt.Linear=Lt;var Ht=function(t){function e(e,i,r,n){var s=t.call(this)||this;return e=o.DateTime.fromAny(e),i=o.DateTime.fromAny(i),s.t0=e.time(),s.dt=i.time()-s.t0,s.zone=n||e.zone(),s.ft=r,s}return h(e,t),e.prototype.norm=function(t){return t=o.DateTime.time(t),this.dt?(t-this.t0)/this.dt:this.dt},e.prototype.scale=function(t){var e=this.norm(t);return this.ft.interpolate(e)},e.prototype.unscale=function(t){var e=this.ft.deinterpolate(t);return new o.DateTime(this.t0+this.dt*e)},e.prototype.clampScale=function(t){var e=Math.min(Math.max(0,this.norm(t)),1);return this.ft.interpolate(e)},e.prototype.domain=function(t,i){if(void 0===t)return[new o.DateTime(this.t0,this.zone),new o.DateTime(this.t0+this.dt,this.zone)];void 0===i&&(i=t[1],t=t[0]),t=o.DateTime.time(t);var r=(i=o.DateTime.time(i))-t;return t===this.t0&&r===this.dt?this:new e(t,i,this.ft,this.zone)},e.prototype.range=function(t,i){return void 0===t?this.ft.range():void 0===i?(t=t,new e(this.t0,this.t0+this.dt,this.ft.range(t),this.zone)):(t=t,new e(this.t0,this.t0+this.dt,this.ft.range(t,i),this.zone))},e.prototype.interpolator=function(t){return void 0===t?this.ft:(t=nt.fromAny(t),new e(this.t0,this.t0+this.dt,t,this.zone))},e.prototype.clampDomain=function(t,i,r,n,s){var a=this.t0,u=this.t0+this.dt;void 0!==t&&(t=o.DateTime.time(t),a<u&&a<t?a=t:u<a&&u<t&&(u=t)),void 0!==i&&(i=o.DateTime.time(i),a<u&&u>i?u=i:u<a&&a>i&&(u=i));var h=+this.scale(a),l=+this.scale(u)-h,p=Math.abs(l/(u-a));if(void 0!==r&&p<1/r){var c=l*r;a=((d=a+u)-c)/2,u=(d+c)/2}else if(void 0!==n&&p>1/n){var d,f=l*n;a=((d=a+u)-f)/2,u=(d+f)/2}var v=u-a;return void 0===s&&(s=1e-12),Math.abs(a-this.t0)<s&&Math.abs(v-this.dt)<s?this:new e(a,u,this.ft,this.zone)},e.prototype.solveDomain=function(t,i,r,n,s){t=o.DateTime.time(t),r=void 0!==r?o.DateTime.time(r):r;var a,u=this.ft.range(),h=+u[0],l=+u[1],p=+i-(a=void 0===r||void 0===n||t===r||i===n?(l-h)/(this.dt||1):(+n-+i)/(r-t))*t,c=(h-p)/a,d=(l-p)/a,f=d-c;return void 0===s&&(s=1e-12),Math.abs(c-this.t0)<s&&Math.abs(f-this.dt)<s?this:new e(c,d,this.ft,this.zone)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.t0===t.t0&&this.dt===t.dt&&this.ft.equals(t.ft))},e}(Wt);Bt.Time=Ht;var Xt=function(t){function e(e,i,r){var n=t.call(this)||this;return n._domainForm=e,n._interpolatorForm=i,n._unit=r,n}return h(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(this._domainForm,this._interpolatorForm,t)},e.prototype.mold=function(t){if(t instanceof Wt){var e=t.domain(),r=this._domainForm.mold(e[0]),n=this._domainForm.mold(e[1]),o=i.Record.of(r,n),s=i.Record.of(i.Attr.of("scale",o)),a=this._interpolatorForm.mold(t.interpolator());return a.isDefined()&&(s=s.concat(a)),s}return i.Item.extant()},e.prototype.cast=function(t){var e=t.toValue(),r=e.header("scale");if(r.length>=2){var n,o;r.forEach(function(t,e){t instanceof i.Value&&(0===e?n=t.cast(this._domainForm,n):1===e&&(o=t.cast(this._domainForm,o)))},this);var s=this._interpolatorForm.cast(e.body());if(void 0!==n&&void 0!==o&&s)return Bt.from(n,o,s)}},e}(i.Form);Bt.Form=Xt;var Yt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.range=function(t,e){return void 0===t?[this.interpolate(0),this.interpolate(1)]:void 0===e?(t=t,nt.scale(t[0],t[1])):(t=t,nt.scale(t,e))},e.scale=function(t,i){if(!t&&!i)throw new Error;if(i?t||(t=i):i=t,t instanceof Lt&&i instanceof Lt)return new e.Linear(t,i);if(t instanceof Ht&&i instanceof Ht)return new e.Time(t,i);throw new TypeError(t+", "+i)},e}(nt);nt.scale=Yt.scale;var Gt=nt.from;nt.from=function(t,e){return t instanceof Wt||e instanceof Wt?nt.scale(t,e):Gt(t,e)};var Kt=function(t){function e(e,i){var r=t.call(this)||this;if(!e&&!i)throw new Error;return i?e||(e=i):i=e,r.x0=new st(e.x0,i.x0),r.dx=new st(e.dx,i.dx),r.fx=new Nt(e.fx,i.fx),r}return h(e,t),e.prototype.interpolate=function(t){var e=this.x0.interpolate(t),i=this.dx.interpolate(t),r=this.fx.interpolate(t);return new Lt(e,e+i,r)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0.equals(t.x0)&&this.dx.equals(t.dx)&&this.fx.equals(t.fx))},e}(Yt);Yt.Linear=Kt;var Qt=function(t){function e(e,i){var r=t.call(this)||this;if(!e&&!i)throw new Error;return i?e||(e=i):i=e,r.t0=new st(e.t0,i.t0),r.dt=new st(e.dt,i.dt),r.ft=new Nt(e.ft,i.ft),r}return h(e,t),e.prototype.interpolate=function(t){var e=this.t0.interpolate(t),i=this.dt.interpolate(t),r=this.ft.interpolate(t);return new Ht(e,e+i,r)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.t0.equals(t.t0)&&this.dt.equals(t.dt)&&this.ft.equals(t.ft))},e}(Yt);function Zt(t){return t}function Jt(t){return t*t}function $t(t){return t*(2-t)}function te(t){return(t*=2)<=1?t*=t:(t-=1,t*=2-t,t+=1),t/=2}function ee(t){return t*t*t}function ie(t){return t-=1,t*=t*t,t+=1}function re(t){return(t*=2)<=1?t*=t*t:(t-=2,t*=t*t,t+=2),t/=2}function ne(t){return t*t*t*t}function oe(t){return 1-(t-=1)*t*t*t}function se(t){var e=t-1;return t<.5?8*t*t*t*t:1-8*e*e*e*e}function ae(t){return 0===t?0:Math.pow(2,10*(t-1))}function ue(t){return 1===t?1:1-Math.pow(2,-10*t)}function he(t){return 1===t||0===t?t:(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))}function le(t){return-1*(Math.sqrt(1-t/1*t)-1)}function pe(t){return t-=1,Math.sqrt(1-t*t)}function ce(t){if((t*=2)<1)return-.5*(Math.sqrt(1-t*t)-1);var e=t-2;return.5*(Math.sqrt(1-e*e)+1)}function de(t){var e=1.70158;return t*t*((e+1)*t-e)}function fe(t){var e=1.70158,i=t/1-1;return i*i*((e+1)*e+e)+1}function ve(t){var e=2.5949095;if((t*=2)<1)return.5*t*t*((e+1)*t-e);var i=t-2;return.5*(i*i*((e+1)*i+e)+2)}function ye(t){if(0===t||1===t)return t;var e=t/1-1,i=(1-.7)/2*Math.PI*Math.asin(1);return-Math.pow(2,10*e)*Math.sin(2*(e-i)*Math.PI/(1-.7))}function me(t){if(0===t||1===t)return t;var e=(1-.7)/(2*Math.PI)*Math.asin(1);return t*=2,Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/(1-.7))+1}function we(t){if(0===t||1===t)return t;var e=.35/(2*Math.PI)*Math.asin(1),i=2*t,r=i-1;return i<1?Math.pow(2,10*r)*Math.sin(2*(r-e)*Math.PI/.35)*-.5:Math.pow(2,-10*r)*Math.sin(2*(r-e)*Math.PI/.35)*.5+1}function ge(t){var e=7.5625;return(t=1-t)<1/2.75?1-e*t*t:t<2/2.75?1-(e*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(e*(t-=2.25/2.75)*t+.9375):1-(e*(t-=2.625/2.75)*t+.984375)}function _e(t){var e=7.5625;return t<1/2.75?e*t*t:t<2/2.75?e*(t-=1.5/2.75)*t+.75:t<2.5/2.75?e*(t-=2.25/2.75)*t+.9375:e*(t-=2.625/2.75)*t+.984375}function be(t){var e=t<.5,i=7.5625;return(t=e?1-2*t:2*t-1)<1/2.75?t*=i*t:t=t<2/2.75?i*(t-=1.5/2.75)*t+.75:t<2.5/2.75?i*(t-=2.25/2.75)*t+.9375:i*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5}Yt.Time=Qt,Zt.type="linear",Jt.type="quad-in",$t.type="quad-out",te.type="quad-in-out",ee.type="cubic-in",ie.type="cubic-out",re.type="cubic-in-out",ne.type="quart-in",oe.type="quart-out",se.type="quart-in-out",ae.type="expo-in",ue.type="expo-out",he.type="expo-in-out",le.type="circ-in",pe.type="circ-out",ce.type="circ-in-out",de.type="back-in",fe.type="back-out",ve.type="back-in-out",ye.type="elastic-in",me.type="elastic-out",we.type="elastic-in-out",ge.type="bounce-in",_e.type="bounce-out",be.type="bounce-in-out";var xe={linear:Zt,quadIn:Jt,quadOut:$t,quadInOut:te,cubicIn:ee,cubicOut:ie,cubicInOut:re,quartIn:ne,quartOut:oe,quartInOut:se,expoIn:ae,expoOut:ue,expoInOut:he,circIn:le,circOut:pe,circInOut:ce,backIn:de,backOut:fe,backInOut:ve,elasticIn:ye,elasticOut:me,elasticInOut:we,bounceIn:ge,bounceOut:_e,bounceInOut:be,fromAny:function(t){if("function"==typeof t)return t;if("string"==typeof t)switch(t){case"linear":return xe.linear;case"quad-in":return xe.quadIn;case"quad-out":return xe.quadOut;case"quad-in-out":return xe.quadInOut;case"cubic-in":return xe.cubicIn;case"cubic-out":return xe.cubicOut;case"cubic-in-out":return xe.cubicInOut;case"quart-in":return xe.quartIn;case"quart-out":return xe.quartOut;case"quart-in-out":return xe.quartInOut;case"expo-in":return xe.expoIn;case"expo-out":return xe.expoOut;case"expo-in-out":return xe.expoInOut;case"circ-in":return xe.circIn;case"circ-out":return xe.circOut;case"circ-in-out":return xe.circInOut;case"back-in":return xe.backIn;case"back-out":return xe.backOut;case"back-in-out":return xe.backInOut;case"elastic-in":return xe.elasticIn;case"elastic-out":return xe.elasticOut;case"elastic-in-out":return xe.elasticInOut;case"bounce-in":return xe.bounceIn;case"bounce-out":return xe.bounceOut;case"bounce-in-out":return xe.bounceInOut}throw new Error(t)},_form:void 0,form:function(t){return void 0!==t&&(t=xe.fromAny(t)),t!==xe.linear?new xe.Form(t):(xe._form||(xe._form=new xe.Form(xe.linear)),xe._form)},Form:void 0},Se=function(t){function e(e){var i=t.call(this)||this;return i._unit=e,i}return h(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t){return"string"==typeof(t=xe.fromAny(t)).type?i.Text.from(t.type):i.Item.extant()},e.prototype.cast=function(t){var e=t.toValue().stringValue(void 0);if(void 0!==e)try{return xe.fromAny(e)}catch(t){}},e}(i.Form);xe.Form=Se;var Ae=function(){function t(t,e,i,r,n,o){this._duration=t,this._ease=e,this._interpolator=i,this._onStart=r,this._onEnd=n,this._onInterrupt=o}return t.prototype.duration=function(e){return void 0===e?this._duration:new t(e,this._ease,this._interpolator,this._onStart,this._onEnd,this._onInterrupt)},t.prototype.ease=function(e){return void 0===e?this._ease:(e=null!==e?xe.fromAny(e):null,new t(this._duration,e,this._interpolator,this._onStart,this._onEnd,this._onInterrupt))},t.prototype.interpolator=function(e){return void 0===e?this._interpolator:(e=null!==e?nt.fromAny(e):null,new t(this._duration,this._ease,e,this._onStart,this._onEnd,this._onInterrupt))},t.prototype.range=function(e,i){if(void 0===e)return this._interpolator?this._interpolator.range():null;var r=void 0;return r=this._interpolator?this._interpolator.range(e,i):nt.from(e,i),new t(this._duration,this._ease,r,this._onStart,this._onEnd,this._onInterrupt)},t.prototype.onStart=function(e){return void 0===e?this._onStart:new t(this._duration,this._ease,this._interpolator,e,this._onEnd,this._onInterrupt)},t.prototype.onEnd=function(e){return void 0===e?this._onEnd:new t(this._duration,this._ease,this._interpolator,this._onStart,e,this._onInterrupt)},t.prototype.onInterrupt=function(e){return void 0===e?this._onInterrupt:new t(this._duration,this._ease,this._interpolator,this._onStart,this._onEnd,e)},t.prototype.toAny=function(){var t={};return null!==this._duration&&(t.duration=this._duration),null!==this._ease&&(t.ease=this._ease),null!==this._interpolator&&(t.interpolator=this._interpolator),null!==this._onStart&&(t.onStart=this._onStart),null!==this._onEnd&&(t.onEnd=this._onEnd),null!==this._onInterrupt&&(t.onInterrupt=this._onInterrupt),t},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._duration===e._duration&&this._ease===e._ease&&r.Objects.equal(this._interpolator,e._interpolator))},t.duration=function(e,i,r){return void 0===i&&(i=null),void 0===r&&(r=null),new t(e,i=null!==i?xe.fromAny(i):null,r=null!==r?nt.fromAny(r):null,null,null,null)},t.ease=function(e,i){return void 0===i&&(i=null),new t(null,e=xe.fromAny(e),i=null!==i?nt.fromAny(i):null,null,null,null)},t.interpolator=function(e){return new t(null,null,e=nt.fromAny(e),null,null,null)},t.range=function(e,i){var r;return void 0===i&&Array.isArray(e)?(e=e,r=nt.from(e[0],e[1])):r=nt.from(e,i),new t(null,null,r,null,null,null)},t.from=function(e,i,r,n,o,s){return void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===n&&(n=null),void 0===o&&(o=null),void 0===s&&(s=null),new t(e,i=null!==i?xe.fromAny(i):null,r=null!==r?nt.fromAny(r):null,n,o,s)},t.fromAny=function(e,i,r,n){return void 0===r&&(r=null),void 0===n&&(n=null),e instanceof t?e:"object"==typeof e&&e?t.from(e.duration,e.ease,e.interpolator,e.onStart,e.onEnd,e.onInterrupt):!0===e?t.from(r,n,nt.from(i)):void 0},t.isInit=function(t){if(t&&"object"==typeof t){var e=t;return void 0!==e.duration||void 0!==e.ease||void 0!==e.interpolator}return!1},t.form=function(e,i){return void 0===e&&(e=t.interpolatorForm()),e!==t.interpolatorForm()||void 0!==i?(i=void 0!==i?t.fromAny(i):i,new t.Form(e,i)):(t._form||(t._form=new t.Form(e)),t._form)},t.interpolatorForm=function(){throw new Error},t}(),Ce=function(t){function e(e,i){var r=t.call(this)||this;return r._interpolatorForm=e,r._unit=i,r}return h(e,t),e.prototype.unit=function(t){return void 0===t?this._unit:(t=Ae.fromAny(t),new e(this._interpolatorForm,t))},e.prototype.mold=function(t){if(void 0!==t){t=Ae.fromAny(t);var e=i.Record.create();null!==t._duration&&e.slot("duration",t._duration),null!==t._ease&&e.slot("ease",xe.form().mold(t._ease));var r=i.Record.of(i.Attr.of("transition",e));if(null!==t._interpolator){var n=this._interpolatorForm.mold(t._interpolator);n.isDefined()&&(r=r.concat(n))}return r}return i.Item.extant()},e.prototype.cast=function(t){var e=t.toValue(),r=e.header("transition");if(r.length>=2){var n=null,o=null;r.forEach(function(t,e){var r=t.key.stringValue(void 0);void 0!==r?"duration"===r?n=t.toValue().numberValue(n):"ease"===r&&(o=t.toValue().cast(xe.form(),o)):t instanceof i.Value&&(0===e?n=t.numberValue(n):1===e&&(o=t.cast(xe.form(),o)))},this);var s=this._interpolatorForm.cast(e.body());return Ae.from(n,o,s)}},e}(i.Form);Ae.Form=Ce;var Ve,Pe=function(){return function(){}}(),Me=function(t){function e(){var e=t.call(this)||this;return e._animationFrame=0,e._disabled=!1,e._dirty=!1,e}return h(e,t),Object.defineProperty(e.prototype,"enabled",{get:function(){return!this._disabled},enumerable:!0,configurable:!0}),e.prototype.setEnabled=function(t){t&&this._disabled?(this._disabled=!1,this.didSetEnabled(!1)):t||this._disabled||(this._disabled=!0,this.didSetEnabled(!0))},e.prototype.didSetEnabled=function(t){t?this.animate():this.cancel()},Object.defineProperty(e.prototype,"dirty",{get:function(){return this._dirty},enumerable:!0,configurable:!0}),e.prototype.setDirty=function(t){t&&!this._dirty?(this._dirty=!0,this.didSetDirty(!0)):!t&&this._dirty&&(this._dirty=!1,this.didSetDirty(!1))},e.prototype.didSetDirty=function(t){},e.prototype.animate=function(){this._animationFrame||this._disabled||(this.hasOwnProperty("onAnimationFrame")||(this.onAnimationFrame=this.onAnimationFrame.bind(this)),this._animationFrame=requestAnimationFrame(this.onAnimationFrame))},e.prototype.cancel=function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=0)},e.prototype.onAnimationFrame=function(t){this._animationFrame=0,this.onFrame(t)},e}(Pe),Re=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),Object.defineProperty(e.prototype,"dirty",{get:function(){var t=this.parent;return!!t&&t.dirty},enumerable:!0,configurable:!0}),e.prototype.setDirty=function(t){if(t){var e=this.parent;e&&e.setDirty(t)}},e.prototype.animate=function(){var t=this.parent;t&&t.animate()},e}(Pe);(Ve=t.TweenState||(t.TweenState={}))[Ve.Quiesced=0]="Quiesced",Ve[Ve.Diverged=1]="Diverged",Ve[Ve.Tracking=2]="Tracking",Ve[Ve.Converged=3]="Converged",Ve[Ve.Interrupt=4]="Interrupt";var Oe=function(t){function e(e,i){var r=t.call(this)||this;return i?(r._duration=null!==i._duration?i._duration:0,r._ease=null!==i._ease?i._ease:xe.linear,r._interpolator=i._interpolator,r._onStart=i._onStart,r._onEnd=i._onEnd,r._onInterrupt=i._onInterrupt):(r._duration=0,r._ease=xe.linear,r._interpolator=null,r._onStart=null,r._onEnd=null,r._onInterrupt=null),r._interrupt=null,r._value=e,r._state=e,r._startTime=0,r._tweenState=0,r._disabled=!1,r._dirty=!1,r._input=null,r._outputs=null,r._version=-1,r}return h(e,t),Object.defineProperty(e.prototype,"enabled",{get:function(){return!this._disabled},enumerable:!0,configurable:!0}),e.prototype.setEnabled=function(t){t&&this._disabled?(this._disabled=!1,this.didSetEnabled(!1)):t||this._disabled||(this._disabled=!0,this.didSetEnabled(!0))},e.prototype.didSetEnabled=function(t){t?this.animate():this.cancel()},Object.defineProperty(e.prototype,"dirty",{get:function(){return this._dirty},enumerable:!0,configurable:!0}),e.prototype.setDirty=function(t){t&&!this._dirty?(this._dirty=!0,this.didSetDirty(!0)):!t&&this._dirty&&(this._dirty=!1,this.didSetDirty(!1))},e.prototype.didSetDirty=function(t){},e.prototype.duration=function(t){return void 0===t?this._duration:(this._duration=Math.max(0,t),this)},e.prototype.ease=function(t){return void 0===t?this._ease:(this._ease=xe.fromAny(t),this)},e.prototype.interpolator=function(t,e){return void 0===t?this._interpolator:(1===arguments.length?this._interpolator=t:null!==this._interpolator&&null!=t?this._interpolator=this._interpolator.range(t,e):this._interpolator=nt.from(t,e),this)},e.prototype.transition=function(t){return void 0===t?new Ae(this._duration,this._ease,this._interpolator,null,null,null):(null!==(t=Ae.fromAny(t))._duration&&(this._duration=t._duration),null!==t._ease&&(this._ease=t._ease),null!==t._interpolator&&(this._interpolator=t._interpolator),null!==t._onStart&&(this._onStart=t._onStart),null!==t._onEnd&&(this._onEnd=t._onEnd),null!==t._onInterrupt&&(this._onInterrupt=t._onInterrupt),this)},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),e.prototype.setState=function(t,e){var i=this._onInterrupt;if(this._onInterrupt=null,e instanceof Ae||"object"==typeof e&&e?this.transition(e):e||(this._duration=0),this._interrupt=i,null!=t)0===this._tweenState&&r.Objects.equal(this._state,t)||(this.interpolator(this.value,t),this._state=t,this._startTime=0,2===this._tweenState?this._tweenState=4:this._tweenState=1,e?this.animate():this.onFrame(0));else{if(this._state=t,this._startTime=0,2===this._tweenState){this.onInterrupt(this._value);var n=this._interrupt;n&&(this._interrupt=null,n(this._value))}this._tweenState=1,this._value=t,void 0===this._value&&this.delete()}},e.prototype.onFrame=function(t){if(0!==this._tweenState&&!this._disabled){if(4===this._tweenState){this.onInterrupt(this._value);var e=this._interrupt;e&&(this._interrupt=null,e(this._value)),this._tweenState=1}if(1===this._tweenState)if(r.Objects.equal(this._value,this._state))this.tween(1);else{this._startTime=t,this.onStart(this._value);var i=this._onStart;i&&(this._onStart=null,i(this._value)),this._tweenState=2}if(2===this._tweenState){var n=this._duration?Math.min(Math.max(0,(t-this._startTime)/this._duration),1):1;this.tween(n)}if(3===this._tweenState){this._onInterrupt=null,this._startTime=0,this._tweenState=0,this.onEnd(this._value);var o=this._onEnd;o&&(this._onEnd=null,o(this._value))}else this.animate()}},e.prototype.interpolate=function(t){return this._interpolator.interpolate(t)},e.prototype.tween=function(t){t=this._ease(t);var e=this._value,i=1!==t?this.interpolate(t):this._state;this._value=i,this.update(i,e),1===t&&(this._tweenState=3)},e.prototype.onStart=function(t){},e.prototype.onEnd=function(t){},e.prototype.onInterrupt=function(t){},e.prototype.get=function(){var t=this.state;return null===t&&(t=void 0),t},e.prototype.input=function(){return this._input},e.prototype.bindInput=function(t){null!==this._input&&this._input.unbindOutput(this),this._input=t,null!==this._input&&this._input.bindOutput(this)},e.prototype.unbindInput=function(){null!==this._input&&this._input.unbindOutput(this),this._input=null},e.prototype.disconnectInputs=function(){if(null===this._outputs){var t=this._input;null!==t&&(t.unbindOutput(this),this._input=null,t.disconnectInputs())}},e.prototype.outputIterator=function(){return null!==this._outputs?r.Cursor.array(this._outputs):r.Cursor.empty()},e.prototype.bindOutput=function(t){for(var e=this._outputs,i=null!==e?e.length:0,r=new Array(i+1),n=0;n<i;n+=1)r[n]=e[n];r[i]=t,this._outputs=r},e.prototype.unbindOutput=function(t){for(var e=this._outputs,i=null!==e?e.length:0,r=0;r<i;r+=1)if(e[r]===t){if(i>1){for(var n=new Array(i-1),o=0;o<r;o+=1)n[o]=e[o];for(o=r;o<i-1;o+=1)n[o]=e[o+1];this._outputs=n}else this._outputs=null;break}},e.prototype.unbindOutputs=function(){var t=this._outputs;if(null!==t){this._outputs=null;for(var e=0,i=t.length;e<i;e+=1){t[e].unbindInput()}}},e.prototype.disconnectOutputs=function(){if(null===this._input){var t=this._outputs;if(null!==t){this._outputs=null;for(var e=0,i=t.length;e<i;e+=1){var r=t[e];r.unbindInput(),r.disconnectOutputs()}}}},e.prototype.invalidateOutput=function(){this.invalidate()},e.prototype.invalidateInput=function(){this.invalidate()},e.prototype.invalidate=function(){if(this._version>=0){this.willInvalidate(),this._version=-1,this.onInvalidate();for(var t=null!==this._outputs?this._outputs.length:0,e=0;e<t;e+=1)this._outputs[e].invalidateOutput();this.didInvalidate()}},e.prototype.reconcileOutput=function(t){this.reconcile(t)},e.prototype.reconcileInput=function(t){this.reconcile(t)},e.prototype.reconcile=function(t){if(this._version<0){this.willReconcile(t),this._version=t,null!==this._input&&this._input.reconcileInput(t),this.onReconcile(t);for(var e=null!==this._outputs?this._outputs.length:0,i=0;i<e;i+=1)this._outputs[i].reconcileOutput(t);this.didReconcile(t)}},e.prototype.willInvalidate=function(){},e.prototype.onInvalidate=function(){},e.prototype.didInvalidate=function(){},e.prototype.willReconcile=function(t){},e.prototype.onReconcile=function(t){if(null!==this._input){var e=this._input.get();void 0!==e&&this.setState(e,!0)}},e.prototype.didReconcile=function(t){},e.prototype.memoize=function(){return this},e.prototype.map=function(t){var e=new s.MapValueCombinator(t);return e.bindInput(this),e},e.prototype.watch=function(t){return new s.WatchValueCombinator(t).bindInput(this),this},e}(Pe),De=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r._animationFrame=0,r}return h(e,t),e.prototype.animate=function(){this._animationFrame||this._disabled||(this.hasOwnProperty("onAnimationFrame")||(this.onAnimationFrame=this.onAnimationFrame.bind(this)),this._animationFrame=requestAnimationFrame(this.onAnimationFrame))},e.prototype.cancel=function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=0)},e.prototype.onAnimationFrame=function(t){this._animationFrame=0,this.onFrame(t)},e}(Oe),Ee=function(t){function e(e,i,r){void 0===r&&(r=null);var n=t.call(this,i,r)||this;return n.parent=e,n}return h(e,t),Object.defineProperty(e.prototype,"dirty",{get:function(){var t=this.parent;return!!t&&t.dirty},enumerable:!0,configurable:!0}),e.prototype.setDirty=function(t){if(t){var e=this.parent;e&&e.setDirty(t)}},e.prototype.animate=function(){var t=this.parent;t&&!this._disabled&&t.animate()},e.prototype.cancel=function(){},e.prototype.update=function(t,e){r.Objects.equal(e,t)||this.setDirty(!0)},e.prototype.delete=function(){},e}(Oe),Te=function(t){function e(e,i,r,n){void 0===n&&(n=null);var o=t.call(this,r,n)||this;return o.target=e,o.key=i,o}return h(e,t),e.prototype.update=function(t,e){r.Objects.equal(e,t)||(this.willUpdate(t,e),this.target[this.key]=t,this.didUpdate(t,e))},e.prototype.willUpdate=function(t,e){},e.prototype.didUpdate=function(t,e){},e.prototype.delete=function(){delete this.target[this.key]},e}(De),ke=function(t,e){void 0===e&&(e={});var i=document.createEvent("CustomEvent");return i.initCustomEvent(t,e.bubbles||!1,e.cancelable||!1,e.detail),i.__proto__=this.__proto__,i};"undefined"!=typeof Event&&(ke.prototype=Event.prototype);var Ie=function(){function t(t){this.callback=t,this.observationTargets=[],this.activeTargets=[],this.skippedTargets=[],qe.addObserver(this)}return t.prototype.observe=function(t){for(var e=0;e<this.observationTargets.length;e+=1)if(t===this.observationTargets[e].target)return;var i=new Fe(t);this.observationTargets.push(i),qe.redetect()},t.prototype.unobserve=function(t){for(var e=0;e<this.observationTargets.length;e+=1)t===this.observationTargets[e].target&&this.observationTargets.splice(e,1);this.observationTargets.length||qe.removeObserver(this)},t.prototype.gatherActive=function(t){this.clearActive(),this.clearSkipped();for(var e=0;e<this.observationTargets.length;e+=1){var i=this.observationTargets[e];if(i.isActive())Be(i.target)>t?this.activeTargets.push(i):this.skippedTargets.push(i)}},t.prototype.broadcastActive=function(t){if(this.hasActive()){for(var e=[],i=0;i<this.activeTargets.length;i+=1){var r=this.observationTargets[i],n=new ze(r.target);e.push(n),r.broadcastWidth=n.contentRect.width,r.broadcastHeight=n.contentRect.height;var o=Be(r.target);o<t&&(t=o)}this.callback(e,this),this.clearActive()}return t},t.prototype.hasActive=function(){return this.activeTargets.length>0},t.prototype.hasSkipped=function(){return this.skippedTargets.length>0},t.prototype.clearActive=function(){this.activeTargets.length=0},t.prototype.clearSkipped=function(){this.skippedTargets.length=0},t.prototype.disconnect=function(){this.clearActive(),this.observationTargets.length=0,qe.removeObserver(this)},t}(),Ue="undefined"!=typeof window&&void 0!==window.ResizeObserver?window.ResizeObserver:Ie,ze=function(){return function(t,e){this.target=t,this.contentRect=e||We(t)}}(),Fe=function(){function t(t){this.target=t,this.broadcastWidth=0,this.broadcastHeight=0}return t.prototype.isActive=function(){var t=We(this.target);return!!t&&(Math.round(t.width)!==Math.round(this.broadcastWidth)||Math.round(t.height)!==Math.round(this.broadcastHeight))},t}(),je=function(){function t(){this.resizeObservers=[],this.mutationObserver=void 0,this.detectAnimationFrame=0,this.connected=!1,this.onResize=this.onResize.bind(this),this.onTransitionEnd=this.onTransitionEnd.bind(this),this.onMutation=this.onMutation.bind(this),this.onSubtreeModified=void 0,this.onDetectAnimationFrame=this.onDetectAnimationFrame.bind(this)}return t.prototype.addObserver=function(t){this.resizeObservers.indexOf(t)<0&&this.resizeObservers.push(t),this.connect()},t.prototype.removeObserver=function(t){var e=this.resizeObservers.indexOf(t);e>=0&&this.resizeObservers.splice(e,1),this.resizeObservers.length||this.disconnect()},t.prototype.gatherActive=function(t){for(var e=0;e<this.resizeObservers.length;e+=1)this.resizeObservers[e].gatherActive(t)},t.prototype.hasActive=function(){for(var t=0;t<this.resizeObservers.length;t+=1)if(this.resizeObservers[t].hasActive())return!0;return!1},t.prototype.hasSkipped=function(){for(var t=0;t<this.resizeObservers.length;t+=1)if(this.resizeObservers[t].hasSkipped())return!0;return!1},t.prototype.broadcastActive=function(){for(var t=Number.POSITIVE_INFINITY,e=0;e<this.resizeObservers.length;e+=1)t=this.resizeObservers[e].broadcastActive(t);return t},t.prototype.detect=function(){var t=0;this.gatherActive(t);do{t=this.broadcastActive(),this.gatherActive(t)}while(this.hasActive());this.hasSkipped()&&window.dispatchEvent(new ErrorEvent("ResizeObserver loop completed with undelivered notifications."))},t.prototype.redetect=function(){this.detectAnimationFrame||(this.detectAnimationFrame=requestAnimationFrame(this.onDetectAnimationFrame))},t.prototype.onDetectAnimationFrame=function(t){this.detectAnimationFrame=0,this.detect()},t.prototype.onResize=function(t){this.redetect()},t.prototype.onTransitionEnd=function(t){for(var e=!1,i=0;i<Ne.length;i+=1)if(t.propertyName.indexOf(Ne[i])>=0){e=!0;break}e&&this.redetect()},t.prototype.onMutation=function(t){for(var e=0;e<t.length;e+=1){var i=t[e];if("childList"===i.type&&i.addedNodes&&i.addedNodes.length>0)for(var r=0;r<i.addedNodes.length;r+=1)this.addShadows(i.addedNodes[r])}this.redetect()},t.prototype.addShadows=function(t){if(t instanceof Element){for(var e=0;e<t.childNodes.length;e+=1)this.addShadows(t.childNodes[e]);t.shadowRoot&&(this.observe(t.shadowRoot),this.addShadows(t.shadowRoot))}},t.prototype.observe=function(t){this.mutationObserver.observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})},t.prototype.connect=function(){if(!this.connected){window.addEventListener("resize",this.onResize),document.addEventListener("transitionend",this.onTransitionEnd);var t="undefined"!=typeof navigator&&/Trident\/.*rv:11/.test(navigator.userAgent);"undefined"==typeof MutationObserver||t?(this.onSubtreeModified=this.onResize,document.addEventListener("DOMSubtreeModified",this.onSubtreeModified)):(this.mutationObserver=new MutationObserver(this.onMutation),this.observe(document),this.addShadows(document)),this.connected=!0}},t.prototype.disconnect=function(){this.connected&&(window.removeEventListener("resize",this.onResize),document.removeEventListener("transitionend",this.onTransitionEnd),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=void 0),this.onSubtreeModified&&(document.removeEventListener("DOMSubtreeModified",this.onSubtreeModified),this.onSubtreeModified=void 0),this.detectAnimationFrame&&(cancelAnimationFrame(this.detectAnimationFrame),this.detectAnimationFrame=0),this.connected=!1)},t}(),Ne=["top","right","bottom","left","width","height","size","weight"],qe=new je;function Be(t){for(var e=0;t.parentNode;)t=t.parentNode,e+=1;return e}function We(t){return t instanceof HTMLElement?function(t){if(!t.clientWidth&&!t.clientHeight)return He(0,0,0,0);var e=getComputedStyle(t),i=Le(e.getPropertyValue("padding-left")),r=Le(e.getPropertyValue("padding-top")),n=i+Le(e.getPropertyValue("padding-right")),o=r+Le(e.getPropertyValue("padding-bottom")),s=Le(e.getPropertyValue("width")),a=Le(e.getPropertyValue("height"));"border-box"===e.getPropertyValue("box-sizing")&&(Math.round(s+n)!==t.clientWidth&&(s-=n+Le(e.getPropertyValue("border-left-width"))+Le(e.getPropertyValue("border-right-width"))),Math.round(a+o)!==t.clientHeight&&(a-=o+Le(e.getPropertyValue("border-top-width"))+Le(e.getPropertyValue("border-bottom-width"))));if(t!==document.documentElement){var u=Math.round(s+n)-t.clientWidth,h=Math.round(a+o)-t.clientHeight;1!==Math.abs(u)&&(s-=u),1!==Math.abs(h)&&(a-=h)}return He(i,r,s,a)}(t):function(t){return"undefined"!=typeof SVGGraphicsElement?t instanceof SVGGraphicsElement:t instanceof SVGElement&&"function"==typeof t.getBBox}(t)?function(t){var e=t.getBBox();return He(0,0,e.width,e.height)}(t):He(0,0,0,0)}function Le(t){return parseFloat(t)||0}function He(t,e,i,r){return{x:t,y:e,width:i,height:r,top:e,right:t+i,bottom:e+r,left:t}}var Xe=function(){function t(t,e,i,r,n,o,s){this.inset=t,this.offsetX=e,this.offsetY=i,this.blurRadius=r,this.spreadRadius=n,this.color=o,this.next=s}return t.prototype.isDefined=function(){return this.inset||this.offsetX.isDefined()||this.offsetY.isDefined()||this.blurRadius.isDefined()||this.spreadRadius.isDefined()||this.color.isDefined()||!!this.next&&this.next.isDefined()},t.prototype.and=function(e,i,r,n,o,s){var a=this.next?this.next.and.apply(this.next,arguments):t.of.apply(null,arguments);return new t(this.inset,this.offsetX,this.offsetY,this.blurRadius,this.spreadRadius,this.color,a)},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.inset===e.inset&&this.offsetX.equals(e.offsetX)&&this.offsetY.equals(e.offsetY)&&this.blurRadius.equals(e.blurRadius)&&this.spreadRadius.equals(e.spreadRadius)&&this.color.equals(e.color)&&r.Objects.equal(this.next,e.next))},t.prototype.toString=function(){if(this.isDefined()){for(var t="",e=this;;){if(e.inset&&(t+="inset",t+=" "),t+=e.offsetX.toString(),t+=" ",t+=e.offsetY.toString(),t+=" ",t+=e.blurRadius.toString(),t+=" ",t+=e.spreadRadius.toString(),t+=" ",t+=e.color.toString(),!e.next)break;t+=", ",e=e.next}return t}return"none"},t.none=function(){return t._none||(t._none=new t(!1,m.zero(),m.zero(),m.zero(),m.zero(),C.black(),null)),t._none},t.of=function(e,i,r,n,o,s){if(1===arguments.length)return t.fromAny(arguments[0]);if("boolean"!=typeof e){if(3===arguments.length)s=C.fromAny(arguments[2]),o=m.zero(),n=m.zero(),r=m.fromAny(arguments[1]),i=m.fromAny(arguments[0]);else if(4===arguments.length)s=C.fromAny(arguments[3]),o=m.zero(),n=m.fromAny(arguments[2]),r=m.fromAny(arguments[1]),i=m.fromAny(arguments[0]);else{if(5!==arguments.length)throw new TypeError(""+arguments);s=C.fromAny(arguments[4]),o=m.fromAny(arguments[3]),n=m.fromAny(arguments[2]),r=m.fromAny(arguments[1]),i=m.fromAny(arguments[0])}e=!1}else if(4===arguments.length)s=C.fromAny(arguments[3]),o=m.zero(),n=m.zero(),i=m.fromAny(arguments[1]),r=m.fromAny(arguments[2]);else if(5===arguments.length)s=C.fromAny(arguments[4]),o=m.zero(),n=m.fromAny(arguments[3]),i=m.fromAny(arguments[1]),r=m.fromAny(arguments[2]);else{if(6!==arguments.length)throw new TypeError(""+arguments);s=C.fromAny(arguments[5]),o=m.fromAny(arguments[4]),n=m.fromAny(arguments[3]),r=m.fromAny(arguments[2]),i=m.fromAny(arguments[1])}return new t(e,i,r,n,o,s,null)},t.fromAny=function(){for(var e,i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];if((e=0===arguments.length?t.none():1===arguments.length?arguments[0]:arguments)instanceof t)return e;if("string"==typeof e)return t.parse(e);if("object"==typeof e&&e&&void 0===e.length)return new t((e=e).inset||!1,void 0!==e.offsetX?m.fromAny(e.offsetX):m.zero(),void 0!==e.offsetY?m.fromAny(e.offsetY):m.zero(),void 0!==e.blurRadius?m.fromAny(e.blurRadius):m.zero(),void 0!==e.spreadRadius?m.fromAny(e.spreadRadius):m.zero(),void 0!==e.color?C.fromAny(e.color):C.black(),null);if("object"==typeof e&&e&&e.length>0){e=e;for(var n=t.fromAny(e[0]),o=1;o<e.length;o+=1)n=n.and(e[o]);return n}throw new TypeError(""+e)},t.fromValue=function(e){var r;return e.forEach(function(e,n){var o=e.header("boxShadow");if(o){var s,a,u,h,l,p;o.forEach(function(t,e){var r=t.key.stringValue();void 0!==r?"inset"===r?s=t.toValue().booleanValue(s):"offsetX"===r?a=t.toValue().cast(m.form(),a):"offsetY"===r?u=t.toValue().cast(m.form(),u):"blurRadius"===r?h=t.toValue().cast(m.form(),h):"spreadRadius"===r?l=t.toValue().cast(m.form(),l):"color"===r&&(p=t.toValue().cast(C.form(),p)):t instanceof i.Value&&(0===e&&t instanceof i.Text&&"inset"===t.value?s=!0:0===e||1===e&&void 0!==s?a=t.cast(m.form(),a):1===e||2===e&&void 0!==s?u=t.cast(m.form(),u):2===e||3===e&&void 0!==s?void 0===(h=t.cast(m.form(),h))&&(p=t.cast(C.form(),p)):(3===e||4===e&&void 0===s)&&void 0===p?void 0===(l=t.cast(m.form(),l))&&(p=t.cast(C.form(),p)):(4===e||5===e&&void 0===s)&&void 0===p&&(p=t.cast(C.form(),p)))}),s=void 0!==s&&s,a=void 0!==a?a:m.zero(),u=void 0!==u?u:m.zero(),h=void 0!==h?h:m.zero(),l=void 0!==l?l:m.zero(),p=void 0!==p?p:C.black();var c=new t(s||!1,a,u,h,l,p,null);r=r?r.and(c):c}}),r},t.parse=function(i){for(var r=e.Unicode.stringInput(i);r.isCont()&&e.Unicode.isWhitespace(r.head());)r=r.step();var n=t.Parser.parse(r);if(n.isDone())for(;r.isCont()&&e.Unicode.isWhitespace(r.head());)r=r.step();return r.isCont()&&!n.isError()&&(n=e.Parser.error(e.Diagnostic.unexpected(r))),n.bind()},t.isInit=function(t){if(t&&"object"==typeof t){var e=t;return void 0!==e.offsetX&&void 0!==e.offsetY&&void 0!==e.color}return!1},t.form=function(e){return void 0!==e&&(e=t.fromAny(e)),e!==t.none()?new t.Form(e):(t._form||(t._form=new t.Form(t.none())),t._form)},t}(),Ye=function(t){function i(e,i,r,n,o,s,a,u){var h=t.call(this)||this;return h.boxShadow=e,h.identOutput=i,h.offsetXParser=r,h.offsetYParser=n,h.blurRadiusParser=o,h.spreadRadiusParser=s,h.colorParser=a,h.step=u,h}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this.boxShadow,this.identOutput,this.offsetXParser,this.offsetYParser,this.blurRadiusParser,this.spreadRadiusParser,this.colorParser,this.step)},i.parse=function(t,r,n,o,s,a,u,h,l){void 0===l&&(l=1);for(var p=0;;){if(1===l){for(;t.isCont()&&(p=t.head(),e.Unicode.isSpace(p));)t.step();if(t.isCont())l=e.Unicode.isAlpha(p)?2:4;else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.unexpected(t))}if(2===l){for(n=n||e.Unicode.stringOutput();t.isCont()&&(p=t.head(),e.Unicode.isAlpha(p));)t=t.step(),n.write(p);if(!t.isEmpty()){var c=n.bind();switch(c){case"inset":l=3;break;case"none":return e.Parser.done(Xe.none());default:return e.Parser.error(e.Diagnostic.message("unknown box-shadow: "+c,t))}}}if(3===l)if(t.isCont()){if(!e.Unicode.isSpace(t.head()))return e.Parser.error(e.Diagnostic.expected("space",t));t.step(),l=4}else if(t.isDone())return e.Parser.error(e.Diagnostic.unexpected(t));if(4===l){if(o)o=o.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();t.isEmpty()||(o=S.parse(t))}if(o)if(o.isDone())l=5;else if(o.isError())return o.asError()}if(5===l)if(t.isCont()){if(!e.Unicode.isSpace(t.head()))return e.Parser.error(e.Diagnostic.expected("space",t));t.step(),l=6}else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.unexpected(t));if(6===l){if(s)s=s.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();t.isEmpty()||(s=S.parse(t))}if(s)if(s.isDone())l=7;else if(s.isError())return s.asError()}if(7===l)if(t.isCont()){if(!e.Unicode.isSpace(t.head()))return e.Parser.error(e.Diagnostic.expected("space",t));t.step(),l=8}else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.unexpected(t));if(8===l){if(a)a=a.feed(t);else{for(;t.isCont()&&(p=t.head(),e.Unicode.isSpace(p));)t.step();t.isCont()&&(45===p||p>=48&&p<=57)?a=S.parse(t):t.isEmpty()||(l=12)}if(a)if(a.isDone())l=9;else if(a.isError())return a.asError()}if(9===l)if(t.isCont()){if(!e.Unicode.isSpace(t.head()))return e.Parser.error(e.Diagnostic.expected("space",t));t.step(),l=10}else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.unexpected(t));if(10===l){if(u)u=u.feed(t);else{for(;t.isCont()&&(p=t.head(),e.Unicode.isSpace(p));)t.step();t.isCont()&&(45===p||p>=48&&p<=57)?u=S.parse(t):t.isEmpty()||(l=12)}if(u)if(u.isDone())l=11;else if(u.isError())return u.asError()}if(11===l)if(t.isCont()){if(!e.Unicode.isSpace(t.head()))return e.Parser.error(e.Diagnostic.expected("space",t));t.step(),l=12}else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.unexpected(t));if(12===l){if(h)h=h.feed(t);else{for(;t.isCont()&&e.Unicode.isSpace(t.head());)t.step();t.isEmpty()||(h=T.parse(t))}if(h)if(h.isDone()){var d=!!n&&"inset"===n.bind(),f=o.bind(),v=s.bind(),y=a?a.bind():m.zero(),w=u?u.bind():m.zero(),g=h.bind(),_=new Xe(d,f,v,y,w,g,null);r=r?r.and(_):_,n=void 0,o=void 0,s=void 0,a=void 0,u=void 0,h=void 0,l=13}else if(h.isError())return h.asError()}if(13===l){for(;t.isCont()&&(p=t.head(),e.Unicode.isSpace(p));)t.step();if(t.isCont()&&44===p){t.step(),l=1;continue}if(!t.isEmpty())return e.Parser.done(r)}break}return new i(r,n,o,s,a,u,h,l)},i}(e.Parser);Xe.Parser=Ye;var Ge=function(t){function e(e){var i=t.call(this)||this;return i._unit=e,i}return h(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t){for(var e=Xe.fromAny(t),r=i.Record.create();;){var n=i.Record.create(5);if(e.inset&&n.push("inset"),n.push(m.form().mold(e.offsetX)),n.push(m.form().mold(e.offsetY)),n.push(m.form().mold(e.blurRadius)),n.push(m.form().mold(e.spreadRadius)),n.push(C.form().mold(e.color)),r.attr("boxShadow",n),!e.next)break;e=e.next}return r},e.prototype.cast=function(t){var e,i=t.toValue();try{if(!(e=Xe.fromValue(i))){var r=i.stringValue();void 0!==r&&(e=Xe.parse(r))}}catch(t){}return e},e}(i.Form);Xe.Form=Ge;var Ke={fromAny:function(t){if(t instanceof o.DateTime||t instanceof a||t instanceof m||t instanceof C||t instanceof j||t instanceof B||t instanceof nt||t instanceof Bt||t instanceof Ae||t instanceof Xe||"number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Date||o.DateTime.isInit(t))return o.DateTime.fromAny(t);if(C.isInit(t))return C.fromAny(t);if(j.isInit(t))return j.fromAny(t);if(Ae.isInit(t))return Ae.fromAny(t);if(Xe.isInit(t))return Xe.fromAny(t);if("string"==typeof t)return Ke.parse(t);throw new TypeError(""+t)},parse:function(t){for("string"==typeof t&&(t=e.Unicode.stringInput(t));t.isCont()&&e.Unicode.isWhitespace(t.head());)t=t.step();var i=Ke.Parser.parse(t);if(i.isDone())for(;t.isCont()&&e.Unicode.isWhitespace(t.head());)t=t.step();return t.isCont()&&!i.isError()&&(i=e.Parser.error(e.Diagnostic.unexpected(t))),i.bind()},_form:void 0,form:function(t){return void 0!==t?(t=Ke.fromAny(t),new Ke.Form(t)):(Ke._form||(Ke._form=new Ke.Form),Ke._form)},Parser:void 0,Form:void 0},Qe=o.DateTimeFormat.pattern("%m-%dT%H:%M:%S.%LZ"),Ze=function(t){function i(e,i,r,n){var o=t.call(this)||this;return o.identOutput=e,o.valueParser=i,o.unitsOutput=r,o.step=n,o}return h(i,t),i.prototype.feed=function(t){return i.parse(t,this.identOutput,this.valueParser,this.unitsOutput,this.step)},i.parse=function(t,r,n,o,s){void 0===s&&(s=1);var u=0;if(1===s){for(;t.isCont()&&(u=t.head(),e.Unicode.isSpace(u));)t.step();if(t.isCont()){if(35===u)return O.parse(t);s=e.Unicode.isAlpha(u)?2:3}else if(!t.isEmpty())return e.Parser.error(e.Diagnostic.unexpected(t))}if(2===s){for(r=r||e.Unicode.stringOutput();t.isCont()&&(u=t.head(),e.Unicode.isAlpha(u)||45===u);)t=t.step(),r.write(u);if(!t.isEmpty()){var h=r.bind();switch(h){case"rgb":case"rgba":return D.parseRest(t);case"hsl":case"hsla":return E.parseRest(t);case"normal":case"italic":case"oblique":return N.parseRest(t,h);case"small-caps":return N.parseRest(t,void 0,h);case"bold":case"bolder":case"lighter":return N.parseRest(t,void 0,void 0,h);case"ultra-condensed":case"extra-condensed":case"semi-condensed":case"condensed":case"expanded":case"semi-expanded":case"extra-expanded":case"ultra-expanded":return N.parseRest(t,void 0,void 0,void 0,h);case"large":case"larger":case"medium":case"small":case"smaller":case"x-large":case"x-small":case"xx-large":case"xx-small":return N.parseRest(t,void 0,void 0,void 0,void 0,h);case"translateX":case"translateY":case"translate":return Q.parseRest(t,r);case"scaleX":case"scaleY":case"scale":return Z.parseRest(t,r);case"rotate":return J.parseRest(t,r);case"skewX":case"skewY":case"skew":return $.parseRest(t,r);case"matrix":return tt.parseRest(t,r);case"none":return e.Parser.done(B.identity());case"true":return e.Parser.done(!0);case"false":return e.Parser.done(!1);default:var l=C.fromName(h);return void 0!==l?e.Parser.done(l):e.Parser.error(e.Diagnostic.message("unknown style value: "+h,t))}}}if(3===s)if((n=n?n.feed(t):e.Base10.parseDecimal(t)).isDone())s=4;else if(n.isError())return n.asError();if(4===s){if(t.isCont()&&45===(u=t.head())){t.step();var p={};return p.year=n.bind(),Qe.parseDate(t,p)}t.isEmpty()||(s=5)}if(5===s){for(o=o||e.Unicode.stringOutput();t.isCont()&&(u=t.head(),e.Unicode.isAlpha(u)||37===u);)t.step(),o.push(u);t.isEmpty()||(s=6)}if(6===s&&!t.isEmpty()){var c=n.bind(),d=o.bind(),f=void 0;switch(d){case"deg":f=a.deg(c);break;case"rad":f=a.rad(c);break;case"grad":f=a.grad(c);break;case"turn":f=a.turn(c);break;case"px":f=m.px(c);break;case"em":f=m.em(c);break;case"rem":f=m.rem(c);break;case"%":f=m.pct(c);break;case"":f=c;break;default:return e.Parser.error(e.Diagnostic.message("unknown style units: "+d,t))}if(t.isCont()&&(u=t.head(),e.Unicode.isSpace(u)||47===u)){if(f instanceof m)return N.parseRest(t,void 0,void 0,void 0,void 0,f);if("number"==typeof f)switch(c){case 100:case 200:case 300:case 400:case 500:case 600:case 700:case 800:case 900:return N.parseRest(t,void 0,void 0,String(c))}}return e.Parser.done(f)}return new i(r,n,o,s)},i}(e.Parser);Ke.Parser=Ze;var Je=function(t){function e(e){var i=t.call(this)||this;return i._unit=e,i}return h(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t=void 0!==t?Ke.fromAny(t):void 0)},e.prototype.mold=function(t){if(void 0!==t){if((t=Ke.fromAny(t))instanceof o.DateTime)return o.DateTime.form().mold(t);if(t instanceof a)return a.form().mold(t);if(t instanceof m)return m.form().mold(t);if(t instanceof C)return C.form().mold(t);if(t instanceof j)return j.form().mold(t);if(t instanceof B)return B.form().mold(t);if(t instanceof nt)return nt.form().mold(t);if(t instanceof Bt)return Bt.form().mold(t);if(t instanceof Ae)return Ae.form().mold(t);if(t instanceof Xe)return Xe.form().mold(t);if("number"==typeof t)return i.Num.from(t);throw new TypeError(""+t)}return i.Item.extant()},e.prototype.cast=function(t){var e=t.toValue();if(e instanceof i.Num)return e.numberValue();if(e instanceof i.Bool)return e.booleanValue();var r=e.stringValue(void 0);if(void 0!==r)try{return Ke.parse(r)}catch(t){}if(e instanceof i.Record){var n=o.DateTime.fromValue(e);if(n)return n;var s=a.fromValue(e);if(s)return s;var u=m.fromValue(e);if(u)return u;var h=C.fromValue(e);if(h)return h;var l=j.fromValue(e);if(l)return l;var p=B.fromValue(e);if(p)return p;var c=nt.form().cast(e);if(c)return c;var d=Bt.form().cast(e);if(d)return d;var f=Ae.form().cast(e);if(f)return f;var v=Xe.fromValue(e);if(v)return v}},e}(i.Form);function $e(t){return t&&"object"==typeof t&&"function"==typeof t.toAttributeString?t.toAttributeString():""+t}function ti(t){return t&&"object"==typeof t&&"function"==typeof t.toStyleString?t.toStyleString():""+t}Ke.Form=Je,nt.valueForm=Ke.form,Bt.domainForm=Ke.form,Bt.interpolatorForm=nt.form,Ae.interpolatorForm=nt.form;var ei=Math.PI,ii=2*ei,ri=function(){function t(){this.x0=null,this.y0=null,this.x1=null,this.y1=null,this.d=""}return t.prototype.moveTo=function(t,e){this.d+="M"+(this.x0=this.x1=t)+","+(this.y0=this.y1=e)},t.prototype.closePath=function(){void 0!==this.x1&&(this.x1=this.x0,this.y1=this.y0,this.d+="Z")},t.prototype.lineTo=function(t,e){this.d+="L"+(this.x1=t)+","+(this.y1=e)},t.prototype.quadraticCurveTo=function(t,e,i,r){this.d+="Q"+t+","+e+","+(this.x1=i)+","+(this.y1=r)},t.prototype.bezierCurveTo=function(t,e,i,r,n,o){this.d+="C"+t+","+e+","+i+","+r+","+(this.x1=n)+","+(this.y1=o)},t.prototype.arcTo=function(t,e,i,r,n){var o=+this.x1,s=+this.y1,a=i-t,u=r-e,h=o-t,l=s-e,p=h*h+l*l;if(n<0)throw new Error("negative radius: "+n);if(null===this.x1)this.d+="M"+(this.x1=t)+","+(this.y1=e);else if(p>1e-6)if(Math.abs(l*a-u*h)>1e-6&&n){var c=i-o,d=r-s,f=a*a+u*u,v=c*c+d*d,y=Math.sqrt(f),m=Math.sqrt(p),w=n*Math.tan((ei-Math.acos((f+p-v)/(2*y*m)))/2),g=w/m,_=w/y;Math.abs(g-1)>1e-6&&(this.d+="L"+(t+g*h)+","+(e+g*l)),this.d+="A"+n+","+n+",0,0,"+ +(l*c>h*d)+","+(this.x1=t+_*a)+","+(this.y1=e+_*u)}else this.d+="L"+(this.x1=t)+","+(this.y1=e);else;},t.prototype.arc=function(t,e,i,r,n,o){void 0===o&&(o=!1);var s=i*Math.cos(r),a=i*Math.sin(r),u=t+s,h=e+a,l=1^+o,p=o?r-n:n-r;if(i<0)throw new Error("negative radius: "+i);null===this.x1?this.d+="M"+u+","+h:(Math.abs(+this.x1-u)>1e-6||Math.abs(+this.y1-h)>1e-6)&&(this.d+="L"+u+","+h),i&&(p<0&&(p=p%ii+ii),p>ii-1e-6?this.d+="A"+i+","+i+",0,1,"+l+","+(t-s)+","+(e-a)+"A"+i+","+i+",0,1,"+l+","+(this.x1=u)+","+(this.y1=h):p>1e-6&&(this.d+="A"+i+","+i+",0,"+ +(p>=ei)+","+l+","+(this.x1=t+i*Math.cos(n))+","+(this.y1=e+i*Math.sin(n))))},t.prototype.rect=function(t,e,i,r){this.d+="M"+(this.x0=this.x1=t)+","+(this.y0=this.y1=e)+"h"+i+"v"+r+"h"+-i+"Z"},t.prototype.toString=function(){return this.d},t}(),ni=function(){function t(){}return t.prototype.willSetKey=function(t){this.willObserve(function(e){e.viewWillSetKey&&e.viewWillSetKey(t,this)})},t.prototype.onSetKey=function(t){},t.prototype.didSetKey=function(t){this.didObserve(function(e){e.viewDidSetKey&&e.viewDidSetKey(t,this)})},t.prototype.willSetViewController=function(t){},t.prototype.onSetViewController=function(t){},t.prototype.didSetViewController=function(t){},t.prototype.willAddViewObserver=function(t){},t.prototype.onAddViewObserver=function(t){},t.prototype.didAddViewObserver=function(t){},t.prototype.willRemoveViewObserver=function(t){},t.prototype.onRemoveViewObserver=function(t){},t.prototype.didRemoveViewObserver=function(t){},t.prototype.willObserve=function(t){var e=this.viewController;e&&t.call(this,e);for(var i=this.viewObservers,r=0,n=i.length;r<n;r+=1)t.call(this,i[r])},t.prototype.didObserve=function(t){for(var e=this.viewObservers,i=0,r=e.length;i<r;i+=1)t.call(this,e[i]);var n=this.viewController;n&&t.call(this,n)},Object.defineProperty(t.prototype,"appView",{get:function(){var t=this.parentView;return t?t.appView:null},enumerable:!0,configurable:!0}),t.prototype.willSetParentView=function(t){this.willObserve(function(e){e.viewWillSetParentView&&e.viewWillSetParentView(t,this)})},t.prototype.onSetParentView=function(t){t?t.isMounted()&&this.cascadeMount():this.cascadeUnmount()},t.prototype.didSetParentView=function(t){this.didObserve(function(e){e.viewDidSetParentView&&e.viewDidSetParentView(t,this)})},t.prototype.getChildView=function(t){for(var e=this.childViews,i=e.length-1;i>=0;i-=1){var r=e[i];if(r.key()===t)return r}return null},t.prototype.willInsertChildView=function(t,e){this.willObserve(function(i){i.viewWillInsertChildView&&i.viewWillInsertChildView(t,e,this)})},t.prototype.onInsertChildView=function(t,e){},t.prototype.didInsertChildView=function(t,e){this.didObserve(function(i){i.viewDidInsertChildView&&i.viewDidInsertChildView(t,e,this)})},t.prototype.willRemoveChildView=function(t){this.willObserve(function(e){e.viewWillRemoveChildView&&e.viewWillRemoveChildView(t,this)})},t.prototype.onRemoveChildView=function(t){},t.prototype.didRemoveChildView=function(t){this.didObserve(function(e){e.viewDidRemoveChildView&&e.viewDidRemoveChildView(t,this)})},t.prototype.isMounted=function(){var t=this.parentView;return!!t&&t.isMounted()},t.prototype.cascadeMount=function(){this.willMount(),this.onMount();for(var t=this.childViews,e=0,i=t.length;e<i;e+=1){t[e].cascadeMount()}this.didMount()},t.prototype.willMount=function(){this.willObserve(function(t){t.viewWillMount&&t.viewWillMount(this)})},t.prototype.onMount=function(){},t.prototype.didMount=function(){this.didObserve(function(t){t.viewDidMount&&t.viewDidMount(this)})},t.prototype.cascadeUnmount=function(){this.willMount(),this.onUnmount();for(var t=this.childViews,e=0,i=t.length;e<i;e+=1){t[e].cascadeUnmount()}this.didMount()},t.prototype.willUnmount=function(){this.willObserve(function(t){t.viewWillUnmount&&t.viewWillUnmount(this)})},t.prototype.onUnmount=function(){},t.prototype.didUnmount=function(){this.didObserve(function(t){t.viewDidUnmount&&t.viewDidUnmount(this)})},t.prototype.cascadeResize=function(){this.willResize(),this.onResize();for(var t=this.childViews,e=0,i=t.length;e<i;e+=1){t[e].cascadeResize()}this.didResize()},t.prototype.willResize=function(){this.willObserve(function(t){t.viewWillResize&&t.viewWillResize(this)})},t.prototype.onResize=function(){},t.prototype.didResize=function(){this.didObserve(function(t){t.viewDidResize&&t.viewDidResize(this)})},t.prototype.cascadeScroll=function(){this.willScroll(),this.onScroll();for(var t=this.childViews,e=0,i=t.length;e<i;e+=1){t[e].cascadeScroll()}this.didScroll()},t.prototype.willScroll=function(){this.willObserve(function(t){t.viewWillScroll&&t.viewWillScroll(this)})},t.prototype.onScroll=function(){},t.prototype.didScroll=function(){this.didObserve(function(t){t.viewDidScroll&&t.viewDidScroll(this)})},Object.defineProperty(t.prototype,"pageTransform",{get:function(){var t=this.parentView;return t?t.pageTransform.transform(this.parentTransform):B.identity()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageBounds",{get:function(){var t=this.clientBounds,e=this.clientTransform;return t.transform(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"popoverBounds",{get:function(){return this.pageBounds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientTransform",{get:function(){var t,e=window.pageXOffset,i=window.pageYOffset;t=0!==e||0!==i?B.translate(e,i):B.identity();var r=this.pageTransform;return t.transform(r)},enumerable:!0,configurable:!0}),t.prototype.isVisible=function(){var t=this.clientBounds,e=document.documentElement.clientWidth,i=document.documentElement.clientHeight;return(t.top<=0&&0<t.bottom||0<=t.top&&t.top<i)&&(t.left<=0&&0<t.right||0<=t.left&&t.left<e)},t.fromNode=function(e){return e.view instanceof t?e.view:e instanceof Element?e instanceof HTMLElement?e instanceof HTMLCanvasElement?new t.Canvas(e):new t.Html(e):e instanceof SVGElement?new t.Svg(e):new t.Element(e):e instanceof Text?new t.Text(e):new t.Node(e)},t.fromTag=function(e){return"svg"===e?new t.Svg(document.createElementNS(t.Svg.NS,e)):"canvas"===e?new t.Canvas(document.createElement(e)):t.fromNode(document.createElement(e))},t.decorateMemberAnimator=function(t,e,i,r){"inherit"===e&&(e=r),Object.defineProperty(i,r,{get:function(){var i=new t(this,void 0,void 0,e);return Object.defineProperty(this,r,{value:i,configurable:!0,enumerable:!0}),i},configurable:!0,enumerable:!0})},t}(),oi=function(t){var e=function(i,n,o,s){if(this instanceof e){void 0===o&&(o=null);var u=t.call(this,n,o)||this;return u._view=i,u._inherit=void 0!==s?s:null,u}var h=i;if(s=n,h===Object)return ni.decorateMemberAnimator.bind(void 0,e.Object,s);if(h===String)return ni.decorateMemberAnimator.bind(void 0,e.String,s);if(h===Boolean)return ni.decorateMemberAnimator.bind(void 0,e.Boolean,s);if(h===Number)return ni.decorateMemberAnimator.bind(void 0,e.Number,s);if(h===a)return ni.decorateMemberAnimator.bind(void 0,e.Angle,s);if(h===m)return ni.decorateMemberAnimator.bind(void 0,e.Length,s);if(h===C)return ni.decorateMemberAnimator.bind(void 0,e.Color,s);if(h===j)return ni.decorateMemberAnimator.bind(void 0,e.Font,s);if(h===B)return ni.decorateMemberAnimator.bind(void 0,e.Transform,s);if(r.FromAny.is(h))return ni.decorateMemberAnimator.bind(void 0,e.Any.bind(void 0,h),s);throw new TypeError(""+h)};return h(e,t),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inherit",{get:function(){return this._inherit},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dirty",{get:function(){return this._view.dirty},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this._inherit;if(null!==e)for(var i=this._view.parentView;i;){var r=i[e];if(r instanceof Oe){t=r.value;break}i=i.parentView}}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){var t=this._state;if(void 0===t){var e=this._inherit;if(null!==e)for(var i=this._view.parentView;i;){var r=i[e];if(r instanceof Oe){t=r.state;break}i=i.parentView}}return t},enumerable:!0,configurable:!0}),e.prototype.setDirty=function(t){t&&this._view.setDirty(t)},e.prototype.animate=function(){this._disabled||this._view.animate()},e.prototype.cancel=function(){},e.prototype.update=function(t,e){r.Objects.equal(e,t)||this.setDirty(!0)},e.prototype.delete=function(){},e}(Oe),si=function(t){function e(e,i,r,n,o){var s=t.call(this,i,r,n,o)||this;s._type=e;var a=s;function u(t,e){return void 0===t?a.value:(null!==t&&(t=a.type.fromAny(t)),a.setState(t,e),a._view)}return u.__proto__=a,a=u}return h(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),e}(oi);oi.Any=si;var ai=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,e){return void 0===t?o.value:(o.setState(t,e),o._view)}return s.__proto__=o,o=s}return h(e,t),e}(oi);oi.Object=ai;var ui=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,e){return void 0===t?o.value:(o.setState(t,e),o._view)}return s.__proto__=o,o=s}return h(e,t),e}(oi);oi.String=ui;var hi=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,e){return void 0===t?o.value:("string"==typeof t&&(t=!!t),o.setState(t,e),o._view)}return s.__proto__=o,o=s}return h(e,t),e}(oi);oi.Boolean=hi;var li=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,e){return void 0===t?o.value:("string"==typeof t&&(t=+t),o.setState(t,e),o._view)}return s.__proto__=o,o=s}return h(e,t),e}(oi);oi.Number=li;var pi=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,e){return void 0===t?o.value:(null!==t&&(t=a.fromAny(t)),o.setState(t,e),o._view)}return s.__proto__=o,o=s}return h(e,t),e}(oi);oi.Angle=pi;var ci=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,e){return void 0===t?o.value:(null!==t&&(t=m.fromAny(t)),o.setState(t,e),o._view)}return s.__proto__=o,o=s}return h(e,t),e}(oi);oi.Length=ci;var di=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,e){return void 0===t?o.value:(null!==t&&(t=C.fromAny(t)),o.setState(t,e),o._view)}return s.__proto__=o,o=s}return h(e,t),e}(oi);oi.Color=di;var fi=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,e){return void 0===t?o.value:(null!==t&&(t=j.fromAny(t)),o.setState(t,e),o._view)}return s.__proto__=o,o=s}return h(e,t),e}(oi);oi.Font=fi;var vi=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,e){return void 0===t?o.value:(null!==t&&(t=B.fromAny(t)),o.setState(t,e),o._view)}return s.__proto__=o,o=s}return h(e,t),e}(oi);oi.Transform=vi;var yi=function(t){function e(e,i){void 0===i&&(i=null);var r=t.call(this)||this;return r.onAnimationFrame=r.onAnimationFrame.bind(r),r._node=e,r._node.view=r,r._key=i,r._viewController=null,r._viewObservers=[],r._dirty=!1,r._animationFrame=0,r.initNode(r._node),r}return h(e,t),Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!0,configurable:!0}),e.prototype.initNode=function(t){},e.prototype.key=function(t){return void 0===t?this._key:(this.willSetKey(t),this._key=t,this.onSetKey(t),this.didSetKey(t),this)},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.setViewController=function(t){this._viewController!==t&&(this.willSetViewController(t),this._viewController&&this._viewController.setView&&this._viewController.setView(null),this._viewController=t,this._viewController&&this._viewController.setView&&this._viewController.setView(this),this.onSetViewController(t),this.didSetViewController(t))},Object.defineProperty(e.prototype,"viewObservers",{get:function(){return this._viewObservers},enumerable:!0,configurable:!0}),e.prototype.addViewObserver=function(t){var e=this._viewObservers;e.indexOf(t)<0&&(this.willAddViewObserver(t),e.push(t),t.setView&&t.setView(this),this.onAddViewObserver(t),this.didAddViewObserver(t))},e.prototype.removeViewObserver=function(t){var e=this._viewObservers,i=e.indexOf(t);i>=0&&(this.willRemoveViewObserver(t),t.setView&&t.setView(null),e.splice(i,1),this.onRemoveViewObserver(t),this.didRemoveViewObserver(t))},Object.defineProperty(e.prototype,"parentView",{get:function(){var t=this._node.parentNode;if(t){var e=t.view;if(e instanceof ni)return e}return null},enumerable:!0,configurable:!0}),e.prototype.setParentView=function(t){this.willSetParentView(t),this.onSetParentView(t),this.didSetParentView(t)},Object.defineProperty(e.prototype,"childViews",{get:function(){for(var t=this._node.childNodes,e=[],i=0,r=t.length;i<r;i+=1){var n=t[i].view;n&&e.push(n)}return e},enumerable:!0,configurable:!0}),e.prototype.getChildView=function(t){for(var e=this._node.childNodes,i=e.length-1;i>=0;i-=1){var r=e[i].view;if(r&&r.key()===t)return r}return null},e.prototype.setChildView=function(t,i){if(!(i instanceof e))throw new TypeError(""+i);for(var r=null,n=null,o=this._node.childNodes,s=o.length-1;s>=0;s-=1){var a=o[s].view;if(a&&a.key()===t){r=a,n=o[s+1]||null,this.removeChildView(a);break}}return i&&(i.key(t),this.insertChild(i,n)),r},e.prototype.appendChild=function(t){if(t instanceof ni)this.appendChildView(t);else{if(!(t instanceof Node))throw new TypeError(""+t);this.appendChildNode(t)}},e.prototype.appendChildView=function(t){if(!(t instanceof e))throw new TypeError(""+t);var i=t._node;this.willInsertChildView(t,null),this.willInsertChildNode(i,null),this._node.appendChild(i),t.setParentView(this),this.onInsertChildNode(i,null),this.onInsertChildView(t,null),this.didInsertChildNode(i,null),this.didInsertChildView(t,null)},e.prototype.appendChildNode=function(t){var e=t.view;void 0!==e&&this.willInsertChildView(e,null),this.willInsertChildNode(t,null),this._node.appendChild(t),void 0!==e&&e.setParentView(this),this.onInsertChildNode(t,null),void 0!==e&&this.onInsertChildView(e,null),this.didInsertChildNode(t,null),void 0!==e&&this.didInsertChildView(e,null)},e.prototype.prependChild=function(t){if(t instanceof ni)this.prependChildView(t);else{if(!(t instanceof Node))throw new TypeError(""+t);this.prependChildNode(t)}},e.prototype.prependChildView=function(t){if(!(t instanceof e))throw new TypeError(""+t);var i=t._node,r=this._node.firstChild,n=r?r.view:null;this.willInsertChildView(t,n),this.willInsertChildNode(i,r),this._node.insertBefore(i,r),t.setParentView(this),this.onInsertChildNode(i,r),this.onInsertChildView(t,n),this.didInsertChildNode(i,r),this.didInsertChildView(t,n)},e.prototype.prependChildNode=function(t){var e=t.view,i=this._node.firstChild,r=i?i.view:null;void 0!==e&&this.willInsertChildView(e,r),this.willInsertChildNode(t,i),this._node.insertBefore(t,i),void 0!==e&&e.setParentView(this),this.onInsertChildNode(t,i),void 0!==e&&this.onInsertChildView(e,r),this.didInsertChildNode(t,i),void 0!==e&&this.didInsertChildView(e,r)},e.prototype.insertChild=function(t,i){if(t instanceof e)if(i instanceof ni)this.insertChildView(t,i);else{if(!(i instanceof Node||null===i))throw new TypeError(""+i);this.insertChildNode(t._node,i)}else{if(!(t instanceof Node))throw new TypeError(""+t);if(i instanceof e)this.insertChildNode(t,i._node);else{if(!(i instanceof Node||null===i))throw new TypeError(""+i);this.insertChildNode(t,i)}}},e.prototype.insertChildView=function(t,i){if(!(t instanceof e))throw new TypeError(""+t);if(null!==i&&!(i instanceof e))throw new TypeError(""+i);var r=t._node,n=i?i._node:null;this.willInsertChildView(t,i),this.willInsertChildNode(r,n),this._node.insertBefore(r,n),t.setParentView(this),this.onInsertChildNode(r,n),this.onInsertChildView(t,i),this.didInsertChildNode(r,n),this.didInsertChildView(t,i)},e.prototype.insertChildNode=function(t,e){var i=t.view,r=e?e.view:null;void 0!==i&&this.willInsertChildView(i,r),this.willInsertChildNode(t,e),this._node.insertBefore(t,e),void 0!==i&&i.setParentView(this),this.onInsertChildNode(t,e),void 0!==i&&this.onInsertChildView(i,r),this.didInsertChildNode(t,e),void 0!==i&&this.didInsertChildView(i,r)},e.prototype.injectChildView=function(t,e){var i=t._node,r=e?e._node:null;this.willInsertChildView(t,e),this.willInsertChildNode(i,r),t.setParentView(this),this.onInsertChildNode(i,r),this.onInsertChildView(t,e),this.didInsertChildNode(i,r),this.didInsertChildView(t,e)},e.prototype.willInsertChildNode=function(t,e){this.willObserve(function(i){i.viewWillInsertChildNode&&i.viewWillInsertChildNode(t,e,this)})},e.prototype.onInsertChildNode=function(t,e){},e.prototype.didInsertChildNode=function(t,e){this.didObserve(function(i){i.viewDidInsertChildNode&&i.viewDidInsertChildNode(t,e,this)})},e.prototype.removeChild=function(t){if(t instanceof ni)this.removeChildView(t);else{if(!(t instanceof Node))throw new TypeError(""+t);this.removeChildNode(t)}},e.prototype.removeChildView=function(t){if(!(t instanceof e))throw new TypeError(""+t);var i=t._node;this.willRemoveChildView(t),this.willRemoveChildNode(i),t.setParentView(null),this._node.removeChild(i),this.onRemoveChildNode(i),this.onRemoveChildView(t),this.didRemoveChildNode(i),this.didRemoveChildView(t)},e.prototype.removeChildNode=function(t){var e=t.view;void 0!==e&&this.willRemoveChildView(e),this.willRemoveChildNode(t),this._node.removeChild(t),void 0!==e&&e.setParentView(null),this.onRemoveChildNode(t),void 0!==e&&this.onRemoveChildView(e),this.didRemoveChildNode(t),void 0!==e&&this.didRemoveChildView(e)},e.prototype.removeAll=function(){for(;;){var t=this._node.lastChild;if(!t)break;var e=t.view;void 0!==e&&this.willRemoveChildView(e),this.willRemoveChildNode(t),this._node.removeChild(t),void 0!==e&&e.setParentView(null),this.onRemoveChildNode(t),void 0!==e&&this.onRemoveChildView(e),this.didRemoveChildNode(t),void 0!==e&&this.didRemoveChildView(e)}},e.prototype.remove=function(){var t=this._node,e=t.parentNode;if(e){var i=e.view;i?i.removeChildView(this):(e.removeChild(t),this.setParentView(null))}},e.prototype.willRemoveChildNode=function(t){this.willObserve(function(e){e.viewWillRemoveChildNode&&e.viewWillRemoveChildNode(t,this)})},e.prototype.onRemoveChildNode=function(t){},e.prototype.didRemoveChildNode=function(t){this.didObserve(function(e){e.viewDidRemoveChildNode&&e.viewDidRemoveChildNode(t,this)})},e.prototype.text=function(t){return void 0===t?this._node.textContent:(this._node.textContent=t,this)},e.prototype.isMounted=function(){for(var t=this._node;;){var e=t.parentNode;if(!e)break;if(e.nodeType===Node.DOCUMENT_NODE)return!0;t=e}return!1},e.prototype.cascadeMount=function(){this.willMount(),this.onMount();for(var t=this._node.childNodes,e=0,i=t.length;e<i;e+=1){var r=t[e].view;r&&r.cascadeMount()}this.didMount()},e.prototype.cascadeUnmount=function(){this.willUnmount(),this.onUnmount();for(var t=this._node.childNodes,e=0,i=t.length;e<i;e+=1){var r=t[e].view;r&&r.cascadeUnmount()}this.didUnmount()},e.prototype.cascadeResize=function(){this.willResize(),this.onResize();for(var t=this._node.childNodes,e=0,i=t.length;e<i;e+=1){var r=t[e].view;r&&r.cascadeResize()}this.didResize()},e.prototype.animate=function(t){void 0===t&&(t=!1),this._animationFrame||t?t&&(this._animationFrame&&cancelAnimationFrame(this._animationFrame),this.onAnimationFrame(performance.now())):this._animationFrame=requestAnimationFrame(this.onAnimationFrame)},e.prototype.onAnimationFrame=function(t){this._animationFrame=0,this.cascadeAnimate(t)},e.prototype.cascadeAnimate=function(t){this.willAnimate(t),this.onAnimate(t),this.didAnimate(t)},e.prototype.willAnimate=function(t){this.willObserve(function(e){e.viewWillAnimate&&e.viewWillAnimate(t,this)})},e.prototype.onAnimate=function(t){},e.prototype.didAnimate=function(t){this.didObserve(function(e){e.viewDidAnimate&&e.viewDidAnimate(t,this)}),this.setDirty(!1)},Object.defineProperty(e.prototype,"dirty",{get:function(){return this._dirty},enumerable:!0,configurable:!0}),e.prototype.setDirty=function(t){t&&!this._dirty?(this._dirty=!0,this.didSetDirty(!0)):!t&&this._dirty&&(this._dirty=!1,this.didSetDirty(!1))},e.prototype.didSetDirty=function(t){t&&this.animate()},Object.defineProperty(e.prototype,"parentTransform",{get:function(){return B.identity()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clientBounds",{get:function(){var t=document.createRange();t.selectNode(this._node);var e=t.getBoundingClientRect();return t.detach(),new n.BoxR2(e.left,e.top,e.right,e.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageBounds",{get:function(){var t=document.createRange();t.selectNode(this._node);var e=t.getBoundingClientRect();t.detach();var i=window.pageXOffset,r=window.pageYOffset;return new n.BoxR2(e.left+i,e.top+r,e.right+i,e.bottom+r)},enumerable:!0,configurable:!0}),e.prototype.dispatchEvent=function(t){return this._node.dispatchEvent(t)},e.prototype.on=function(t,e,i){return this._node.addEventListener(t,e,i),this},e.prototype.off=function(t,e,i){return this._node.removeEventListener(t,e,i),this},e}(ni);ni.Node=yi;var mi=function(t){function e(e,i){return void 0===i&&(i=null),t.call(this,e,i)||this}return h(e,t),Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!0,configurable:!0}),e.prototype.initNode=function(t){},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.elemId=function(t){return this._node.setAttribute("id",$e(t)),this},e.prototype.className=function(t){return void 0===t?this._node.classList:(this._node.setAttribute("class",$e(t)),this)},e.prototype.addClass=function(t){return this._node.classList.add($e(t)),this},e.prototype.removeClass=function(t){return this._node.classList.remove($e(t)),this},e.prototype.setAttribute=function(t,e){this.willSetAttribute(t,e),this._node.setAttribute(t,$e(e)),this.onSetAttribute(t,e),this.didSetAttribute(t,e)},e.prototype.willSetAttribute=function(t,e){this.willObserve(function(i){i.viewWillSetAttribute&&i.viewWillSetAttribute(t,e,this)})},e.prototype.onSetAttribute=function(t,e){},e.prototype.didSetAttribute=function(t,e){this.didObserve(function(i){i.viewDidSetAttribute&&i.viewDidSetAttribute(t,e,this)})},e.prototype.setStyle=function(t,e,i){this.willSetStyle(t,e,i),this._node.style.setProperty(t,ti(e),i),this.onSetStyle(t,e,i),this.didSetStyle(t,e,i)},e.prototype.willSetStyle=function(t,e,i){this.willObserve(function(r){r.viewWillSetStyle&&r.viewWillSetStyle(t,e,i,this)})},e.prototype.onSetStyle=function(t,e,i){},e.prototype.didSetStyle=function(t,e,i){this.didObserve(function(r){r.viewDidSetStyle&&r.viewDidSetStyle(t,e,i,this)})},Object.defineProperty(e.prototype,"clientBounds",{get:function(){var t=this._node.getBoundingClientRect();return new n.BoxR2(t.left,t.top,t.right,t.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageBounds",{get:function(){var t=this._node.getBoundingClientRect(),e=window.pageXOffset,i=window.pageYOffset;return new n.BoxR2(t.left+e,t.top+i,t.right+e,t.bottom+i)},enumerable:!0,configurable:!0}),e.prototype.on=function(t,e,i){return this._node.addEventListener(t,e,i),this},e.prototype.off=function(t,e,i){return this._node.removeEventListener(t,e,i),this},e.decorateAttributeAnimator=function(t,e,i,r){Object.defineProperty(i,r,{get:function(){var i=new t(this,e);return Object.defineProperty(this,r,{value:i,configurable:!0,enumerable:!0}),i},configurable:!0,enumerable:!0})},e.decorateStyleAnimator=function(t,e,i,r){Object.defineProperty(i,r,{get:function(){var i=new t(this,e);return Object.defineProperty(this,r,{value:i,configurable:!0,enumerable:!0}),i},configurable:!0,enumerable:!0})},e}(yi);ni.Element=mi;var wi=function(t){var e=function(i,r,n,o){if(this instanceof e){void 0===o&&(o=null);var s=t.call(this,n,o)||this;return s._view=i,s._name=r,s}var a=r;if(r=i,a===String)return mi.decorateAttributeAnimator.bind(void 0,e.String,r);if(a===Boolean)return mi.decorateAttributeAnimator.bind(void 0,e.Boolean,r);if(a===Number)return mi.decorateAttributeAnimator.bind(void 0,e.Number,r);if(a===m)return mi.decorateAttributeAnimator.bind(void 0,e.Length,r);if(a===C)return mi.decorateAttributeAnimator.bind(void 0,e.Color,r);if(a===B)return mi.decorateAttributeAnimator.bind(void 0,e.Transform,r);if(Array.isArray(a)&&2===a.length){var u=a[0],h=a[1];if(u===Number&&h===String)return mi.decorateAttributeAnimator.bind(void 0,e.NumberOrString,r);if(u===m&&h===String)return mi.decorateAttributeAnimator.bind(void 0,e.LengthOrString,r);if(u===C&&h===String)return mi.decorateAttributeAnimator.bind(void 0,e.ColorOrString,r)}throw new TypeError(""+a)};return h(e,t),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"node",{get:function(){return this._view._node},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attributeValue",{get:function(){return this._view._node.getAttribute(this._name)},enumerable:!0,configurable:!0}),e.prototype.update=function(t,e){r.Objects.equal(e,t)||(this.willUpdate(t,e),this._view.setAttribute(this._name,t),this.didUpdate(t,e))},e.prototype.willUpdate=function(t,e){},e.prototype.didUpdate=function(t,e){},e.prototype.delete=function(){this._view._node.removeAttribute(this._name)},e}(De),gi=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,e){return void 0===t?o.value:(o.setState(t,e),o._view)}return s.__proto__=o,o=s}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;e&&(t=e)}return t},enumerable:!0,configurable:!0}),e}(wi);wi.String=gi;var _i=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,e){return void 0===t?o.value:("string"==typeof t&&(t=!!t),o.setState(t,e),o._view)}return s.__proto__=o,o=s}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;e&&(t=!!e)}return t},enumerable:!0,configurable:!0}),e}(wi);wi.Boolean=_i;var bi=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,e){return void 0===t?o.value:("string"==typeof t&&(t=+t),o.setState(t,e),o._view)}return s.__proto__=o,o=s}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;e&&(t=+e)}return t},enumerable:!0,configurable:!0}),e}(wi);wi.Number=bi;var xi=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,i){return void 0===t?o.value:(null!==t&&(t=m.fromAny(t,e._node)),o.setState(t,i),o._view)}return s.__proto__=o,o=s}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;if(e)try{t=m.parse(e)}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(wi);wi.Length=xi;var Si=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,e){return void 0===t?o.value:(null!==t&&(t=C.fromAny(t)),o.setState(t,e),o._view)}return s.__proto__=o,o=s}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;if(e)try{t=C.parse(e)}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(wi);wi.Color=Si;var Ai=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,e){return void 0===t?o.value:(null!==t&&(t=B.fromAny(t)),o.setState(t,e),o._view)}return s.__proto__=o,o=s}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;if(e)try{t=B.parse(e)}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(wi);wi.Transform=Ai;var Ci=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,e){return void 0===t?o.value:("string"==typeof t&&isFinite(+t)&&(t=+t),o.setState(t,e),o._view)}return s.__proto__=o,o=s}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;e&&(t=isFinite(+e)?+e:e)}return t},enumerable:!0,configurable:!0}),e}(wi);wi.NumberOrString=Ci;var Vi=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,i){if(void 0===t)return o.value;if(null!==t)if("string"==typeof t)try{t=m.parse(t,e._node)}catch(t){}else t=m.fromAny(t,e._node);return o.setState(t,i),o._view}return s.__proto__=o,o=s}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;if(e)try{t=m.parse(e)}catch(i){t=e}}return t},enumerable:!0,configurable:!0}),e}(wi);wi.LengthOrString=Vi;var Pi=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;function s(t,e){if(void 0===t)return o.value;if(null!==t)if("string"==typeof t)try{t=C.parse(t)}catch(t){}else t=C.fromAny(t);return o.setState(t,e),o._view}return s.__proto__=o,o=s}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;if(e)try{t=C.parse(e)}catch(i){t=e}}return t},enumerable:!0,configurable:!0}),e}(wi);wi.ColorOrString=Pi;var Mi=function(t){var e=function(i,r,n,o,s){if(this instanceof e){void 0===o&&(o=null);var a=t.call(this,n,o)||this;return a._view=i,a._names=r,a._priority=s,a}var u=r;if(r=i,u===String)return mi.decorateStyleAnimator.bind(void 0,e.String,r);if(u===Number)return mi.decorateStyleAnimator.bind(void 0,e.Number,r);if(u===m)return mi.decorateStyleAnimator.bind(void 0,e.Length,r);if(u===C)return mi.decorateStyleAnimator.bind(void 0,e.Color,r);if(u===U)return mi.decorateStyleAnimator.bind(void 0,e.LineHeight,r);if(u===z)return mi.decorateStyleAnimator.bind(void 0,e.FontFamily,r);if(u===B)return mi.decorateStyleAnimator.bind(void 0,e.Transform,r);if(u===Xe)return mi.decorateStyleAnimator.bind(void 0,e.BoxShadow,r);if(Array.isArray(u)&&2===u.length){var h=u[0],l=u[1];if(h===Number&&l===String)return mi.decorateStyleAnimator.bind(void 0,e.NumberOrString,r);if(h===m&&l===String)return mi.decorateStyleAnimator.bind(void 0,e.LengthOrString,r);if(h===C&&l===String)return mi.decorateStyleAnimator.bind(void 0,e.ColorOrString,r)}throw new TypeError(""+u)};return h(e,t),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"node",{get:function(){return this._view._node},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"names",{get:function(){return this._names},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"priority",{get:function(){return this._priority},set:function(t){this._priority=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propertyValue",{get:function(){var t=this._view._node.style,e=this._names;if("string"==typeof e)return t.getPropertyValue(e);for(var i=0,r=e.length;i<r;i+=1){var n=t.getPropertyValue(e[i]);if(n)return n}return""},enumerable:!0,configurable:!0}),e.prototype.setState=function(e,i,r){"string"==typeof r?this.priority=r:null===r&&(this.priority=void 0),t.prototype.setState.call(this,e,i)},e.prototype.update=function(t,e){if(!r.Objects.equal(e,t)){this.willUpdate(t,e);var i=this._names;if("string"==typeof i)this._view.setStyle(i,t,this.priority);else for(var n=0,o=i.length;n<o;n+=1)this._view.setStyle(i[n],t,this.priority);this.didUpdate(t,e)}},e.prototype.willUpdate=function(t,e){},e.prototype.didUpdate=function(t,e){},e.prototype.delete=function(){var t=this._view._node.style,e=this._names;if("string"==typeof e)t.removeProperty(e);else for(var i=0,r=e.length;i<r;i+=1)t.removeProperty(e[i])},e}(De),Ri=function(t){function e(e,i,r,n,o){var s=t.call(this,e,i,r,n,o)||this;function a(t,e,i){return void 0===t?s.value:(s.setState(t,e,i),s._view)}return a.__proto__=s,s=a}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;e&&(t=e)}return t},enumerable:!0,configurable:!0}),e}(Mi);Mi.String=Ri;var Oi=function(t){function e(e,i,r,n,o){var s=t.call(this,e,i,r,n,o)||this;function a(t,e,i){return void 0===t?s.value:("string"==typeof t&&(t=+t),s.setState(t,e,i),s._view)}return a.__proto__=s,s=a}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;e&&(t=+e)}return t},enumerable:!0,configurable:!0}),e}(Mi);Mi.Number=Oi;var Di=function(t){function e(e,i,r,n,o){var s=t.call(this,e,i,r,n,o)||this;function a(t,i,r){return void 0===t?s.value:(null!==t&&(t=m.fromAny(t,e._node)),s.setState(t,i,r),s._view)}return a.__proto__=s,s=a}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;if(e)try{t=m.parse(e)}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(Mi);Mi.Length=Di;var Ei=function(t){function e(e,i,r,n,o){var s=t.call(this,e,i,r,n,o)||this;function a(t,e,i){return void 0===t?s.value:(null!==t&&(t=C.fromAny(t)),s.setState(t,e,i),s._view)}return a.__proto__=s,s=a}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;if(e)try{t=C.parse(e)}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(Mi);Mi.Color=Ei;var Ti=function(t){function e(e,i,r,n,o){var s=t.call(this,e,i,r,n,o)||this;function a(t,e,i){return void 0===t?s.value:(null!==t&&(t=U.fromAny(t)),s.setState(t,e,i),s._view)}return a.__proto__=s,s=a}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;if(e)try{t=U.fromAny(e)}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(Mi);Mi.LineHeight=Ti;var ki=function(t){function e(e,i,r,n,o){var s=t.call(this,e,i,r,n,o)||this;function a(t,e,i){return void 0===t?s.value:(null!==t&&(t=j.family(t).family()),s.setState(t,e,i),s._view)}return a.__proto__=s,s=a}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;if(e)try{t=j.parse(e).family()}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(Mi);Mi.FontFamily=ki;var Ii=function(t){function e(e,i,r,n,o){var s=t.call(this,e,i,r,n,o)||this;function a(t,e,i){return void 0===t?s.value:(null!==t&&(t=B.fromAny(t)),s.setState(t,e,i),s._view)}return a.__proto__=s,s=a}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;if(e)try{t=B.parse(e)}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(Mi);Mi.Transform=Ii;var Ui=function(t){function e(e,i,r,n,o){var s=t.call(this,e,i,r,n,o)||this;function a(t,e,i){return void 0===t?s.value:(null!==t&&(t=Xe.fromAny(t)),s.setState(t,e,i),s._view)}return a.__proto__=s,s=a}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;if(e)try{t=Xe.parse(e)}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(Mi);Mi.BoxShadow=Ui;var zi=function(t){function e(e,i,r,n,o){var s=t.call(this,e,i,r,n,o)||this;function a(t,e,i){return void 0===t?s.value:("string"==typeof t&&isFinite(+t)&&(t=+t),s.setState(t,e,i),s._view)}return a.__proto__=s,s=a}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;e&&(t=isFinite(+e)?+e:e)}return t},enumerable:!0,configurable:!0}),e}(Mi);Mi.NumberOrString=zi;var Fi=function(t){function e(e,i,r,n,o){var s=t.call(this,e,i,r,n,o)||this;function a(t,i,r){if(void 0===t)return s.value;if(null!==t)if("string"==typeof t)try{t=m.parse(t,e._node)}catch(t){}else t=m.fromAny(t,e._node);return s.setState(t,i,r),s._view}return a.__proto__=s,s=a}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;if(e)try{t=m.parse(e)}catch(i){t=e}}return t},enumerable:!0,configurable:!0}),e}(Mi);Mi.LengthOrString=Fi;var ji=function(t){function e(e,i,r,n,o){var s=t.call(this,e,i,r,n,o)||this;function a(t,e,i){if(void 0===t)return s.value;if(null!==t)if("string"==typeof t)try{t=C.parse(t)}catch(t){}else t=C.fromAny(t);return s.setState(t,e),s._view}return a.__proto__=s,s=a}return h(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;if(e)try{t=C.parse(e)}catch(i){t=e}}return t},enumerable:!0,configurable:!0}),e}(Mi);Mi.ColorOrString=ji;var Ni=function(){function t(){this._view=null}return Object.defineProperty(t.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),t.prototype.setView=function(t){this.willSetView(t),this._view=t,this.onSetView(t),this.didSetView(t)},t.prototype.willSetView=function(t){},t.prototype.onSetView=function(t){},t.prototype.didSetView=function(t){},t.prototype.key=function(){var t=this._view;return t?t.key():null},t.prototype.viewWillSetKey=function(t,e){},t.prototype.viewDidSetKey=function(t,e){},Object.defineProperty(t.prototype,"appView",{get:function(){var t=this._view;return t?t.appView:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appViewController",{get:function(){var t=this.appView;return t?t.viewController:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentView",{get:function(){var t=this._view;return t?t.parentView:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentViewController",{get:function(){var t=this.parentView;return t?t.viewController:null},enumerable:!0,configurable:!0}),t.prototype.viewWillSetParentView=function(t,e){},t.prototype.viewDidSetParentView=function(t,e){},Object.defineProperty(t.prototype,"childViews",{get:function(){var t=this._view;return t?t.childViews:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childViewControllers",{get:function(){return this.childViews.map(function(t){return t.viewController})},enumerable:!0,configurable:!0}),t.prototype.getChildView=function(t){var e=this._view;return e?e.getChildView(t):null},t.prototype.getChildViewController=function(t){var e=this.getChildView(t);return e?e.viewController:null},t.prototype.setChildView=function(t,e){var i=this._view;if(i)return i.setChildView(t,e);throw new Error("no view")},t.prototype.setChildViewController=function(t,e){var i=e?e.view:null;if(void 0!==i){var r=this.setChildView(t,i);return r?r.viewController:null}throw new Error("no view")},t.prototype.appendChildView=function(t){var e=this._view;if(!e)throw new Error("no view");e.appendChildView(t)},t.prototype.appendChildViewController=function(t){var e=t.view;if(!e)throw new Error("no view");this.appendChildView(e)},t.prototype.prependChildView=function(t){var e=this._view;if(!e)throw new Error("no view");e.prependChildView(t)},t.prototype.prependChildViewController=function(t){var e=t.view;if(!e)throw new Error("no view");this.prependChildView(e)},t.prototype.insertChildView=function(t,e){var i=this._view;if(!i)throw new Error("no view");i.insertChildView(t,e)},t.prototype.insertChildViewController=function(t,e){var i,r=t.view;if(i=!e||e instanceof ni?e:e.view,!r||void 0===i)throw new Error("no view");this.insertChildView(r,i)},t.prototype.viewWillInsertChildView=function(t,e,i){},t.prototype.viewDidInsertChildView=function(t,e,i){},t.prototype.removeChildView=function(t){var e=this._view;if(!e)throw new Error("no view");e.removeChildView(t)},t.prototype.removeChildViewController=function(t){var e=t.view;if(!e)throw new Error("no view");this.removeChildView(e)},t.prototype.removeAll=function(){var t=this._view;if(!t)throw new Error("no view");t.removeAll()},t.prototype.remove=function(){var t=this._view;if(!t)throw new Error("no view");t.remove()},t.prototype.viewWillRemoveChildView=function(t,e){},t.prototype.viewDidRemoveChildView=function(t,e){},t.prototype.isMounted=function(){var t=this._view;return!!t&&t.isMounted()},t.prototype.viewWillMount=function(t){},t.prototype.viewDidMount=function(t){},t.prototype.viewWillUnmount=function(t){},t.prototype.viewDidUnmount=function(t){},t.prototype.viewWillResize=function(t){},t.prototype.viewDidResize=function(t){},t.prototype.viewWillScroll=function(t){},t.prototype.viewDidScroll=function(t){},t}(),qi={is:function(t){if("object"==typeof t&&t){var e=t;return e instanceof ni&&"function"==typeof e.togglePopover&&"function"==typeof e.showPopover&&"function"==typeof e.hidePopover&&"function"==typeof e.hidePopovers}return!1}};ni.App=qi;var Bi={is:function(t){if("object"==typeof t&&t){var e=t;return e instanceof ni.Graphic||e instanceof ni&&"function"==typeof e.cascadeAnimate}return!1}};ni.Animated=Bi;var Wi={is:function(t){if("object"==typeof t&&t){var e=t;return e instanceof ni.Graphic||e instanceof ni&&"function"==typeof e.cascadeAnimate&&"function"==typeof e.cascadeRender&&"function"==typeof e.cascadeCull}return!1}};ni.Render=Wi;var Li={is:function(t){if("object"==typeof t&&t){return t instanceof ni&&"function"==typeof t.fill}return!1}},Hi={is:function(t){if("object"==typeof t&&t){var e=t;return e instanceof ni&&"function"==typeof e.stroke&&"function"==typeof e.strokeWidth}return!1}},Xi={is:function(t){if("object"==typeof t&&t){var e=t;return e instanceof ni&&"function"==typeof e.font&&"function"==typeof e.textColor&&"function"==typeof e.textAlign&&"function"==typeof e.textBaseline}return!1}},Yi=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i._key=e,i._viewController=null,i._viewObservers=[],i._parentView=null,i._childViews=[],i._bounds=n.BoxR2.empty(),i._anchor=n.PointR2.origin(),i._hidden=!1,i._culled=!1,i._dirty=!0,i._hover=!1,i._eventHandlers={},i}return h(e,t),e.prototype.key=function(t){return void 0===t?this._key:(this.willSetKey(t),this._key=t,this.onSetKey(t),this.didSetKey(t),this)},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.setViewController=function(t){this._viewController!==t&&(this.willSetViewController(t),this._viewController&&this._viewController.setView(null),this._viewController=t,this._viewController&&this._viewController.setView(this),this.onSetViewController(t),this.didSetViewController(t))},Object.defineProperty(e.prototype,"viewObservers",{get:function(){return this._viewObservers},enumerable:!0,configurable:!0}),e.prototype.addViewObserver=function(t){var e=this._viewObservers;e.indexOf(t)<0&&(this.willAddViewObserver(t),e.push(t),t.setView&&t.setView(this),this.onAddViewObserver(t),this.didAddViewObserver(t))},e.prototype.removeViewObserver=function(t){var e=this._viewObservers,i=e.indexOf(t);i>=0&&(this.willRemoveViewObserver(t),t.setView&&t.setView(null),e.splice(i,1),this.onRemoveViewObserver(t),this.didRemoveViewObserver(t))},Object.defineProperty(e.prototype,"canvasView",{get:function(){var t=this.parentView;return Wi.is(t)?t.canvasView:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentView",{get:function(){return this._parentView},enumerable:!0,configurable:!0}),e.prototype.setParentView=function(t){this.willSetParentView(t),this._parentView=t,this.onSetParentView(t),this.didSetParentView(t)},Object.defineProperty(e.prototype,"childViews",{get:function(){return this._childViews},enumerable:!0,configurable:!0}),e.prototype.getChildView=function(t){for(var e=this._childViews,i=e.length-1;i>=0;i-=1){var r=e[i];if(r.key()===t)return r}return null},e.prototype.setChildView=function(t,e){if(null!==e&&!Wi.is(e))throw new TypeError(""+e);for(var i=null,r=null,n=this._childViews,o=n.length-1;o>=0;){var s=n[o];if(s.key()===t){i=s,r=n[o+1]||null,this.willRemoveChildView(s),s.setParentView(null),n.splice(o,1),this.onRemoveChildView(s),this.didRemoveChildView(s);break}o-=1}return e&&(e.key(t),this.willInsertChildView(e,r),o>=0?n.splice(o,0,e):n.push(e),e.setParentView(this),this.onInsertChildView(e,r),this.didInsertChildView(e,r),this.setDirty(!0),this.animate()),i},e.prototype.append=function(t){return this.appendChildView(t),t},e.prototype.appendChildView=function(t){if(!Wi.is(t))throw new TypeError(""+t);this.willInsertChildView(t,null),this._childViews.push(t),t.setParentView(this),this.onInsertChildView(t,null),this.didInsertChildView(t,null),this.setDirty(!0),this.animate()},e.prototype.prepend=function(t){return this.prependChildView(t),t},e.prototype.prependChildView=function(t){if(!Wi.is(t))throw new TypeError(""+t);this.willInsertChildView(t,null),this._childViews.unshift(t),t.setParentView(this),this.onInsertChildView(t,null),this.didInsertChildView(t,null),this.setDirty(!0),this.animate()},e.prototype.insert=function(t,e){return this.insertChildView(t,e),t},e.prototype.insertChildView=function(t,e){if(!Wi.is(t))throw new TypeError(""+t);if(null!==e&&!Wi.is(t))throw new TypeError(""+e);if(null!==e&&e.parentView!==this)throw new TypeError(""+e);var i=this._childViews;this.willInsertChildView(t,e);var r=e?i.indexOf(e):-1;r>=0?i.splice(r,0,t):i.push(t),t.setParentView(this),this.onInsertChildView(t,e),this.didInsertChildView(t,e),this.setDirty(!0),this.animate()},e.prototype.onInsertChildView=function(t,e){Wi.is(t)&&(this.setChildViewBounds(t,this._bounds),this.setChildViewAnchor(t,this._anchor),this._culled&&t.setCulled(!0))},e.prototype.removeChildView=function(t){if(!Wi.is(t))throw new TypeError(""+t);if(t.parentView!==this)throw new TypeError(""+t);var e=this._childViews;this.willRemoveChildView(t),t.setParentView(null);var i=e.indexOf(t);i>=0&&e.splice(i,1),this.onRemoveChildView(t),this.didRemoveChildView(t),this.setDirty(!0),this.animate()},e.prototype.removeAll=function(){for(var t=this._childViews;;){var e=t.length;if(!(e>0))break;var i=t[e-1];this.willRemoveChildView(i),i.setParentView(null),t.pop(),this.onRemoveChildView(i),this.didRemoveChildView(i),this.setDirty(!0),this.animate()}},e.prototype.remove=function(){this._parentView&&this._parentView.removeChildView(this)},e.prototype.isMounted=function(){var t=this._parentView;return!!t&&t.isMounted()},e.prototype.cascadeMount=function(){this.willMount(),this.onMount();for(var t=this._childViews,e=0,i=t.length;e<i;e+=1){t[e].cascadeMount()}this.didMount()},e.prototype.onMount=function(){t.prototype.onMount.call(this),this.setDirty(!0)},e.prototype.cascadeUnmount=function(){this.willUnmount(),this.onUnmount();for(var t=this._childViews,e=0,i=t.length;e<i;e+=1){t[e].cascadeUnmount()}this.didUnmount()},e.prototype.cascadeResize=function(){this.willResize(),this.onResize();for(var t=this._childViews,e=0,i=t.length;e<i;e+=1){t[e].cascadeResize()}this.didResize()},e.prototype.animate=function(){var t=this._parentView;Bi.is(t)&&t.animate()},e.prototype.cascadeAnimate=function(t){this.willAnimate(t),this.onAnimate(t);for(var e=this._childViews,i=0,r=e.length;i<r;i+=1){var n=e[i];Bi.is(n)&&n.cascadeAnimate(t)}this.didAnimate(t)},e.prototype.willAnimate=function(t){this.willObserve(function(e){e.viewWillAnimate&&e.viewWillAnimate(t,this)})},e.prototype.onAnimate=function(t){},e.prototype.didAnimate=function(t){this.didObserve(function(e){e.viewDidAnimate&&e.viewDidAnimate(t,this)}),this.setDirty(!1)},e.prototype.cascadeRender=function(t){if(!this._hidden&&!this._culled){this.willRender(t),this.onRender(t);for(var e=this._childViews,i=0,r=e.length;i<r;i+=1){var n=e[i];Wi.is(n)&&n.cascadeRender(t)}this.didRender(t)}},e.prototype.willRender=function(t){this.willObserve(function(e){e.viewWillRender&&e.viewWillRender(t,this)})},e.prototype.onRender=function(t){},e.prototype.didRender=function(t){this.didObserve(function(e){e.viewDidRender&&e.viewDidRender(t,this)})},Object.defineProperty(e.prototype,"hidden",{get:function(){return this._hidden},enumerable:!0,configurable:!0}),e.prototype.setHidden=function(t){var e=this.willSetHidden(t);void 0!==e&&(t=e),this._hidden!==t&&(this._hidden=t,this.onSetHidden(t)),this.didSetHidden(t)},e.prototype.willSetHidden=function(t){var e=this._viewController;if(e){var i=e.viewWillSetHidden(t,this);void 0!==i&&(t=i)}for(var r=this._viewObservers,n=0,o=r.length;n<o;n+=1){var s=r[n];s.viewWillSetHidden&&s.viewWillSetHidden(t,this)}return t},e.prototype.onSetHidden=function(t){this.setDirty(!0)},e.prototype.didSetHidden=function(t){this.didObserve(function(e){e.viewDidSetHidden&&e.viewDidSetHidden(t,this)})},e.prototype.cascadeCull=function(){this.willCull(),this.onCull();for(var t=this._childViews,e=0,i=t.length;e<i;e+=1){var r=t[e];Wi.is(r)&&r.cascadeCull()}this.didCull()},e.prototype.willCull=function(){this.willObserve(function(t){t.viewWillCull&&t.viewWillCull(this)})},e.prototype.onCull=function(){},e.prototype.didCull=function(){this.didObserve(function(t){t.viewDidCull&&t.viewDidCull(this)})},Object.defineProperty(e.prototype,"culled",{get:function(){return this._culled},enumerable:!0,configurable:!0}),e.prototype.setCulled=function(t){var e=this.willSetCulled(t);if(void 0!==e&&(t=e),this._culled!==t){this._culled=t,this.onSetCulled(t);for(var i=this._childViews,r=0,n=i.length;r<n;r+=1){var o=i[r];Wi.is(o)&&this.setChildViewCulled(o,t)}}this.didSetCulled(t)},e.prototype.willSetCulled=function(t){var e=this._viewController;if(e){var i=e.viewWillSetCulled(t,this);void 0!==i&&(t=i)}for(var r=this._viewObservers,n=0,o=r.length;n<o;n+=1){var s=r[n];s.viewWillSetCulled&&s.viewWillSetCulled(t,this)}return t},e.prototype.onSetCulled=function(t){t||this.setDirty(!0)},e.prototype.didSetCulled=function(t){this.didObserve(function(e){e.viewDidSetCulled&&e.viewDidSetCulled(t,this)})},e.prototype.setChildViewCulled=function(t,e){t.setCulled(e)},Object.defineProperty(e.prototype,"parentTransform",{get:function(){var t=this._parentView;if(Wi.is(t)){var e=t.bounds,i=this.bounds,r=i.x-e.x,n=i.y-e.y;if(0!==r||0!==n)return B.translate(r,n)}return B.identity()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clientBounds",{get:function(){var t=this.clientTransform.inverse();return this.bounds.transform(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"popoverBounds",{get:function(){var t=this.pageTransform.inverse(),e=this.anchor.transform(t),i=Math.round(e.x),r=Math.round(e.y);return new n.BoxR2(i,r,i,r)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bounds",{get:function(){return this._bounds},enumerable:!0,configurable:!0}),e.prototype.setBounds=function(t){var e=this.willSetBounds(t);void 0!==e&&(t=e);var i=this._bounds;this._bounds=t,this.onSetBounds(t,i);for(var r=this._childViews,n=0,o=r.length;n<o;n+=1){var s=r[n];Wi.is(s)&&this.setChildViewBounds(s,t)}this.didSetBounds(t,i)},e.prototype.willSetBounds=function(t){var e=this._viewController;if(e){var i=e.viewWillSetBounds(t,this);void 0!==i&&(t=i)}for(var r=this._viewObservers,n=0,o=r.length;n<o;n+=1){var s=r[n];s.viewWillSetBounds&&s.viewWillSetBounds(t,this)}},e.prototype.onSetBounds=function(t,e){t.equals(e)||this.setDirty(!0)},e.prototype.didSetBounds=function(t,e){this.didObserve(function(i){i.viewDidSetBounds&&i.viewDidSetBounds(t,e,this)})},e.prototype.setChildViewBounds=function(t,e){t.setBounds(e)},Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},enumerable:!0,configurable:!0}),e.prototype.setAnchor=function(t){var e=this.willSetAnchor(t);void 0!==e&&(t=e);var i=this._anchor;this._anchor=t,this.onSetAnchor(t,i);for(var r=this._childViews,n=0,o=r.length;n<o;n+=1){var s=r[n];Wi.is(s)&&this.setChildViewAnchor(s,t)}this.didSetAnchor(t,i)},e.prototype.willSetAnchor=function(t){var e=this._viewController;if(e){var i=e.viewWillSetAnchor(t,this);void 0!==i&&(t=i)}for(var r=this._viewObservers,n=0,o=r.length;n<o;n+=1){var s=r[n];s.viewWillSetAnchor&&s.viewWillSetAnchor(t,this)}},e.prototype.onSetAnchor=function(t,e){},e.prototype.didSetAnchor=function(t,e){this.didObserve(function(i){i.viewDidSetAnchor&&i.viewDidSetAnchor(t,e,this)})},e.prototype.setChildViewAnchor=function(t,e){t.setAnchor(e)},Object.defineProperty(e.prototype,"pixelRatio",{get:function(){var t=this._parentView;return Wi.is(t)?t.pixelRatio:window.devicePixelRatio||1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dirty",{get:function(){return this._dirty},enumerable:!0,configurable:!0}),e.prototype.setDirty=function(t){this._dirty!==t&&(this._dirty=t,this.didSetDirty(t))},e.prototype.didSetDirty=function(t){if(t){var e=this._parentView;Wi.is(e)&&e.setDirty(t)}},Object.defineProperty(e.prototype,"hitBounds",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.hitTest=function(t,e,i){for(var r=null,n=this._childViews,o=n.length-1;o>=0;o-=1){var s=n[o];if(Wi.is(s)&&!s.culled)if((s.hitBounds||s.bounds).contains(t,e)&&null!==(r=s.hitTest(t,e,i)))break}return r},e.prototype.on=function(t,e,i){var r,n=this._eventHandlers[t],o="boolean"==typeof i?i:i&&"object"==typeof i&&i.capture||!1,s=i&&"object"==typeof i&&i.passive||!1,a=i&&"object"==typeof i&&i.once||!1;if(void 0===n)n=[r={listener:e,capture:o,passive:s,once:a}],this._eventHandlers[t]=n;else{for(var u=n.length,h=0;h<u&&((r=n[h]).listener!==e||r.capture!==o);)h+=1;h<u?(r.passive=s,r.once=a):(r={listener:e,capture:o,passive:s,once:a},n.push(r))}return this},e.prototype.off=function(t,e,i){var r=this._eventHandlers[t];if(void 0!==r)for(var n="boolean"==typeof i?i:i&&"object"==typeof i&&i.capture||!1,o=r.length,s=0;s<o;){var a=r[s];if(a.listener===e&&a.capture===n){r.splice(s,1),0===r.length&&delete this._eventHandlers[t];break}s+=1}return this},e.prototype.handleEvent=function(t){var e=t.type,i=this._eventHandlers[e];if(void 0!==i){for(var r=0;r<i.length;){var n=i[r];if(!n.capture){var o=n.listener;if("function"==typeof o?o(t):o&&"object"==typeof o&&o.handleEvent(t),n.once){i.splice(r,1);continue}}r+=1}0===i.length&&delete this._eventHandlers[e]}"mouseover"===e?this.onMouseOver(t):"mouseout"===e&&this.onMouseOut(t)},e.prototype.bubbleEvent=function(t){if(this.handleEvent(t),t.bubbles&&!t.cancelBubble){var e=this._parentView;return Wi.is(e)?e.bubbleEvent(t):e}return null},e.prototype.dispatchEvent=function(t){t.targetView=this;var e=this.bubbleEvent(t);return e?e.dispatchEvent(t):!t.cancelBubble},Object.defineProperty(e.prototype,"hover",{get:function(){return this._hover},enumerable:!0,configurable:!0}),e.prototype.onMouseOver=function(t){if(!this._hover&&(this._hover=!0,void 0!==this._eventHandlers.mouseenter)){var e=new MouseEvent("mouseenter",{clientX:t.clientX,clientY:t.clientY,screenX:t.screenX,screenY:t.screenY,bubbles:!1});e.targetView=this,e.relatedTargetView=t.relatedTargetView,this.handleEvent(e)}},e.prototype.onMouseOut=function(t){if(this._hover&&(this._hover=!1,void 0!==this._eventHandlers.mouseleave)){var e=new MouseEvent("mouseleave",{clientX:t.clientX,clientY:t.clientY,screenX:t.screenX,screenY:t.screenY,bubbles:!1});e.targetView=this,e.relatedTargetView=t.relatedTargetView,this.handleEvent(e)}},e}(ni);ni.Graphic=Yi;var Gi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),Object.defineProperty(e.prototype,"canvasView",{get:function(){var t=this._view;return t?t.canvasView:null},enumerable:!0,configurable:!0}),e.prototype.animate=function(){var t=this._view;t&&t.animate()},e.prototype.viewWillAnimate=function(t,e){},e.prototype.viewDidAnimate=function(t,e){},e.prototype.viewWillRender=function(t,e){},e.prototype.viewDidRender=function(t,e){},Object.defineProperty(e.prototype,"hidden",{get:function(){var t=this._view;return!!t&&t.hidden},enumerable:!0,configurable:!0}),e.prototype.viewWillSetHidden=function(t,e){},e.prototype.viewDidSetHidden=function(t,e){},e.prototype.viewWillCull=function(t){},e.prototype.viewDidCull=function(t){},Object.defineProperty(e.prototype,"culled",{get:function(){var t=this._view;return!!t&&t.culled},enumerable:!0,configurable:!0}),e.prototype.viewWillSetCulled=function(t,e){},e.prototype.viewDidSetCulled=function(t,e){},Object.defineProperty(e.prototype,"bounds",{get:function(){var t=this._view;return t?t.bounds:n.BoxR2.empty()},enumerable:!0,configurable:!0}),e.prototype.viewWillSetBounds=function(t,e){},e.prototype.viewDidSetBounds=function(t,e,i){},Object.defineProperty(e.prototype,"anchor",{get:function(){var t=this._view;return t?t.anchor:n.PointR2.origin()},enumerable:!0,configurable:!0}),e.prototype.viewWillSetAnchor=function(t,e){},e.prototype.viewDidSetAnchor=function(t,e,i){},Object.defineProperty(e.prototype,"dirty",{get:function(){var t=this._view;return!!t&&t.dirty},enumerable:!0,configurable:!0}),e.prototype.setDirty=function(t){var e=this._view;e&&e.setDirty(t)},e}(Ni),Ki=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i._canvas=i.createCanvas(),i}return h(e,t),Object.defineProperty(e.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.cascadeRender=function(t){var e=this.getContext();if(this.willRender(t,e),this._dirty){this.onRender(t,e);for(var i=this.childViews,r=0,n=i.length;r<n;r+=1){var o=i[r];Wi.is(o)&&o.cascadeRender(e)}}this.didRender(t,e)},e.prototype.willRender=function(e,i){t.prototype.willRender.call(this,e)},e.prototype.onRender=function(e,i){var r=this._bounds;i.clearRect(0,0,r.width,r.height),t.prototype.onRender.call(this,e)},e.prototype.didRender=function(e,i){this.copyLayerImage(e,i),t.prototype.didRender.call(this,e)},e.prototype.copyLayerImage=function(t,e){var i=this._bounds,r=this.pixelRatio,n=e.getImageData(0,0,i.width*r,i.height*r);t.putImageData(n,i.x*r,i.y*r)},Object.defineProperty(e.prototype,"parentTransform",{get:function(){return B.identity()},enumerable:!0,configurable:!0}),e.prototype.willSetBounds=function(e){var i=t.prototype.willSetBounds.call(this,e);i instanceof n.BoxR2&&(e=i);var r=Math.round(e.xMin),o=Math.round(e.yMin),s=Math.round(e.xMax),a=Math.round(e.yMax);return new n.BoxR2(r,o,s,a)},e.prototype.onSetBounds=function(t,e){t.equals(e)||(this.resizeCanvas(this._canvas,t),this.setDirty(!0))},e.prototype.setChildViewBounds=function(t,e){if(0!==e.x||0!==e.y){var i=e.width,r=e.height;e=new n.BoxR2(0,0,i,r)}t.setBounds(e)},e.prototype.setChildViewAnchor=function(t,e){var i=this._bounds,r=i.x,o=i.y;0===r&&0===o||(e=new n.PointR2(e.x-r,e.y-o)),t.setAnchor(e)},e.prototype.hitTest=function(t,e,i){var r=this.getContext(),n=this._bounds;t-=n.x,e-=n.y;for(var o=null,s=this._childViews,a=s.length-1;a>=0;a-=1){var u=s[a];if(Wi.is(u)&&u.bounds.contains(t,e)&&null!==(o=u.hitTest(t,e,r)))break}return o},e.prototype.getContext=function(){return this._canvas.getContext("2d")},e.prototype.createCanvas=function(){return document.createElement("canvas")},e.prototype.resizeCanvas=function(t,e){var i=Math.floor(e.width),r=Math.floor(e.height),n=this.pixelRatio;t.width=i*n,t.height=r*n,t.style.width=i+"px",t.style.height=r+"px",this.getContext().setTransform(n,0,0,n,0,0)},e}(Yi);ni.Layer=Ki;var Qi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e}(Gi),Zi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),Object.defineProperty(e.prototype,"node",{get:function(){var t=this._view;return t?t.node:null},enumerable:!0,configurable:!0}),e.prototype.appendChildNode=function(t){var e=this._view;if(!e)throw new Error("no view");e.appendChildNode(t)},e.prototype.prependChildNode=function(t){var e=this._view;if(!e)throw new Error("no view");e.prependChildNode(t)},e.prototype.insertChildNode=function(t,e){var i=this._view;if(!i)throw new Error("no view");i.insertChildNode(t,e)},e.prototype.viewWillInsertChildNode=function(t,e,i){},e.prototype.viewDidInsertChildNode=function(t,e,i){},e.prototype.removeChildNode=function(t){var e=this._view;if(!e)throw new Error("no view");e.removeChildNode(t)},e.prototype.viewWillRemoveChildNode=function(t,e){},e.prototype.viewDidRemoveChildNode=function(t,e){},e.prototype.viewWillAnimate=function(t,e){},e.prototype.viewDidAnimate=function(t,e){},e}(Ni),Ji=function(t){function e(e,i){return void 0===i&&(i=null),t.call(this,e,i)||this}return h(e,t),Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!0,configurable:!0}),e.prototype.initNode=function(t){},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e}(yi);ni.Text=Ji;var $i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),Object.defineProperty(e.prototype,"node",{get:function(){var t=this._view;return t?t.node:null},enumerable:!0,configurable:!0}),e}(Zi),tr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),Object.defineProperty(e.prototype,"node",{get:function(){var t=this._view;return t?t.node:null},enumerable:!0,configurable:!0}),e.prototype.isVisible=function(){var t=this._view;return!!t&&t.isVisible()},e.prototype.viewWillSetAttribute=function(t,e,i){},e.prototype.viewDidSetAttribute=function(t,e,i){},e.prototype.viewWillSetStyle=function(t,e,i,r){},e.prototype.viewDidSetStyle=function(t,e,i,r){},e}(Zi),er=function(t){function e(e,i){return void 0===i&&(i=null),t.call(this,e,i)||this}return h(e,t),Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!0,configurable:!0}),e.prototype.initNode=function(t){},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.append=function(t){return"string"==typeof t&&(t=e.fromTag(t)),t instanceof Node&&(t=ni.fromNode(t)),this.appendChildView(t),t},e.prototype.prepend=function(t){return"string"==typeof t&&(t=e.fromTag(t)),t instanceof Node&&(t=ni.fromNode(t)),this.prependChildView(t),t},e.prototype.insert=function(t,i){return"string"==typeof t&&(t=e.fromTag(t)),t instanceof Node&&(t=ni.fromNode(t)),this.insertChild(t,i),t},Object.defineProperty(e.prototype,"parentTransform",{get:function(){return this.transform()||B.identity()},enumerable:!0,configurable:!0}),e.prototype.on=function(t,e,i){return this._node.addEventListener(t,e,i),this},e.prototype.off=function(t,e,i){return this._node.removeEventListener(t,e,i),this},e.prototype.font=function(t,e,i){if(void 0===t){var r=this.fontStyle(),n=this.fontVariant(),o=this.fontWeight(),s=this.fontStretch(),a=this.fontSize(),u=this.lineHeight(),h=this.fontFamily();return null!=h?j.from(r,n,o,s,a,u,h):void 0}return null!==(t=null!==t?j.fromAny(t):null)&&null===t.style()||this.fontStyle(null!==t?t.style():null,e,i),null!==t&&null===t.variant()||this.fontVariant(null!==t?t.variant():null,e,i),null!==t&&null===t.weight()||this.fontWeight(null!==t?t.weight():null,e,i),null!==t&&null===t.stretch()||this.fontStretch(null!==t?t.stretch():null,e,i),null!==t&&null===t.size()||this.fontSize(null!==t?t.size():null,e,i),null!==t&&null===t.height()||this.lineHeight(null!==t?t.height():null,e,i),this.fontFamily(null!==t?t.family():null,e,i),this},e.fromTag=function(t){return"canvas"===t?new ni.Canvas(document.createElement(t)):new e(document.createElementNS(e.NS,t))},e.NS="http://www.w3.org/2000/svg",l([wi("alignment-baseline",String)],e.prototype,"alignmentBaseline",void 0),l([wi("clip-path",String)],e.prototype,"clipPath",void 0),l([wi("cursor",String)],e.prototype,"cursor",void 0),l([wi("cx",Number)],e.prototype,"cx",void 0),l([wi("cy",Number)],e.prototype,"cy",void 0),l([wi("d",String)],e.prototype,"d",void 0),l([wi("dx",[Number,String])],e.prototype,"dx",void 0),l([wi("dy",[Number,String])],e.prototype,"dy",void 0),l([wi("edgeMode",String)],e.prototype,"edgeMode",void 0),l([wi("fill",[C,String])],e.prototype,"fill",void 0),l([wi("fill-rule",String)],e.prototype,"fillRuke",void 0),l([wi("height",m)],e.prototype,"height",void 0),l([wi("in",String)],e.prototype,"in",void 0),l([wi("in2",String)],e.prototype,"in2",void 0),l([wi("mode",String)],e.prototype,"mode",void 0),l([wi("points",String)],e.prototype,"points",void 0),l([wi("preserveAspectRatio",Boolean)],e.prototype,"preserveAspectRatio",void 0),l([wi("r",Number)],e.prototype,"r",void 0),l([wi("result",String)],e.prototype,"result",void 0),l([wi("stdDeviation",String)],e.prototype,"stdDeviation",void 0),l([wi("stroke",[C,String])],e.prototype,"stroke",void 0),l([wi("stroke-dasharray",String)],e.prototype,"strokeDasharray",void 0),l([wi("stroke-width",Number)],e.prototype,"strokeWidth",void 0),l([wi("text-anchor",String)],e.prototype,"textAnchor",void 0),l([wi("transform",B)],e.prototype,"transform",void 0),l([wi("type",String)],e.prototype,"type",void 0),l([wi("values",String)],e.prototype,"values",void 0),l([wi("viewBox",String)],e.prototype,"viewBox",void 0),l([wi("width",m)],e.prototype,"width",void 0),l([wi("x",Number)],e.prototype,"x",void 0),l([wi("x1",Number)],e.prototype,"x1",void 0),l([wi("x2",Number)],e.prototype,"x2",void 0),l([wi("y",Number)],e.prototype,"y",void 0),l([wi("y1",Number)],e.prototype,"y1",void 0),l([wi("y2",Number)],e.prototype,"y2",void 0),l([Mi("font-family",z)],e.prototype,"fontFamily",void 0),l([Mi("font-size",[m,String])],e.prototype,"fontSize",void 0),l([Mi("font-stretch",String)],e.prototype,"fontStretch",void 0),l([Mi("font-style",String)],e.prototype,"fontStyle",void 0),l([Mi("font-variant",String)],e.prototype,"fontVariant",void 0),l([Mi("font-weight",String)],e.prototype,"fontWeight",void 0),l([Mi("line-height",U)],e.prototype,"lineHeight",void 0),e}(mi);ni.Svg=er;var ir=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),Object.defineProperty(e.prototype,"node",{get:function(){var t=this._view;return t?t.node:null},enumerable:!0,configurable:!0}),e}(tr),rr=function(t){function e(e,i){return void 0===i&&(i=null),t.call(this,e,i)||this}return h(e,t),Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!0,configurable:!0}),e.prototype.initNode=function(t){},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.append=function(t){return"string"==typeof t&&(t=e.fromTag(t)),t instanceof Node&&(t=ni.fromNode(t)),this.appendChildView(t),t},e.prototype.prepend=function(t){return"string"==typeof t&&(t=e.fromTag(t)),t instanceof Node&&(t=ni.fromNode(t)),this.prependChildView(t),t},e.prototype.insert=function(t,i){return"string"==typeof t&&(t=e.fromTag(t)),t instanceof Node&&(t=ni.fromNode(t)),this.insertChild(t,i),t},Object.defineProperty(e.prototype,"parentTransform",{get:function(){return this.transform()||B.identity()},enumerable:!0,configurable:!0}),e.prototype.on=function(t,e,i){return this._node.addEventListener(t,e,i),this},e.prototype.off=function(t,e,i){return this._node.removeEventListener(t,e,i),this},e.prototype.borderColor=function(t,e,i){if(void 0===t){var n=this.borderTopColor(),o=this.borderRightColor(),s=this.borderBottomColor(),a=this.borderLeftColor();return r.Objects.equal(n,o)&&r.Objects.equal(o,s)&&r.Objects.equal(s,a)?n:[n,o,s,a]}return Array.isArray(t)?(t.length>=1&&this.borderTopColor(t[0],e,i),t.length>=2&&this.borderRightColor(t[1],e,i),t.length>=3&&this.borderBottomColor(t[2],e,i),t.length>=4&&this.borderLeftColor(t[3],e,i)):(this.borderTopColor(t,e,i),this.borderRightColor(t,e,i),this.borderBottomColor(t,e,i),this.borderLeftColor(t,e,i)),this},e.prototype.borderRadius=function(t,e,i){if(void 0===t){var n=this.borderTopLeftRadius(),o=this.borderTopRightRadius(),s=this.borderBottomRightRadius(),a=this.borderBottomLeftRadius();return r.Objects.equal(n,o)&&r.Objects.equal(o,s)&&r.Objects.equal(s,a)?n:[n,o,s,a]}return Array.isArray(t)?(t.length>=1&&this.borderTopLeftRadius(t[0],e,i),t.length>=2&&this.borderTopRightRadius(t[1],e,i),t.length>=3&&this.borderBottomRightRadius(t[2],e,i),t.length>=4&&this.borderBottomLeftRadius(t[3],e,i)):(this.borderTopLeftRadius(t,e,i),this.borderTopRightRadius(t,e,i),this.borderBottomRightRadius(t,e,i),this.borderBottomLeftRadius(t,e,i)),this},e.prototype.borderStyle=function(t,e,i){if(void 0===t){var n=this.borderTopStyle(),o=this.borderRightStyle(),s=this.borderBottomStyle(),a=this.borderLeftStyle();return r.Objects.equal(n,o)&&r.Objects.equal(o,s)&&r.Objects.equal(s,a)?n:[n,o,s,a]}return Array.isArray(t)?(t.length>=1&&this.borderTopStyle(t[0],e,i),t.length>=2&&this.borderRightStyle(t[1],e,i),t.length>=3&&this.borderBottomStyle(t[2],e,i),t.length>=4&&this.borderLeftStyle(t[3],e,i)):(this.borderTopStyle(t,e,i),this.borderRightStyle(t,e,i),this.borderBottomStyle(t,e,i),this.borderLeftStyle(t,e,i)),this},e.prototype.borderWidth=function(t,e,i){if(void 0===t){var n=this.borderTopWidth(),o=this.borderRightWidth(),s=this.borderBottomWidth(),a=this.borderLeftWidth();return r.Objects.equal(n,o)&&r.Objects.equal(o,s)&&r.Objects.equal(s,a)?n:[n,o,s,a]}return Array.isArray(t)?(t.length>=1&&this.borderTopWidth(t[0],e,i),t.length>=2&&this.borderRightWidth(t[1],e,i),t.length>=3&&this.borderBottomWidth(t[2],e,i),t.length>=4&&this.borderLeftWidth(t[3],e,i)):(this.borderTopWidth(t,e,i),this.borderRightWidth(t,e,i),this.borderBottomWidth(t,e,i),this.borderLeftWidth(t,e,i)),this},e.prototype.font=function(t,e,i){if(void 0===t){var r=this.fontStyle(),n=this.fontVariant(),o=this.fontWeight(),s=this.fontStretch(),a=this.fontSize(),u=this.lineHeight(),h=this.fontFamily();return null!=h?j.from(r,n,o,s,a,u,h):void 0}return null!==(t=null!==t?j.fromAny(t):null)&&null===t.style()||this.fontStyle(null!==t?t.style():null,e,i),null!==t&&null===t.variant()||this.fontVariant(null!==t?t.variant():null,e,i),null!==t&&null===t.weight()||this.fontWeight(null!==t?t.weight():null,e,i),null!==t&&null===t.stretch()||this.fontStretch(null!==t?t.stretch():null,e,i),null!==t&&null===t.size()||this.fontSize(null!==t?t.size():null,e,i),null!==t&&null===t.height()||this.lineHeight(null!==t?t.height():null,e,i),this.fontFamily(null!==t?t.family():null,e,i),this},e.prototype.margin=function(t,e,i){if(void 0===t){var n=this.marginTop(),o=this.marginRight(),s=this.marginBottom(),a=this.marginLeft();return r.Objects.equal(n,o)&&r.Objects.equal(o,s)&&r.Objects.equal(s,a)?n:[n,o,s,a]}return Array.isArray(t)?(t.length>=1&&this.marginTop(t[0],e,i),t.length>=2&&this.marginRight(t[1],e,i),t.length>=3&&this.marginBottom(t[2],e,i),t.length>=4&&this.marginLeft(t[3],e,i)):(this.marginTop(t,e,i),this.marginRight(t,e,i),this.marginBottom(t,e,i),this.marginLeft(t,e,i)),this},e.prototype.padding=function(t,e,i){if(void 0===t){var n=this.paddingTop(),o=this.paddingRight(),s=this.paddingBottom(),a=this.paddingLeft();return r.Objects.equal(n,o)&&r.Objects.equal(o,s)&&r.Objects.equal(s,a)?n:[n,o,s,a]}return Array.isArray(t)?(t.length>=1&&this.paddingTop(t[0],e,i),t.length>=2&&this.paddingRight(t[1],e,i),t.length>=3&&this.paddingBottom(t[2],e,i),t.length>=4&&this.paddingLeft(t[3],e,i)):(this.paddingTop(t,e,i),this.paddingRight(t,e,i),this.paddingBottom(t,e,i),this.paddingLeft(t,e,i)),this},e.fromTag=function(t){return"svg"===t?new ni.Svg(document.createElementNS(ni.Svg.NS,t)):"canvas"===t?new ni.Canvas(document.createElement(t)):new e(document.createElement(t))},l([wi("autocomplete",String)],e.prototype,"autocomplete",void 0),l([wi("checked",Boolean)],e.prototype,"checked",void 0),l([wi("disabled",Boolean)],e.prototype,"disabled",void 0),l([wi("placeholder",String)],e.prototype,"placeholder",void 0),l([wi("selected",Boolean)],e.prototype,"selected",void 0),l([wi("title",String)],e.prototype,"title",void 0),l([wi("type",String)],e.prototype,"type",void 0),l([wi("value",String)],e.prototype,"value",void 0),l([Mi("align-content",String)],e.prototype,"alignContent",void 0),l([Mi("align-items",String)],e.prototype,"alignItems",void 0),l([Mi("align-self",String)],e.prototype,"alignSelf",void 0),l([Mi("appearance",String)],e.prototype,"appearance",void 0),l([Mi("backdrop-filter",String)],e.prototype,"backdropFilter",void 0),l([Mi("background-color",C)],e.prototype,"backgroundColor",void 0),l([Mi("border-collapse",String)],e.prototype,"borderCollapse",void 0),l([Mi("border-top-color",[C,String])],e.prototype,"borderTopColor",void 0),l([Mi("border-right-color",[C,String])],e.prototype,"borderRightColor",void 0),l([Mi("border-bottom-color",[C,String])],e.prototype,"borderBottomColor",void 0),l([Mi("border-left-color",[C,String])],e.prototype,"borderLeftColor",void 0),l([Mi("border-top-left-radius",m)],e.prototype,"borderTopLeftRadius",void 0),l([Mi("border-top-right-radius",m)],e.prototype,"borderTopRightRadius",void 0),l([Mi("border-bottom-right-radius",m)],e.prototype,"borderBottomRightRadius",void 0),l([Mi("border-bottom-left-radius",m)],e.prototype,"borderBottomLeftRadius",void 0),l([Mi("border-spacing",String)],e.prototype,"borderSpacing",void 0),l([Mi("border-top-style",String)],e.prototype,"borderTopStyle",void 0),l([Mi("border-right-style",String)],e.prototype,"borderRightStyle",void 0),l([Mi("border-bottom-style",String)],e.prototype,"borderBottomStyle",void 0),l([Mi("border-left-style",String)],e.prototype,"borderLeftStyle",void 0),l([Mi("border-top-width",[m,String])],e.prototype,"borderTopWidth",void 0),l([Mi("border-right-width",[m,String])],e.prototype,"borderRightWidth",void 0),l([Mi("border-bottom-width",[m,String])],e.prototype,"borderBottomWidth",void 0),l([Mi("border-left-width",[m,String])],e.prototype,"borderLeftWidth",void 0),l([Mi("bottom",[m,String])],e.prototype,"bottom",void 0),l([Mi("box-shadow",Xe)],e.prototype,"boxShadow",void 0),l([Mi("box-sizing",String)],e.prototype,"boxSizing",void 0),l([Mi("color",[C,String])],e.prototype,"color",void 0),l([Mi("cursor",String)],e.prototype,"cursor",void 0),l([Mi("display",String)],e.prototype,"display",void 0),l([Mi("filter",String)],e.prototype,"filter",void 0),l([Mi("flex-basis",[m,String])],e.prototype,"flexBasis",void 0),l([Mi("flex-direction",String)],e.prototype,"flexDirection",void 0),l([Mi("flex-grow",Number)],e.prototype,"flexGrow",void 0),l([Mi("flex-shrink",Number)],e.prototype,"flexShrink",void 0),l([Mi("flex-wrap",String)],e.prototype,"flexWrap",void 0),l([Mi("font-family",z)],e.prototype,"fontFamily",void 0),l([Mi("font-size",[m,String])],e.prototype,"fontSize",void 0),l([Mi("font-stretch",String)],e.prototype,"fontStretch",void 0),l([Mi("font-style",String)],e.prototype,"fontStyle",void 0),l([Mi("font-variant",String)],e.prototype,"fontVariant",void 0),l([Mi("font-weight",String)],e.prototype,"fontWeight",void 0),l([Mi("height",[m,String])],e.prototype,"height",void 0),l([Mi("justify-content",String)],e.prototype,"justifyContent",void 0),l([Mi("left",[m,String])],e.prototype,"left",void 0),l([Mi("line-height",U)],e.prototype,"lineHeight",void 0),l([Mi("margin-top",[m,String])],e.prototype,"marginTop",void 0),l([Mi("margin-right",[m,String])],e.prototype,"marginRight",void 0),l([Mi("margin-bottom",[m,String])],e.prototype,"marginBottom",void 0),l([Mi("margin-left",[m,String])],e.prototype,"marginLeft",void 0),l([Mi("max-height",[m,String])],e.prototype,"maxHeight",void 0),l([Mi("max-width",[m,String])],e.prototype,"maxWidth",void 0),l([Mi("min-height",[m,String])],e.prototype,"minHeight",void 0),l([Mi("min-width",[m,String])],e.prototype,"minWidth",void 0),l([Mi("opacity",Number)],e.prototype,"opacity",void 0),l([Mi("order",Number)],e.prototype,"order",void 0),l([Mi("outline-color",[C,String])],e.prototype,"outlineColor",void 0),l([Mi("outline-style",String)],e.prototype,"outlineStyle",void 0),l([Mi("outline-width",[m,String])],e.prototype,"outlineWidth",void 0),l([Mi("overflow",String)],e.prototype,"overflow",void 0),l([Mi("overflow-x",String)],e.prototype,"overflowX",void 0),l([Mi("overflow-y",String)],e.prototype,"overflowY",void 0),l([Mi("padding-top",m)],e.prototype,"paddingTop",void 0),l([Mi("padding-right",m)],e.prototype,"paddingRight",void 0),l([Mi("padding-bottom",m)],e.prototype,"paddingBottom",void 0),l([Mi("padding-left",m)],e.prototype,"paddingLeft",void 0),l([Mi("pointer-events",String)],e.prototype,"pointerEvents",void 0),l([Mi("position",String)],e.prototype,"position",void 0),l([Mi("right",[m,String])],e.prototype,"right",void 0),l([Mi("text-align",String)],e.prototype,"textAlign",void 0),l([Mi("text-decoration-color",[C,String])],e.prototype,"textDecorationColor",void 0),l([Mi("text-decoration-line",String)],e.prototype,"textDecorationLine",void 0),l([Mi("text-decoration-style",String)],e.prototype,"textDecorationStyle",void 0),l([Mi("text-overflow",String)],e.prototype,"textOverflow",void 0),l([Mi("text-transform",String)],e.prototype,"textTransform",void 0),l([Mi("top",[m,String])],e.prototype,"top",void 0),l([Mi("transform",B)],e.prototype,"transform",void 0),l([Mi(["user-select","-webkit-user-select","-moz-user-select","-ms-user-select"],String)],e.prototype,"userSelect",void 0),l([Mi("vertical-align",[m,String])],e.prototype,"verticalAlign",void 0),l([Mi("visibility",String)],e.prototype,"visibility",void 0),l([Mi("white-space",String)],e.prototype,"whiteSpace",void 0),l([Mi("width",[m,String])],e.prototype,"width",void 0),l([Mi("z-index",[Number,String])],e.prototype,"zIndex",void 0),e}(mi);ni.Html=rr;var nr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),Object.defineProperty(e.prototype,"node",{get:function(){var t=this._view;return t?t.node:null},enumerable:!0,configurable:!0}),e}(tr),or=function(t){function e(e,i){void 0===i&&(i=null);var r=t.call(this,e,i)||this;return r.onClick=r.onClick.bind(r),r.onDblClick=r.onDblClick.bind(r),r.onContextMenu=r.onContextMenu.bind(r),r.onMouseDown=r.onMouseDown.bind(r),r.onMouseMove=r.onMouseMove.bind(r),r.onMouseUp=r.onMouseUp.bind(r),r.onWheel=r.onWheel.bind(r),r.onTouchStart=r.onTouchStart.bind(r),r.onTouchMove=r.onTouchMove.bind(r),r.onTouchCancel=r.onTouchCancel.bind(r),r.onTouchEnd=r.onTouchEnd.bind(r),r._renderViews=[],r._bounds=n.BoxR2.empty(),r._anchor=n.PointR2.origin(),r._dirty=!0,r._clientX=0,r._clientY=0,r._screenX=0,r._screenY=0,r._hoverView=null,r._touches={},r}return h(e,t),Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!0,configurable:!0}),e.prototype.initNode=function(t){t.style.position="absolute"},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvasView",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"childViews",{get:function(){for(var t=this._node.childNodes,e=[],i=0,r=t.length;i<r;i+=1){var n=t[i].view;n&&e.push(n)}return e.push.apply(e,this._renderViews),e},enumerable:!0,configurable:!0}),e.prototype.getChildView=function(t){for(var e=this._renderViews,i=e.length-1;i>=0;i-=1){var r=e[i];if(r.key()===t)return r}var n=this._node.childNodes;for(i=n.length-1;i>=0;i-=1){var o=n[i].view;if(o&&o.key()===t)return o}return null},e.prototype.setChildView=function(e,i){return Wi.is(i)?this.setRenderView(e,i):t.prototype.setChildView.call(this,e,i)},e.prototype.setRenderView=function(t,e){if(!Wi.is(e))throw new TypeError(""+e);for(var i=null,r=null,n=this._renderViews,o=n.length-1;o>=0;){var s=n[o];if(s.key()===t){i=s,r=n[o+1]||null,this.willRemoveChildView(s),s.setParentView(null),n.splice(o,1),this.onRemoveChildView(s),this.didRemoveChildView(s);break}o-=1}return e&&(e.key(t),this.willInsertChildView(e,r),o>=0?n.splice(o,0,e):n.push(e),e.setParentView(this),this.onInsertChildView(e,r),this.didInsertChildView(e,r),this.animate()),i},Object.defineProperty(e.prototype,"renderViews",{get:function(){return this._renderViews},enumerable:!0,configurable:!0}),e.prototype.append=function(t){return"string"==typeof t&&(t=rr.fromTag(t)),t instanceof Node&&(t=ni.fromNode(t)),this.appendChildView(t),t},e.prototype.appendChildView=function(e){Wi.is(e)?this.appendRenderView(e):t.prototype.appendChildView.call(this,e)},e.prototype.appendRenderView=function(t){this.willInsertChildView(t,null),this._renderViews.push(t),t.setParentView(this),this.onInsertChildView(t,null),this.didInsertChildView(t,null),this.animate()},e.prototype.prepend=function(t){return"string"==typeof t&&(t=rr.fromTag(t)),t instanceof Node&&(t=ni.fromNode(t)),this.prependChildView(t),t},e.prototype.prependChildView=function(e){Wi.is(e)?this.prependRenderView(e):t.prototype.prependChildView.call(this,e)},e.prototype.prependRenderView=function(t){this.willInsertChildView(t,null),this._renderViews.unshift(t),t.setParentView(this),this.onInsertChildView(t,null),this.didInsertChildView(t,null),this.animate()},e.prototype.insert=function(t,e){return"string"==typeof t&&(t=rr.fromTag(t)),t instanceof Node&&(t=ni.fromNode(t)),this.insertChild(t,e),t},e.prototype.insertChildView=function(e,i){Wi.is(e)&&Wi.is(i)?this.insertRenderView(e,i):t.prototype.insertChildView.call(this,e,i)},e.prototype.insertRenderView=function(t,e){if(null!==e&&!Wi.is(e))throw new TypeError(""+e);if(null!==e&&e.parentView!==this)throw new TypeError(""+e);var i=this._renderViews;this.willInsertChildView(t,e);var r=e?i.indexOf(e):-1;r>=0?i.splice(r,0,t):i.push(t),t.setParentView(this),this.onInsertChildView(t,e),this.didInsertChildView(t,e),this.animate()},e.prototype.onInsertChildView=function(e,i){t.prototype.onInsertChildView.call(this,e,i),Wi.is(e)&&(this.setChildViewBounds(e,this._bounds),this.setChildViewAnchor(e,this._anchor))},e.prototype.removeChildView=function(e){Wi.is(e)?this.removeRenderView(e):t.prototype.removeChildView.call(this,e)},e.prototype.removeRenderView=function(t){if(t.parentView!==this)throw new TypeError(""+t);var e=this._renderViews;this.willRemoveChildView(t),t.setParentView(null);var i=e.indexOf(t);i>=0&&e.splice(i,1),this.onRemoveChildView(t),this.didRemoveChildView(t),this.animate()},e.prototype.removeAll=function(){t.prototype.removeAll.call(this);for(var e=this._renderViews;;){var i=e.length;if(!(i>0))break;var r=e[i-1];this.willRemoveChildView(r),r.setParentView(null),e.pop(),this.onRemoveChildView(r),this.didRemoveChildView(r),this.animate()}},e.prototype.cascadeMount=function(){this.willMount(),this.onMount();for(var t=this._node.childNodes,e=0,i=t.length;e<i;e+=1){var r=t[e].view;r&&r.cascadeMount()}var n=this._renderViews;for(e=0,i=n.length;e<i;e+=1){n[e].cascadeMount()}this.didMount()},e.prototype.onMount=function(){t.prototype.onMount.call(this),this.resizeCanvas(this._node),this.animate(),this.addEventListeners(this._node)},e.prototype.cascadeUnmount=function(){this.willUnmount(),this.onUnmount();for(var t=this._node.childNodes,e=0,i=t.length;e<i;e+=1){var r=t[e].view;r&&r.cascadeUnmount()}var n=this._renderViews;for(e=0,i=n.length;e<i;e+=1){n[e].cascadeUnmount()}this.didUnmount()},e.prototype.onUnmount=function(){this.removeEventListeners(this._node),this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=0),t.prototype.onUnmount.call(this)},e.prototype.cascadeResize=function(){this.willResize(),this.onResize();for(var t=this._node.childNodes,e=0,i=t.length;e<i;e+=1){var r=t[e].view;r&&r.cascadeResize()}var n=this._renderViews;for(e=0,i=n.length;e<i;e+=1){n[e].cascadeResize()}this.didResize()},e.prototype.onResize=function(){t.prototype.onResize.call(this),this.resizeCanvas(this._node),this.setDirty(!0)},e.prototype.didResize=function(){this.cascadeRender(),t.prototype.didResize.call(this)},e.prototype.onAnimationFrame=function(t){this._animationFrame=0,this.cascadeAnimate(t),this.cascadeCull(),this.cascadeRender(),this.detectMouseHover()},e.prototype.cascadeAnimate=function(t){this.willAnimate(t),this.onAnimate(t);for(var e=this._renderViews,i=0,r=e.length;i<r;i+=1){e[i].cascadeAnimate(t)}this.didAnimate(t)},e.prototype.cascadeRender=function(t){void 0===t&&(t=this.getContext()),this.willRender(t),this.onRender(t);for(var e=this._renderViews,i=0,r=e.length;i<r;i+=1){e[i].cascadeRender(t)}this.didRender(t)},e.prototype.willRender=function(t){this.willObserve(function(e){e.viewWillRender&&e.viewWillRender(t,this)})},e.prototype.onRender=function(t){var e=this._bounds;t.clearRect(0,0,e.width,e.height)},e.prototype.didRender=function(t){this.didObserve(function(e){e.viewDidRender&&e.viewDidRender(t,this)})},Object.defineProperty(e.prototype,"hidden",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.setHidden=function(t){},e.prototype.cascadeCull=function(){this.willCull(),this.onCull();for(var t=this.childViews,e=0,i=t.length;e<i;e+=1){var r=t[e];Wi.is(r)&&r.cascadeCull()}this.didCull()},e.prototype.willCull=function(){this.willObserve(function(t){t.viewWillCull&&t.viewWillCull(this)})},e.prototype.onCull=function(){},e.prototype.didCull=function(){this.didObserve(function(t){t.viewDidCull&&t.viewDidCull(this)})},Object.defineProperty(e.prototype,"culled",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.setCulled=function(t){},Object.defineProperty(e.prototype,"bounds",{get:function(){return this._bounds},enumerable:!0,configurable:!0}),e.prototype.setBounds=function(t){var e=this.willSetBounds(t);void 0!==e&&(t=e);var i=this._bounds;this._bounds=t,this.onSetBounds(t,i);for(var r=this._renderViews,n=0,o=r.length;n<o;n+=1)this.setChildViewBounds(r[n],t);this.didSetBounds(t,i)},e.prototype.willSetBounds=function(t){var e=this._viewController;if(e){var i=e.viewWillSetBounds(t,this);void 0!==i&&(t=i)}for(var r=this._viewObservers,n=0,o=r.length;n<o;n+=1){var s=r[n];s.viewWillSetBounds&&s.viewWillSetBounds(t,this)}},e.prototype.onSetBounds=function(t,e){},e.prototype.didSetBounds=function(t,e){this.didObserve(function(i){i.viewDidSetBounds&&i.viewDidSetBounds(t,e,this)})},e.prototype.setChildViewBounds=function(t,e){t.setBounds(e)},Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},enumerable:!0,configurable:!0}),e.prototype.setAnchor=function(t){var e=this.willSetAnchor(t);void 0!==e&&(t=e);var i=this._anchor;this._anchor=t,this.onSetAnchor(t,i);for(var r=this._renderViews,n=0,o=r.length;n<o;n+=1)this.setChildViewAnchor(r[n],t);this.didSetAnchor(t,i)},e.prototype.willSetAnchor=function(t){var e=this._viewController;if(e){var i=e.viewWillSetAnchor(t,this);void 0!==i&&(t=i)}for(var r=this._viewObservers,n=0,o=r.length;n<o;n+=1){var s=r[n];s.viewWillSetAnchor&&s.viewWillSetAnchor(t,this)}},e.prototype.onSetAnchor=function(t,e){},e.prototype.didSetAnchor=function(t,e){this.didObserve(function(i){i.viewDidSetAnchor&&i.viewDidSetAnchor(t,e,this)})},e.prototype.setChildViewAnchor=function(t,e){t.setAnchor(e)},Object.defineProperty(e.prototype,"pixelRatio",{get:function(){return window.devicePixelRatio||1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hitBounds",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.hitTest=function(t,e,i){void 0===i&&(i=this.getContext());for(var r=null,n=this._renderViews,o=n.length-1;o>=0;o-=1){var s=n[o];if(!s.hidden&&!s.culled)if((s.hitBounds||s.bounds).contains(t,e)&&null!==(r=s.hitTest(t,e,i)))break}return r},e.prototype.handleEvent=function(t){},e.prototype.bubbleEvent=function(t){return this},e.prototype.addEventListeners=function(t){t.addEventListener("click",this.onClick),t.addEventListener("dblclick",this.onDblClick),t.addEventListener("contextmenu",this.onContextMenu),t.addEventListener("mousedown",this.onMouseDown),window.addEventListener("mousemove",this.onMouseMove),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("wheel",this.onWheel),t.addEventListener("touchstart",this.onTouchStart),t.addEventListener("touchmove",this.onTouchMove),t.addEventListener("touchcancel",this.onTouchCancel),t.addEventListener("touchend",this.onTouchEnd)},e.prototype.removeEventListeners=function(t){t.removeEventListener("click",this.onClick),t.removeEventListener("dblclick",this.onDblClick),t.removeEventListener("contextmenu",this.onContextMenu),t.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("wheel",this.onWheel),t.removeEventListener("touchstart",this.onTouchStart),t.removeEventListener("touchmove",this.onTouchMove),t.removeEventListener("touchcancel",this.onTouchCancel),t.removeEventListener("touchend",this.onTouchEnd)},e.prototype.fireEvent=function(t,e,i){var r=this.clientBounds;if(r.contains(e,i)){var n=e-r.x,o=i-r.y,s=this.hitTest(n,o);if(s)return t.targetView=s,s.bubbleEvent(t),s}return null},e.prototype.fireMouseEvent=function(t){return this.fireEvent(t,t.clientX,t.clientY)},e.prototype.onClick=function(t){this.fireMouseEvent(t)},e.prototype.onDblClick=function(t){this.fireMouseEvent(t)},e.prototype.onContextMenu=function(t){this.fireMouseEvent(t)},e.prototype.onMouseDown=function(t){this.fireMouseEvent(t)},e.prototype.onMouseMove=function(t){this._clientX=t.clientX,this._clientY=t.clientY,this._screenX=t.screenX,this._screenY=t.screenY;var e=this._hoverView,i=this.fireMouseEvent(t);i!==this._hoverView&&this.onMouseHoverChange(i,e)},e.prototype.onMouseUp=function(t){this.fireMouseEvent(t)},e.prototype.onWheel=function(t){this.fireMouseEvent(t)},e.prototype.onMouseHoverChange=function(t,e){var i={clientX:this._clientX,clientY:this._clientY,screenX:this._screenX,screenY:this._screenY,bubbles:!0};if(e){var r=new MouseEvent("mouseout",i);r.targetView=e,r.relatedTargetView=t,e.bubbleEvent(r)}if(this._hoverView=t,t){var n=new MouseEvent("mouseover",i);n.targetView=t,n.relatedTargetView=e,t.bubbleEvent(n)}},e.prototype.detectMouseHover=function(){var t=this.clientBounds;if(t.contains(this._clientX,this._clientY)){var e=this._clientX-t.x,i=this._clientY-t.y,r=this._hoverView,n=this.hitTest(e,i);n!==this._hoverView&&this.onMouseHoverChange(n,r)}},e.prototype.fireTouchEvent=function(t,e,i){for(var r=e.changedTouches,n=0,o=r.length;n<o;n+=1){var s=r[n],a=s.targetView;if(a&&i.indexOf(a)<0){var u=new TouchEvent(t,{changedTouches:r,targetTouches:e.targetTouches,touches:e.touches,bubbles:!0});u.targetView=a;for(var h=[s],l=n+1;l<o;l+=1){var p=r[l];p.targetView===a&&h.push(p)}u.targetViewTouches=document.createTouchList.apply(document,h),a.bubbleEvent(u),i.push(a)}}},e.prototype.onTouchStart=function(t){for(var e=this.clientBounds,i=t.changedTouches,r=0,n=i.length;r<n;r+=1){var o=i[r],s=o.clientX,a=o.clientY;if(e.contains(s,a)){var u=s-e.x,h=a-e.y,l=this.hitTest(u,h);l&&(o.targetView=l)}this._touches[o.identifier]=o}this.fireTouchEvent("touchstart",t,[])},e.prototype.onTouchMove=function(t){for(var e=t.changedTouches,i=0,r=e.length;i<r;i+=1){var n=e[i],o=this._touches[n.identifier];o&&(n.targetView=o.targetView)}this.fireTouchEvent("touchmove",t,[])},e.prototype.onTouchCancel=function(t){for(var e=t.changedTouches,i=e.length,r=0;r<i;r+=1){var n=e[r],o=this._touches[n.identifier];o&&(n.targetView=o.targetView)}this.fireTouchEvent("touchcancel",t,[]);for(r=0;r<i;r+=1){n=e[r];delete this._touches[n.identifier]}},e.prototype.onTouchEnd=function(t){for(var e=t.changedTouches,i=e.length,r=0;r<i;r+=1){var n=e[r],o=this._touches[n.identifier];o&&(n.targetView=o.targetView)}this.fireTouchEvent("touchend",t,[]);for(r=0;r<i;r+=1){n=e[r];delete this._touches[n.identifier]}},e.prototype.getContext=function(){return this._node.getContext("2d")},e.prototype.resizeCanvas=function(t){var e,i,r,o=t.parentNode;if(o instanceof HTMLElement){var s=void 0;do{if((s=o.getBoundingClientRect()).width&&s.height)break;o=o.parentNode}while(o instanceof HTMLElement);e=Math.floor(s.width),i=Math.floor(s.height),r=this.pixelRatio,t.width=e*r,t.height=i*r,t.style.width=e+"px",t.style.height=i+"px"}else e=Math.floor(t.width),i=Math.floor(t.height),r=1;this.getContext().setTransform(r,0,0,r,0,0),this.setBounds(new n.BoxR2(0,0,e,i)),this.setAnchor(new n.PointR2(e/2,i/2))},e}(rr);ni.Canvas=or;var sr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),Object.defineProperty(e.prototype,"node",{get:function(){var t=this._view;return t?t.node:null},enumerable:!0,configurable:!0}),e.prototype.animate=function(){var t=this._view;t&&t.animate()},e.prototype.viewWillAnimate=function(t,e){},e.prototype.viewDidAnimate=function(t,e){},e.prototype.viewWillRender=function(t,e){},e.prototype.viewDidRender=function(t,e){},Object.defineProperty(e.prototype,"hidden",{get:function(){var t=this._view;return!!t&&t.hidden},enumerable:!0,configurable:!0}),e.prototype.viewWillSetHidden=function(t,e){},e.prototype.viewDidSetHidden=function(t,e){},e.prototype.viewWillCull=function(t){},e.prototype.viewDidCull=function(t){},Object.defineProperty(e.prototype,"culled",{get:function(){var t=this._view;return!!t&&t.culled},enumerable:!0,configurable:!0}),e.prototype.viewWillSetCulled=function(t,e){},e.prototype.viewDidSetCulled=function(t,e){},Object.defineProperty(e.prototype,"bounds",{get:function(){var t=this._view;return t?t.bounds:n.BoxR2.empty()},enumerable:!0,configurable:!0}),e.prototype.viewWillSetBounds=function(t,e){},e.prototype.viewDidSetBounds=function(t,e,i){},Object.defineProperty(e.prototype,"anchor",{get:function(){var t=this._view;return t?t.anchor:n.PointR2.origin()},enumerable:!0,configurable:!0}),e.prototype.viewWillSetAnchor=function(t,e){},e.prototype.viewDidSetAnchor=function(t,e,i){},Object.defineProperty(e.prototype,"dirty",{get:function(){var t=this._view;return!!t&&t.dirty},enumerable:!0,configurable:!0}),e.prototype.setDirty=function(t){var e=this._view;e&&e.setDirty(t)},e}(nr),ar=function(t){function e(e,i){void 0===i&&(i=null);var r=t.call(this,e,i)||this;return r.throttleResize=r.throttleResize.bind(r),r.doResize=r.doResize.bind(r),r.throttleScroll=r.throttleScroll.bind(r),r.doScroll=r.doScroll.bind(r),r.onClick=r.onClick.bind(r),r._popovers=[],r._resizeTimer=0,r._scrollTimer=0,"undefined"!=typeof window&&(window.addEventListener("resize",r.throttleResize),window.addEventListener("scroll",r.throttleScroll,{passive:!0}),window.addEventListener("click",r.onClick)),r}return h(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appView",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"popovers",{get:function(){return this._popovers},enumerable:!0,configurable:!0}),e.prototype.togglePopover=function(t,e){var i=t.popoverState;"hidden"===i||"hiding"===i?this.showPopover(t,e):"shown"!==i&&"showing"!==i||this.hidePopover(t)},e.prototype.showPopover=function(t,e){void 0===e&&(e={}),this.willShowPopover(t,e),e&&!e.multi&&this.hidePopovers(),this._popovers.indexOf(t)<0&&this._popovers.push(t);var i=t.popoverView;i&&!i.isMounted()&&this.insertPopoverView(i),this.onShowPopover(t,e),t.showPopover(!0),this.didShowPopover(t,e)},e.prototype.insertPopoverView=function(t){this.appendChildView(t)},e.prototype.willShowPopover=function(t,e){this.willObserve(function(i){i.viewWillShowPopover&&i.viewWillShowPopover(t,e,this)})},e.prototype.onShowPopover=function(t,e){},e.prototype.didShowPopover=function(t,e){this.didObserve(function(i){i.viewDidShowPopover&&i.viewDidShowPopover(t,e,this)})},e.prototype.hidePopover=function(t){var e=this._popovers,i=e.indexOf(t);i>=0&&(this.willHidePopover(t),e.splice(i,1),this.onHidePopover(t),t.hidePopover(!0),this.didHidePopover(t))},e.prototype.willHidePopover=function(t){this.willObserve(function(e){e.viewWillHidePopover&&e.viewWillHidePopover(t,this)})},e.prototype.onHidePopover=function(t){},e.prototype.didHidePopover=function(t){this.didObserve(function(e){e.viewDidHidePopover&&e.viewDidHidePopover(t,this)})},e.prototype.hidePopovers=function(){for(var t=this._popovers;t.length;){var e=t[0];this.willHidePopover(e),t.shift(),this.onHidePopover(e),e.hidePopover(!0),this.didHidePopover(e)}},e.prototype.throttleResize=function(){this._resizeTimer||(this._resizeTimer=setTimeout(this.doResize,16))},e.prototype.doResize=function(){this._resizeTimer=0,this.cascadeResize()},e.prototype.throttleScroll=function(){this._scrollTimer||(this._scrollTimer=setTimeout(this.doScroll,16))},e.prototype.doScroll=function(){this._scrollTimer=0,this.cascadeScroll()},e.prototype.onUnmount=function(){this._resizeTimer&&(clearTimeout(this._resizeTimer),this._resizeTimer=0),this._scrollTimer&&(clearTimeout(this._scrollTimer),this._scrollTimer=0),t.prototype.onUnmount.call(this)},e.prototype.onClick=function(t){this.onFallthroughClick(t)},e.prototype.onFallthroughClick=function(t){this.hidePopovers()},e}(rr),ur=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),Object.defineProperty(e.prototype,"popovers",{get:function(){var t=this._view;return t?t.popovers:[]},enumerable:!0,configurable:!0}),e.prototype.viewWillShowPopover=function(t,e,i){},e.prototype.viewDidShowPopover=function(t,e,i){},e.prototype.viewWillHidePopover=function(t,e){},e.prototype.viewDidHidePopover=function(t,e){},e}(nr),hr=function(t){function e(e,i){void 0===e&&(e=document.createElement("div")),void 0===i&&(i=null);var r=t.call(this,e,i)||this;r.arrowWidth.setState(m.fromAny(10)),r.arrowHeight.setState(m.fromAny(8)),r._source=null,r._sourceBounds=null,r._popoverState="shown",r._placement=["top","bottom","right","left","over"],r._placementBounds=null,r._popoverTransition=Ae.duration(250,xe.quadOut);var n=r.createArrow();if(n){var o=ni.fromNode(n).key("arrow");r.prependChildView(o)}return r}return h(e,t),e.prototype.createArrow=function(){var t=document.createElement("div");return t.setAttribute("class","popover-arrow"),t.style.setProperty("display","none"),t.style.setProperty("position","absolute"),t.style.setProperty("width","0"),t.style.setProperty("height","0"),t},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),e.prototype.setSource=function(t){this._source!==t&&(this.willSetSource(t),null!==this._source&&this.isMounted()&&this._source.removeViewObserver(this),this._source=t,this.onSetSource(t),null!==this._source&&this.isMounted()&&this._source.addViewObserver(this),this.didSetSource(t))},e.prototype.willSetSource=function(t){this.willObserve(function(e){e.popoverWillSetSource&&e.popoverWillSetSource(t,this)})},e.prototype.onSetSource=function(t){},e.prototype.didSetSource=function(t){this.didObserve(function(e){e.popoverDidSetSource&&e.popoverDidSetSource(t,this)})},Object.defineProperty(e.prototype,"popoverState",{get:function(){return this._popoverState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"popoverView",{get:function(){return this},enumerable:!0,configurable:!0}),e.prototype.togglePopover=function(t){"hidden"===this._popoverState||"hiding"===this._popoverState?this.showPopover(t):"shown"!==this._popoverState&&"showing"!==this._popoverState||this.hidePopover(t)},e.prototype.showPopover=function(t){"hidden"!==this._popoverState&&"hiding"!==this._popoverState||(!0===t&&(t=this._popoverTransition||void 0),t?(t=Ae.fromAny(t).onEnd(this.didShow.bind(this)),this.willShow(),this.opacity(1,t),this._node.style.setProperty("pointer-events","auto")):(this.willShow(),this.opacity(1),this.didShow()))},e.prototype.willShow=function(){this._popoverState="showing",this.willObserve(function(t){t.popoverWillShow&&t.popoverWillShow(this)})},e.prototype.didShow=function(){this._popoverState="shown",this._node.style.setProperty("pointer-events","auto"),this.didObserve(function(t){t.popoverDidShow&&t.popoverDidShow(this)})},e.prototype.hidePopover=function(t){"shown"!==this._popoverState&&"showing"!==this._popoverState||(!0===t&&(t=this._popoverTransition||void 0),t?(t=Ae.fromAny(t).onEnd(this.didHide.bind(this)),this.willHide(),this.opacity(0,t),this._node.style.setProperty("pointer-events","none")):(this.willHide(),this.opacity(0),this.didHide()))},e.prototype.willHide=function(){this._popoverState="hiding",this.willObserve(function(t){t.popoverWillHide&&t.popoverWillHide(this)})},e.prototype.didHide=function(){this._popoverState="hidden",this._node.style.setProperty("pointer-events","none"),this.didObserve(function(t){t.popoverDidHide&&t.popoverDidHide(this)})},e.prototype.placement=function(t){if(void 0===t)return this._placement;this._placement.length=0;for(var e=0,i=t.length;e<i;e+=1)this._placement.push(t[e]);return this.setDirty(!0),this},e.prototype.placementBounds=function(t){return void 0===t?this._placementBounds:(r.Objects.equal(this._placementBounds,t)||(this._placementBounds=t,this.setDirty(!0)),this)},e.prototype.popoverTransition=function(t){return void 0===t?this._popoverTransition:(this._popoverTransition=null!==t?Ae.fromAny(t):null,this)},e.prototype.onMount=function(){this._source&&this._source.addViewObserver(this)},e.prototype.onUnmount=function(){this._source&&this._source.removeViewObserver(this)},e.prototype.onResize=function(){this.place()},e.prototype.onScroll=function(){this.place()},e.prototype.onAnimate=function(t){this.arrowWidth.onFrame(t),this.arrowHeight.onFrame(t),this.place()},e.prototype.place=function(){var t=this._source,e=this._sourceBounds,i=t?t.popoverBounds:null;if(i&&this._placement.length&&(this._dirty||!i.equals(e))){this.placePopover(t,i);var r=this.getChildView("arrow");r instanceof rr&&this.placeArrow(t,i,r)}},e.prototype.placePopover=function(t,e){for(var i,r=this._node,n=r.offsetWidth,o=r.offsetHeight,s=r.getBoundingClientRect(),a=s.left-r.offsetLeft,u=s.top-r.offsetTop,h=e.left-window.pageXOffset+a,l=e.right-window.pageXOffset+a,p=e.top-window.pageYOffset+u,c=e.bottom-window.pageYOffset+u,d=e.width,f=e.height,v=h+d/2,y=p+f/2,w=this._placementBounds,g=(w?w.left:0)+a,_=(w?w.right:window.innerWidth)+a,b=(w?w.top:0)+u,x=(w?w.bottom:window.innerHeight)+u,S=g+h,A=document.body.clientWidth-(S+d),C=b+p,V=document.body.clientHeight-(C+f),P=this.arrowHeight.value.pxValue(),M=0;M<this._placement.length;M+=1){if("top"===(R=this._placement[M])&&o+P<=C){i="top";break}if("bottom"===R&&o+P<=V){i="bottom";break}if("left"===R&&n+P<=S){i="left";break}if("right"===R&&n+P<=A){i="right";break}}if(!i)for(M=0;M<this._placement.length;M+=1){var R;if("over"===(R=this._placement[M])){i="over";break}if("top"===R&&C>=V){i="top";break}if("bottom"===R&&V>=C){i="bottom";break}if("left"===R&&S>=A){i="left";break}if("right"===R&&A>=S){i="right";break}}var O=m.fromAny(r.style.getPropertyValue("max-width")||0).pxValue(),D=m.fromAny(r.style.getPropertyValue("max-height")||0).pxValue(),E=O,T=D,k=r.offsetLeft,I=r.offsetTop;"over"===i?(k=g,I=b,E=Math.max(0,_-g),T=Math.max(0,x-b)):"top"===i?(k=v-n/2<=g?g:v+n/2>=_?_-n:v-n/2,I=Math.max(b,p-(o+P)),E=Math.max(0,_-g),T=Math.max(0,c-b)):"bottom"===i?(k=v-n/2<=g?g:v+n/2>=_?_-n:v-n/2,I=Math.max(b,c+P),E=Math.max(0,_-g),T=Math.max(0,x-p)):"left"===i?(k=Math.max(g,h-(n+P)),I=y-o/2<=b?b:y+o/2>=x?x-o:y-o/2,E=Math.max(0,l-g),T=Math.max(0,x-b)):"right"===i&&(k=Math.max(g,l+P),I=y-o/2<=b?b:y+o/2>=x?x-o:y-o/2,E=Math.max(0,_-h),T=Math.max(0,x-b)),k===r.offsetLeft&&I===r.offsetTop&&E===O&&T===D||(this.willPlacePopover(i),r.style.setProperty("position","absolute"),r.style.setProperty("left",k+"px"),r.style.setProperty("top",I+"px"),r.style.setProperty("max-width",E+"px"),r.style.setProperty("max-height",T+"px"),this.onPlacePopover(i),this.didPlacePopover(i))},e.prototype.willPlacePopover=function(t){this.willObserve(function(e){e.popoverWillPlace&&e.popoverWillPlace(t,this)})},e.prototype.onPlacePopover=function(t){},e.prototype.didPlacePopover=function(t){this.didObserve(function(e){e.popoverDidPlace&&e.popoverDidPlace(t,this)})},e.prototype.placeArrow=function(t,e,i){var r=this._node,n=i._node,o=r.getBoundingClientRect(),s=o.left-r.offsetLeft,a=o.top-r.offsetTop,u=e.left-window.pageXOffset+s,h=e.top-window.pageYOffset+a,l=u+e.width/2,p=h+e.height/2,c=r.offsetLeft,d=c+r.offsetWidth,f=r.offsetTop,v=f+r.offsetHeight,y=this.backgroundColor()||C.transparent(),w=this.borderRadius(),g=w instanceof m?w.pxValue():0,_=this.arrowWidth.value.pxValue(),b=this.arrowHeight.value.pxValue(),x=c+g+_/2,S=d-g-_/2,A=f+g+_/2,V=v-g-_/2;n.style.removeProperty("top"),n.style.removeProperty("right"),n.style.removeProperty("bottom"),n.style.removeProperty("left"),n.style.removeProperty("border-left-width"),n.style.removeProperty("border-left-style"),n.style.removeProperty("border-left-color"),n.style.removeProperty("border-right-width"),n.style.removeProperty("border-right-style"),n.style.removeProperty("border-right-color"),n.style.removeProperty("border-top-width"),n.style.removeProperty("border-top-style"),n.style.removeProperty("border-top-color"),n.style.removeProperty("border-bottom-width"),n.style.removeProperty("border-bottom-style"),n.style.removeProperty("border-bottom-color"),f-b>=p&&x<=l&&l<=S?(n.style.setProperty("display","block"),n.style.setProperty("top",-b+"px"),n.style.setProperty("left",l-c-_/2+"px"),n.style.setProperty("border-left-width",_/2+"px"),n.style.setProperty("border-left-style","solid"),n.style.setProperty("border-left-color","transparent"),n.style.setProperty("border-right-width",_/2+"px"),n.style.setProperty("border-right-style","solid"),n.style.setProperty("border-right-color","transparent"),n.style.setProperty("border-bottom-width",b+"px"),n.style.setProperty("border-bottom-style","solid"),n.style.setProperty("border-bottom-color",y.toString())):v+b<=p&&x<=l&&l<=S?(n.style.setProperty("display","block"),n.style.setProperty("bottom",-b+"px"),n.style.setProperty("left",l-c-_/2+"px"),n.style.setProperty("border-left-width",_/2+"px"),n.style.setProperty("border-left-style","solid"),n.style.setProperty("border-left-color","transparent"),n.style.setProperty("border-right-width",_/2+"px"),n.style.setProperty("border-right-style","solid"),n.style.setProperty("border-right-color","transparent"),n.style.setProperty("border-top-width",b+"px"),n.style.setProperty("border-top-style","solid"),n.style.setProperty("border-top-color",y.toString())):c-b>=l&&A<=p&&p<=V?(n.style.setProperty("display","block"),n.style.setProperty("left",-b+"px"),n.style.setProperty("top",p-f-_/2+"px"),n.style.setProperty("border-top-width",_/2+"px"),n.style.setProperty("border-top-style","solid"),n.style.setProperty("border-top-color","transparent"),n.style.setProperty("border-bottom-width",_/2+"px"),n.style.setProperty("border-bottom-style","solid"),n.style.setProperty("border-bottom-color","transparent"),n.style.setProperty("border-right-width",b+"px"),n.style.setProperty("border-right-style","solid"),n.style.setProperty("border-right-color",y.toString())):d+b<=l&&A<=p&&p<=V?(n.style.setProperty("display","block"),n.style.setProperty("right",-b+"px"),n.style.setProperty("top",p-f-_/2+"px"),n.style.setProperty("border-top-width",_/2+"px"),n.style.setProperty("border-top-style","solid"),n.style.setProperty("border-top-color","transparent"),n.style.setProperty("border-bottom-width",_/2+"px"),n.style.setProperty("border-bottom-style","solid"),n.style.setProperty("border-bottom-color","transparent"),n.style.setProperty("border-left-width",b+"px"),n.style.setProperty("border-left-style","solid"),n.style.setProperty("border-left-color",y.toString())):n.style.setProperty("display","none")},e.prototype.viewDidMount=function(t){this.place()},e.prototype.viewDidUnmount=function(t){this.place()},e.prototype.viewDidResize=function(t){this.place()},e.prototype.viewDidScroll=function(t){this.place()},e.prototype.viewWillSetAttribute=function(t,e,i){this.place()},e.prototype.viewDidSetAttribute=function(t,e,i){this.place()},e.prototype.viewWillSetStyle=function(t,e,i,r){this.place()},e.prototype.viewDidSetStyle=function(t,e,i,r){this.place()},e.prototype.viewDidSetAnchor=function(t,e,i){this.place()},l([oi(m)],e.prototype,"arrowWidth",void 0),l([oi(m)],e.prototype,"arrowHeight",void 0),e}(rr),lr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),Object.defineProperty(e.prototype,"source",{get:function(){var t=this._view;return t?t.source:null},enumerable:!0,configurable:!0}),e.prototype.popoverWillSetSource=function(t,e){},e.prototype.popoverDidSetSource=function(t,e){},e.prototype.popoverWillPlace=function(t,e){},e.prototype.popoverDidPlace=function(t,e){},e.prototype.popoverWillShow=function(t){},e.prototype.popoverDidShow=function(t){},e.prototype.popoverWillHide=function(t){},e.prototype.popoverDidHide=function(t){},e}(nr),pr=function(){function t(t,e,i,r){this._x=t,this._y=e,this._width=i,this._height=r}return t.prototype.x=function(t){return void 0===t?this._x:(t=m.fromAny(t),this._x.equals(t)?this:this.copy(t,this._y,this._width,this._height))},t.prototype.y=function(t){return void 0===t?this._y:(t=m.fromAny(t),this._y.equals(t)?this:this.copy(this._x,t,this._width,this._height))},t.prototype.width=function(t){return void 0===t?this._width:(t=m.fromAny(t),this._width.equals(t)?this:this.copy(this._x,this._y,t,this._height))},t.prototype.height=function(t){return void 0===t?this._height:(t=m.fromAny(t),this._height.equals(t)?this:this.copy(this._x,this._y,this._width,t))},t.prototype.render=function(t){var e=t||new ri;if(e.rect(this._x.pxValue(),this._y.pxValue(),this._width.pxValue(),this._height.pxValue()),!t)return e.toString()},t.prototype.copy=function(e,i,r,n){return new t(e,i,r,n)},t.prototype.toAny=function(){return{x:this._x,y:this._y,width:this._width,height:this._height}},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._x.equals(e._x)&&this._y.equals(e._y)&&this._width.equals(e._width)&&this._height.equals(e._height))},t.prototype.debug=function(t){t=t.write("Rect").write(46).write("from").write(40).debug(this._x).write(", ").debug(this._y).write(", ").debug(this._width).write(", ").debug(this._height).write(41)},t.prototype.toString=function(){return e.Format.debug(this)},t.from=function(e,i,r,n){return new t(e=m.fromAny(e),i=m.fromAny(i),r=m.fromAny(r),n=m.fromAny(n))},t.fromAny=function(e){if(e instanceof t)return e;if("object"==typeof e&&e)return t.from(e.x,e.y,e.width,e.height);throw new TypeError(""+e)},t}(),cr=function(t){function e(e,i,r,n){void 0===e&&(e=m.zero()),void 0===i&&(i=m.zero()),void 0===r&&(r=m.zero()),void 0===n&&(n=m.zero());var o=t.call(this)||this;return o.x.setState(e),o.y.setState(i),o.width.setState(r),o.height.setState(n),o}return h(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return new pr(this.x.value,this.y.value,this.width.value,this.height.value)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return new pr(this.x.state,this.y.state,this.width.state,this.height.state)},enumerable:!0,configurable:!0}),e.prototype.setState=function(t,e){t instanceof pr&&(t=t.toAny()),void 0!==t.key&&this.key(t.key),void 0!==t.x&&this.x(t.x,e),void 0!==t.y&&this.y(t.y,e),void 0!==t.width&&this.width(t.width,e),void 0!==t.height&&this.height(t.height,e),void 0!==t.fill&&this.fill(t.fill,e),void 0!==t.stroke&&this.stroke(t.stroke,e),void 0!==t.strokeWidth&&this.strokeWidth(t.strokeWidth,e)},e.prototype.onAnimate=function(t){this.x.onFrame(t),this.y.onFrame(t),this.width.onFrame(t),this.height.onFrame(t),this.fill.onFrame(t),this.stroke.onFrame(t),this.strokeWidth.onFrame(t)},e.prototype.onRender=function(t){t.save(),t.beginPath(),t.rect(this.x.value.pxValue(),this.y.value.pxValue(),this.width.value.pxValue(),this.height.value.pxValue());var e=this.fill.value;e&&(t.fillStyle=e.toString(),t.fill());var i=this.stroke.value;if(i){var r=this.strokeWidth.value;if(r){var n=this._bounds,o=Math.min(n.width,n.height);t.lineWidth=r.pxValue(o)}t.strokeStyle=i.toString(),t.stroke()}t.restore()},e.prototype.hitTest=function(e,i,r){var n=t.prototype.hitTest.call(this,e,i,r);if(null===n){r.save();var o=this.pixelRatio;if(e*=o,i*=o,r.beginPath(),r.rect(this.x.value.pxValue(),this.y.value.pxValue(),this.width.value.pxValue(),this.height.value.pxValue()),this.fill.value&&r.isPointInPath(e,i))n=this;else if(this.stroke.value){var s=this.strokeWidth.value;if(s){var a=this._bounds,u=Math.min(a.width,a.height);r.lineWidth=s.pxValue(u),r.isPointInStroke(e,i)&&(n=this)}}r.restore()}return n},e.fromAny=function(t){if(t instanceof e)return t;if(t instanceof pr)return new e(t.x(),t.y(),t.width(),t.height());if("object"==typeof t&&t){var i=new e;return i.setState(t),i}throw new TypeError(""+t)},l([oi(m)],e.prototype,"x",void 0),l([oi(m)],e.prototype,"y",void 0),l([oi(m)],e.prototype,"width",void 0),l([oi(m)],e.prototype,"height",void 0),l([oi(C,"inherit")],e.prototype,"fill",void 0),l([oi(C,"inherit")],e.prototype,"stroke",void 0),l([oi(m,"inherit")],e.prototype,"strokeWidth",void 0),e}(Yi),dr=Math.PI,fr=2*dr,vr=function(){function t(t,e,i,r,n,o,s){this._innerRadius=t,this._outerRadius=e,this._startAngle=i,this._deltaAngle=r,this._padAngle=n,this._padRadius=o,this._cornerRadius=s}return t.prototype.innerRadius=function(t){return void 0===t?this._innerRadius:(t=m.fromAny(t),this._innerRadius.equals(t)?this:this.copy(t,this._outerRadius,this._startAngle,this._deltaAngle,this._padAngle,this._padRadius,this._cornerRadius))},t.prototype.outerRadius=function(t){return void 0===t?this._outerRadius:(t=m.fromAny(t),this._outerRadius.equals(t)?this:this.copy(this._innerRadius,t,this._startAngle,this._deltaAngle,this._padAngle,this._padRadius,this._cornerRadius))},t.prototype.startAngle=function(t){return void 0===t?this._startAngle:(t=a.fromAny(t),this._startAngle.equals(t)?this:this.copy(this._innerRadius,this._outerRadius,t,this._deltaAngle,this._padAngle,this._padRadius,this._cornerRadius))},t.prototype.deltaAngle=function(t){return void 0===t?this._deltaAngle:(t=a.fromAny(t),this._deltaAngle.equals(t)?this:this.copy(this._innerRadius,this._outerRadius,this._startAngle,t,this._padAngle,this._padRadius,this._cornerRadius))},t.prototype.padAngle=function(t){return void 0===t?this._padAngle:(t=a.fromAny(t),this._padAngle.equals(t)?this:this.copy(this._innerRadius,this._outerRadius,this._startAngle,this._deltaAngle,t,this._padRadius,this._cornerRadius))},t.prototype.padRadius=function(t){return void 0===t?this._padRadius:(t=null!==t?m.fromAny(t):null,r.Objects.equal(this._padRadius,t)?this:this.copy(this._innerRadius,this._outerRadius,this._startAngle,this._deltaAngle,this._padAngle,t,this._cornerRadius))},t.prototype.cornerRadius=function(t){return void 0===t?this._cornerRadius:(t=m.fromAny(t),this._cornerRadius.equals(t)?this:this.copy(this._innerRadius,this._outerRadius,this._startAngle,this._deltaAngle,this._padAngle,this._padRadius,t))},t.prototype.render=function(e,i,r){var n,o,s,a=e||new ri;r?(n=r.x,o=r.y):(n=0,o=0),i&&(s=Math.min(i.width,i.height));var u=this._innerRadius.pxValue(s),h=this._outerRadius.pxValue(s),l=this._startAngle.radValue(),p=this._deltaAngle.radValue(),c=l+p,d=p>=0;if(h<u){var f=h;h=u,u=f}if(h>1e-12)if(p>fr-1e-12)a.moveTo(n+h*Math.cos(l),o+h*Math.sin(l)),a.arc(n,o,h,l,c,!d),u>1e-12&&(a.moveTo(n+u*Math.cos(c),o+u*Math.sin(c)),a.arc(n,o,u,c,l,d));else{var v=l,y=c,m=l,w=c,g=p,_=p,b=this._padAngle.radValue()/2,x=+(b>1e-12)&&(null!==this._padRadius?this._padRadius.pxValue(s):Math.sqrt(u*u+h*h)),S=Math.min(Math.abs(h-u)/2,this._cornerRadius.pxValue(s)),A=S,C=S;if(x>1e-12){var V=Math.asin(x/u*Math.sin(b)),P=Math.asin(x/h*Math.sin(b));(g-=2*V)>1e-12?(m+=V*=d?1:-1,w-=V):(g=0,m=w=(l+c)/2),(_-=2*P)>1e-12?(v+=P*=d?1:-1,y-=P):(_=0,v=y=(l+c)/2)}var M=void 0,R=void 0,O=h*Math.cos(v),D=h*Math.sin(v),E=u*Math.cos(w),T=u*Math.sin(w),k=void 0,I=void 0;if(S>1e-12&&(k=h*Math.cos(y),I=h*Math.sin(y),M=u*Math.cos(m),R=u*Math.sin(m),p<dr)){var U=g>1e-12?t.intersect(O,D,M,R,k,I,E,T):[E,T],z=O-U[0],F=D-U[1],j=k-U[0],N=I-U[1],q=1/Math.sin(.5*Math.acos((z*j+F*N)/(Math.sqrt(z*z+F*F)*Math.sqrt(j*j+N*N)))),B=Math.sqrt(U[0]*U[0]+U[1]*U[1]);A=Math.min(S,(u-B)/(q-1)),C=Math.min(S,(h-B)/(q+1))}if(_>1e-12)if(C>1e-12){var W=t.cornerTangents(M,R,O,D,h,C,d),L=t.cornerTangents(k,I,E,T,h,C,d);a.moveTo(n+W.cx+W.x01,o+W.cy+W.y01),C<S?a.arc(n+W.cx,o+W.cy,C,Math.atan2(W.y01,W.x01),Math.atan2(L.y01,L.x01),!d):(a.arc(n+W.cx,o+W.cy,C,Math.atan2(W.y01,W.x01),Math.atan2(W.y11,W.x11),!d),a.arc(n,o,h,Math.atan2(W.cy+W.y11,W.cx+W.x11),Math.atan2(L.cy+L.y11,L.cx+L.x11),!d),a.arc(n+L.cx,o+L.cy,C,Math.atan2(L.y11,L.x11),Math.atan2(L.y01,L.x01),!d))}else a.moveTo(n+O,o+D),a.arc(n,o,h,v,y,!d);else a.moveTo(n+O,o+D);if(u>1e-12&&g>1e-12)if(A>1e-12){W=t.cornerTangents(E,T,k,I,u,-A,d),L=t.cornerTangents(O,D,M,R,u,-A,d);a.lineTo(n+W.cx+W.x01,o+W.cy+W.y01),A<S?a.arc(n+W.cx,o+W.cy,A,Math.atan2(W.y01,W.x01),Math.atan2(L.y01,L.x01),!d):(a.arc(n+W.cx,o+W.cy,A,Math.atan2(W.y01,W.x01),Math.atan2(W.y11,W.x11),!d),a.arc(n,o,u,Math.atan2(W.cy+W.y11,W.cx+W.x11),Math.atan2(L.cy+L.y11,L.cx+L.x11),d),a.arc(n+L.cx,o+L.cy,A,Math.atan2(L.y11,L.x11),Math.atan2(L.y01,L.x01),!d))}else a.arc(n,o,u,w,m,d);else a.lineTo(n+E,o+T)}else a.moveTo(n,o);if(a.closePath(),!e)return a.toString()},t.prototype.copy=function(e,i,r,n,o,s,a){return new t(e,i,r,n,o,s,a)},t.prototype.toAny=function(){return{innerRadius:this._innerRadius,outerRadius:this._outerRadius,startAngle:this._startAngle,deltaAngle:this._deltaAngle,padAngle:this._padAngle,padRadius:this._padRadius,cornerRadius:this._cornerRadius}},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._innerRadius.equals(e._innerRadius)&&this._outerRadius.equals(e._outerRadius)&&this._startAngle.equals(e._startAngle)&&this._deltaAngle.equals(e._deltaAngle)&&this._padAngle.equals(e._padAngle)&&r.Objects.equal(this._padRadius,e._padRadius)&&this._cornerRadius.equals(e._cornerRadius))},t.prototype.debug=function(t){t=t.write("Arc").write(46).write("from").write(40).write(41),this._innerRadius.isDefined()&&(t=t.write(46).write("innerRadius").write(40).debug(this._innerRadius).write(41)),this._outerRadius.isDefined()&&(t=t.write(46).write("outerRadius").write(40).debug(this._outerRadius).write(41)),this._startAngle.isDefined()&&(t=t.write(46).write("startAngle").write(40).debug(this._startAngle).write(41)),this._deltaAngle.isDefined()&&(t=t.write(46).write("deltaAngle").write(40).debug(this._deltaAngle).write(41)),this._padAngle.isDefined()&&(t=t.write(46).write("padAngle").write(40).debug(this._padAngle).write(41)),null!==this._padRadius&&(t=t.write(46).write("padRadius").write(40).debug(this._padRadius).write(41)),this._cornerRadius.isDefined()&&(t=t.write(46).write("cornerRadius").write(40).debug(this._cornerRadius).write(41))},t.prototype.toString=function(){return e.Format.debug(this)},t.from=function(e,i,r,n,o,s,u){return void 0===e&&(e=m.zero()),void 0===i&&(i=m.zero()),void 0===r&&(r=a.zero()),void 0===n&&(n=a.zero()),void 0===o&&(o=a.zero()),void 0===s&&(s=null),void 0===u&&(u=m.zero()),new t(e=m.fromAny(e),i=m.fromAny(i),r=a.fromAny(r),n=a.fromAny(n),o=a.fromAny(o),s=null!==s?m.fromAny(s):null,u=m.fromAny(u))},t.fromAny=function(e){if(e instanceof t)return e;if("object"==typeof e&&e)return t.from(e.innerRadius,e.outerRadius,e.startAngle,e.deltaAngle,e.padAngle,e.padRadius,e.cornerRadius);throw new TypeError(""+e)},t.intersect=function(t,e,i,r,n,o,s,a){var u=i-t,h=r-e,l=s-n,p=a-o,c=(l*(e-o)-p*(t-n))/(p*u-l*h);return[t+c*u,e+c*h]},t.cornerTangents=function(t,e,i,r,n,o,s){var a=t-i,u=e-r,h=(s?o:-o)/Math.sqrt(a*a+u*u),l=h*u,p=-h*a,c=t+l,d=e+p,f=i+l,v=r+p,y=(c+f)/2,m=(d+v)/2,w=f-c,g=v-d,_=w*w+g*g,b=n-o,x=c*v-f*d,S=(g<0?-1:1)*Math.sqrt(Math.max(0,b*b*_-x*x)),A=(x*g-w*S)/_,C=(-x*w-g*S)/_,V=(x*g+w*S)/_,P=(-x*w+g*S)/_,M=A-y,R=C-m,O=V-y,D=P-m;return M*M+R*R>O*O+D*D&&(A=V,C=P),{cx:A,cy:C,x01:-l,y01:-p,x11:A*(n/b-1),y11:C*(n/b-1)}},t}(),yr=function(t){function e(e,i,r,n,o,s,u){void 0===e&&(e=m.zero()),void 0===i&&(i=m.zero()),void 0===r&&(r=a.zero()),void 0===n&&(n=a.zero()),void 0===o&&(o=a.zero()),void 0===s&&(s=null),void 0===u&&(u=m.zero());var h=t.call(this)||this;return h.innerRadius.setState(e),h.outerRadius.setState(i),h.startAngle.setState(r),h.deltaAngle.setState(n),h.padAngle.setState(o),h.padRadius.setState(s),h.cornerRadius.setState(u),h}return h(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return new vr(this.innerRadius.value,this.outerRadius.value,this.startAngle.value,this.deltaAngle.value,this.padAngle.value,this.padRadius.value,this.cornerRadius.value)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return new vr(this.innerRadius.state,this.outerRadius.state,this.startAngle.state,this.deltaAngle.state,this.padAngle.state,this.padRadius.state,this.cornerRadius.state)},enumerable:!0,configurable:!0}),e.prototype.setState=function(t,e){t instanceof vr&&(t=t.toAny()),void 0!==t.key&&this.key(t.key),void 0!==t.innerRadius&&this.innerRadius(t.innerRadius,e),void 0!==t.outerRadius&&this.outerRadius(t.outerRadius,e),void 0!==t.startAngle&&this.startAngle(t.startAngle,e),void 0!==t.deltaAngle&&this.deltaAngle(t.deltaAngle,e),void 0!==t.padAngle&&this.padAngle(t.padAngle,e),void 0!==t.padRadius&&this.padRadius(t.padRadius,e),void 0!==t.cornerRadius&&this.cornerRadius(t.cornerRadius,e),void 0!==t.fill&&this.fill(t.fill,e),void 0!==t.stroke&&this.stroke(t.stroke,e),void 0!==t.strokeWidth&&this.strokeWidth(t.strokeWidth,e)},e.prototype.onAnimate=function(t){this.innerRadius.onFrame(t),this.outerRadius.onFrame(t),this.startAngle.onFrame(t),this.deltaAngle.onFrame(t),this.padAngle.onFrame(t),this.padRadius.onFrame(t),this.cornerRadius.onFrame(t),this.fill.onFrame(t),this.stroke.onFrame(t),this.strokeWidth.onFrame(t)},e.prototype.onRender=function(t){t.save();var e=this._bounds;this.value.render(t,e,this._anchor);var i=this.fill.value;i&&(t.fillStyle=i.toString(),t.fill());var r=this.stroke.value;if(r){var n=this.strokeWidth.value;if(n){var o=Math.min(e.width,e.height);t.lineWidth=n.pxValue(o)}t.strokeStyle=r.toString(),t.stroke()}t.restore()},e.prototype.hitTest=function(e,i,r){var n=t.prototype.hitTest.call(this,e,i,r);if(null===n){r.save();var o=this.pixelRatio;e*=o,i*=o,r.beginPath();var s=this._bounds;if(this.value.render(r,s,this._anchor),this.fill.value&&r.isPointInPath(e,i))n=this;else if(this.stroke.value){var a=this.strokeWidth.value;if(a){var u=Math.min(s.width,s.height);r.lineWidth=a.pxValue(u),r.isPointInStroke(e,i)&&(n=this)}}r.restore()}return n},e.from=function(t,i,r,n,o,s,u,h,l,p){void 0===t&&(t=m.zero()),void 0===i&&(i=m.zero()),void 0===r&&(r=a.zero()),void 0===n&&(n=a.zero()),void 0===o&&(o=a.zero()),void 0===s&&(s=null),void 0===u&&(u=m.zero());var c=new e(t=m.fromAny(t),i=m.fromAny(i),r=a.fromAny(r),n=a.fromAny(n),o=a.fromAny(o),s=null!==s?m.fromAny(s):null,u=m.fromAny(u));return void 0!==h&&c.fill(h),void 0!==l&&c.stroke(l),void 0!==p&&c.strokeWidth(p),c},e.fromAny=function(t){if(t instanceof e)return t;if(t instanceof vr)return new e(t.innerRadius(),t.outerRadius(),t.startAngle(),t.deltaAngle(),t.padAngle(),t.padRadius(),t.cornerRadius());if("object"==typeof t&&t){var i=new e;return i.setState(t),i}throw new TypeError(""+t)},l([oi(m)],e.prototype,"innerRadius",void 0),l([oi(m)],e.prototype,"outerRadius",void 0),l([oi(a)],e.prototype,"startAngle",void 0),l([oi(a)],e.prototype,"deltaAngle",void 0),l([oi(a)],e.prototype,"padAngle",void 0),l([oi(m)],e.prototype,"padRadius",void 0),l([oi(m)],e.prototype,"cornerRadius",void 0),l([oi(C,"inherit")],e.prototype,"fill",void 0),l([oi(C,"inherit")],e.prototype,"stroke",void 0),l([oi(m,"inherit")],e.prototype,"strokeWidth",void 0),e}(Yi),mr=function(){function t(t,e,i,r,n){this._text=t,this._font=e,this._textAlign=i,this._textBaseline=r,this._textColor=n}return t.prototype.text=function(t){return void 0===t?this._text:this._text===t?this:this.copy(t,this._font,this._textAlign,this._textBaseline,this._textColor)},t.prototype.font=function(t){return void 0===t?this._font:(t=null!==t?j.fromAny(t):null,this._font===t?this:this.copy(this._text,t,this._textAlign,this._textBaseline,this._textColor))},t.prototype.textAlign=function(t){return void 0===t?this._textAlign:this._textAlign===t?this:this.copy(this._text,this._font,t,this._textBaseline,this._textColor)},t.prototype.textBaseline=function(t){return void 0===t?this._textBaseline:this._textBaseline===t?this:this.copy(this._text,this._font,this._textAlign,t,this._textColor)},t.prototype.textColor=function(t){return void 0===t?this._textColor:(t=null!==t?C.fromAny(t):null,this._textColor===t?this:this.copy(this._text,this._font,this._textAlign,this._textBaseline,t))},t.prototype.render=function(t,e,i){t.save(),null!==this._font&&(t.font=this._font.toString()),null!==this._textAlign&&(t.textAlign=this._textAlign),null!==this._textBaseline&&(t.textBaseline=this._textBaseline),null!==this._textColor&&(t.fillStyle=this._textColor.toString()),t.fillText(this._text,i.x,i.y),t.restore()},t.prototype.copy=function(e,i,r,n,o){return new t(e,i,r,n,o)},t.prototype.toAny=function(){var t={text:this._text};return null!==this._font&&(t.font=this._font),null!==this._font&&(t.font=this._font),null!==this._textAlign&&(t.textAlign=this._textAlign),null!==this._textBaseline&&(t.textBaseline=this._textBaseline),null!==this._textColor&&(t.textColor=this._textColor),t},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._text===e._text&&r.Objects.equal(this._font,e._font)&&this._textAlign===e._textAlign&&this._textBaseline===e._textBaseline&&r.Objects.equal(this._textColor,e._textColor))},t.prototype.debug=function(t){t=t.write("TextRun").write(46).write("from").write(40).debug(this._text).write(41),null!==this._font&&(t=t.write(46).write("font").write(40).debug(this._font).write(41)),null!==this._textAlign&&(t=t.write(46).write("textAlign").write(40).debug(this._textAlign).write(41)),null!==this._textBaseline&&(t=t.write(46).write("textBaseline").write(40).debug(this._textBaseline).write(41)),null!==this._textColor&&(t=t.write(46).write("textColor").write(40).debug(this._textColor).write(41))},t.prototype.toString=function(){return e.Format.debug(this)},t.from=function(e,i,r,n,o){return void 0===i&&(i=null),void 0===r&&(r=null),void 0===n&&(n=null),void 0===o&&(o=null),new t(e,i=null!==i?j.fromAny(i):null,r,n,o=null!==o?C.fromAny(o):null)},t.fromAny=function(e){if(e instanceof t)return e;if("object"==typeof e&&e)return t.from(e.text,e.font,e.textAlign,e.textBaseline,e.textColor);if("string"==typeof e)return t.from(e);throw new TypeError(""+e)},t}(),wr=function(t){function e(e){void 0===e&&(e="");var i=t.call(this)||this;return i.text.setState(e),i}return h(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return new mr(this.text.value,this.font.value,this.textAlign.value,this.textBaseline.value,this.textColor.value)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return new mr(this.text.state,this.font.state,this.textAlign.state,this.textBaseline.state,this.textColor.state)},enumerable:!0,configurable:!0}),e.prototype.setState=function(t,e){"string"==typeof t?this.text(t,e):(t instanceof mr&&(t=t.toAny()),void 0!==t.key&&this.key(t.key),void 0!==t.text&&this.text(t.text,e),void 0!==t.font&&this.font(t.font,e),void 0!==t.textAlign&&this.textAlign(t.textAlign,e),void 0!==t.textBaseline&&this.textBaseline(t.textBaseline,e),void 0!==t.textColor&&this.textColor(t.textColor,e))},e.prototype.onAnimate=function(t){this.text.onFrame(t),this.font.onFrame(t),this.textAlign.onFrame(t),this.textBaseline.onFrame(t),this.textColor.onFrame(t)},e.prototype.onRender=function(t){t.save();var e=this._anchor,i=this.font.value;i&&(t.font=i.toString());var r=this.textAlign.value;r&&(t.textAlign=r);var n=this.textBaseline.value;n&&(t.textBaseline=n);var o=this.textColor.value;o&&(t.fillStyle=o.toString()),t.fillText(this.text.value,e.x,e.y),t.restore()},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t){var i=new e;return i.setState(t),i}if("string"==typeof t)return new e(t);throw new TypeError(""+t)},l([oi(String)],e.prototype,"text",void 0),l([oi(j,"inherit")],e.prototype,"font",void 0),l([oi(String,"inherit")],e.prototype,"textAlign",void 0),l([oi(String,"inherit")],e.prototype,"textBaseline",void 0),l([oi(C,"inherit")],e.prototype,"textColor",void 0),e}(Yi),gr=Math.cos(Math.PI/4),_r=Math.sin(Math.PI/4),br=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r.points=i.points,r}return h(e,t),e}(ke),xr=function(){function t(t,e){this.multitouch=t,this.identifier=e,this.path=[],this.t=NaN,this.cx=NaN,this.cy=NaN,this.vx=NaN,this.vy=NaN,this.ax=NaN,this.ay=NaN,this.dx=NaN,this.dy=NaN}return Object.defineProperty(t.prototype,"ghost",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.moveTo=function(t,e,i){for(this.path.push({t:t,cx:e,cy:i});this.path.length>1&&t-this.path[0].t>this.multitouch._hysteresis;)this.path.splice(0,1);this.update()},t.prototype.update=function(){var t=this.path[0],e=this.path[this.path.length-1];if(e&&e!==t){var i=e.t-t.t,r=void 0,n=void 0;if(i){var o=(r=(e.cx-t.cx)/i)*r+(n=(e.cy-t.cy)/i)*n,s=this.multitouch._velocityMax;if(s*s<o){var a=Math.sqrt(o);r=r*s/a,n=n*s/a}}else r=0,n=0;this.t=e.t,this.dx=e.cx-this.cx,this.dy=e.cy-this.cy,this.cx=e.cx,this.cy=e.cy,this.vx=r,this.vy=n}else t&&(this.t=t.t,this.dx=t.cx-this.cx,this.dy=t.cy-this.cy,this.cx=t.cx,this.cy=t.cy,this.vx=0,this.vy=0)},t}(),Sr=function(){function t(t,e,i,r,n,o,s,a,u){this.multitouch=t,this.identifier=e,this.t=i,this.cx=r,this.cy=n,this.vx=o,this.vy=s,this.ax=a,this.ay=u,this.dx=0,this.dy=0}return Object.defineProperty(t.prototype,"ghost",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.translate=function(t,e){this.cx+=t,this.cy+=e},t.prototype.update=function(t){var e=t-this.t;if(e){var i=this.vx+this.ax*e,r=void 0;i<0==this.vx<0?r=this.cx+this.vx*e+this.ax*e*e*.5:(r=this.cx-this.vx*this.vx/(2*this.ax),i=0,this.ax=0);var n=this.vy+this.ay*e,o=void 0;n<0==this.vy<0?o=this.cy+this.vy*e+this.ay*e*e*.5:(o=this.cy-this.vy*this.vy/(2*this.ay),n=0,this.ay=0),this.dx=r-this.cx,this.dy=o-this.cy,this.cx=r,this.cy=o,this.vx=i,this.vy=n,this.t=t}},t}(),Ar=function(){function t(){this._surface=null,this._tracks={},this._trackCount=0,this._ghosts={},this._ghostCount=0,this._ghostFrame=0,this._hysteresis=67,this._acceleration=.00175,this._velocityMax=1.75,this._distanceMin=10,this.onGhostFrame=this.onGhostFrame.bind(this)}return t.prototype.surface=function(t){return void 0===t?this._surface:(this._surface&&this.detach(this._surface),this._surface=t,this)},t.prototype.target=function(){for(var t=this._surface;t;){if(t instanceof mi)return t;t=t.parentView}return null},t.prototype.hysteresis=function(t){return void 0===t?this._hysteresis:(this._hysteresis=t,this)},t.prototype.acceleration=function(t){return void 0===t?this._acceleration:(this._acceleration=t,this)},t.prototype.velocityMax=function(t){return void 0===t?this._velocityMax:(this._velocityMax=t,this)},t.prototype.distanceMin=function(t){return void 0===t?this._distanceMin:(this._distanceMin=t,this)},t.prototype.wheel=function(t){return void 0!==t&&this},t.prototype.points=function(){var t=[];for(var e in this._tracks)t.push(this._tracks[e]);for(var e in this._ghosts)t.push(this._ghosts[e]);return t},t.prototype.interrupt=function(){this._ghostFrame&&(cancelAnimationFrame(this._ghostFrame),this._ghostFrame=0),this._ghostCount&&(this._ghosts={},this._ghostCount=0,this._trackCount?this.multitouchChange():this.multitouchEnd())},t.prototype.zoom=function(t,e,i){if(i){var r=Date.now(),n=this._acceleration,o=n*gr,s=n*_r,a=this._velocityMax,u=.5*a*gr,h=.5*a*_r,l=4*u*u/o,p=4*h*h/s,c=this._ghosts.zoom0,d=this._ghosts.zoom1;if(c&&d){var f=Math.abs(d.cx-c.cx)/2,v=Math.abs(d.cy-c.cy)/2,y=r-c.t,m=(i=Math.min(Math.max(-a*y,i),a*y))*f*gr/l,w=i*v*_r/p;o=o*f/l,s=s*v/p,y>0&&(c.t=r,c.cx+=m,c.cy+=w,c.vx=m/y,c.vy=w/y,c.ax=c.vx<0?o:c.vx>0?-o:0,c.ay=c.vy<0?s:c.vy>0?-s:0,c.dx=m,c.dy=w,d.t=r,d.cx-=m,d.cy-=w,d.vx=-m/y,d.vy=-w/y,d.ax=d.vx<0?o:d.vx>0?-o:0,d.ay=d.vy<0?s:d.vy>0?-s:0,d.dx=-m,d.dy=-w)}else this.interrupt(),this.multitouchStart(),i<0?(c=new Sr(this,"zoom0",r,t-l,e-p,-u,-h,o,s),d=new Sr(this,"zoom1",r,t+l,e+p,u,h,-o,-s)):(c=new Sr(this,"zoom0",r,t-l,e-p,u,h,-o,-s),d=new Sr(this,"zoom1",r,t+l,e+p,-u,-h,o,s)),this._ghosts.zoom0=c,this._ghostCount+=1,this._ghosts.zoom1=d,this._ghostCount+=1;this.multitouchChange(),this._ghostFrame&&cancelAnimationFrame(this._ghostFrame),this._ghostFrame=requestAnimationFrame(this.onGhostFrame)}},t.prototype.updateVelocity=function(t,e){var i=e[0],r=e[1],n=0;if(i&&r){n=2;var o=Math.abs(r.cx-i.cx),s=Math.abs(r.cy-i.cy);i instanceof Sr&&i.update(t),r instanceof Sr&&r.update(t);var a=Math.abs(r.cx-i.cx)/o,u=Math.abs(r.cy-i.cy)/s;i.vx*=a,i.vy*=u,i.ax*=a,i.ay*=u,r.vx*=a,r.vy*=u,r.ax*=a,r.ay*=u}for(;n<e.length;){var h=e[n];h instanceof Sr&&h.update(t),n+=1}},t.prototype.spreadVelocity=function(t){for(var e in this._ghosts){var i=this._ghosts[e];t.vx<0==i.vx<0?(t.vx=(t.vx+i.vx)/2,i.vx=(t.vx+i.vx)/2):(t.vx=(t.vx-i.vx)/2,i.vx=(i.vx-t.vx)/2),t.vy<0==i.vy<0?(t.vy=(t.vy+i.vy)/2,i.vy=(t.vy+i.vy)/2):(t.vy=(t.vy-i.vy)/2,i.vy=(i.vy-t.vy)/2)}},t.prototype.coast=function(t){if(t.vx||t.vy){this.spreadVelocity(t);var e=Math.atan2(Math.abs(t.vy),Math.abs(t.vx)),i=this._acceleration,r=(t.vx<0?i:t.vx>0?-i:0)*Math.cos(e),n=(t.vy<0?i:t.vy>0?-i:0)*Math.sin(e);if(r||n){var o=new Sr(this,t.identifier,t.t,t.cx,t.cy,t.vx,t.vy,r,n);this._ghosts[o.identifier]=o,this._ghostCount+=1,this._ghostFrame||(this._ghostFrame=requestAnimationFrame(this.onGhostFrame))}}},t.prototype.translate=function(t,e){for(var i in t=t||0,e=e||0,this._ghosts)this._ghosts[i].translate(t,e)},t.prototype.interpolate=function(t){for(var e in this._tracks)this._tracks[e].update();for(var e in this.updateVelocity(t,this.points()),this.multitouchChange(),this._ghosts){var i=this._ghosts[e];i.ax||i.ay||(delete this._ghosts[e],this._ghostCount-=1)}this._trackCount||this._ghostCount?this._ghostCount&&!this._ghostFrame&&(this._ghostFrame=requestAnimationFrame(this.onGhostFrame)):this.multitouchEnd()},t.prototype.onGhostFrame=function(t){this._ghostFrame=0,this.interpolate(Date.now())},t.prototype.multitouchStart=function(){var t=new br("multitouchstart",{bubbles:!0,cancelable:!0,composed:!0,points:this.points()});this._surface.dispatchEvent(t)},t.prototype.multitouchChange=function(){var t=new br("multitouchchange",{bubbles:!0,cancelable:!0,composed:!0,points:this.points()});this._surface.dispatchEvent(t)},t.prototype.multitouchEnd=function(){var t=new br("multitouchend",{bubbles:!0,cancelable:!0,composed:!0,points:this.points()});this._surface.dispatchEvent(t)},t.prototype.trackStart=function(t,e,i,r){this.interrupt();var n=new xr(this,t);if(this._tracks[t]=n,n.moveTo(Date.now(),e,i),this._trackCount+=1,1===this._trackCount){var o=this.target();o&&this.startTracking(o)}this.trackDidStart(n,this._surface,r)},t.prototype.trackMove=function(t,e,i,r){var n=this._tracks[t];n&&(n.moveTo(Date.now(),e,i),this.trackDidMove(n,this._surface,r))},t.prototype.trackCancel=function(t,e,i,r){var n=this._tracks[t];if(n&&(delete this._tracks[t],this._trackCount-=1,n.update(),this.trackDidCancel(n,this._surface,r),0===this._trackCount)){var o=this.target();o&&this.endTracking(o)}},t.prototype.trackEnd=function(t,e,i,r){var n=this._tracks[t];if(n&&(delete this._tracks[t],this._trackCount-=1,n.update(),this.trackDidEnd(n,this._surface,r),0===this._trackCount)){var o=this.target();o&&this.endTracking(o)}},t.prototype.trackDidStart=function(t,e,i){1===this._trackCount&&this.multitouchStart()},t.prototype.trackDidMove=function(t,e,i){this.translate(t.dx,t.dy),this.interpolate(Date.now())},t.prototype.trackDidCancel=function(t,e,i){this._trackCount||this._ghostCount||this.multitouchEnd()},t.prototype.trackDidEnd=function(t,e,i){this.coast(t),this._trackCount||this._ghostCount||this.multitouchEnd()},t.create=function(){return"undefined"!=typeof PointerEvent?new Cr:"undefined"!=typeof TouchEvent?new Vr:new Pr},t}(),Cr=function(t){function e(){var e=t.call(this)||this;return e.onPointerDown=e.onPointerDown.bind(e),e.onPointerMove=e.onPointerMove.bind(e),e.onPointerUp=e.onPointerUp.bind(e),e.onWheel=e.onWheel.bind(e),e._wheel=!0,e}return h(e,t),e.prototype.wheel=function(t){if(void 0===t)return this._wheel;if(this._wheel!==t){this._wheel=t;var e=this.target();e&&(t?e.on("wheel",this.onWheel):e.off("wheel",this.onWheel))}return this},e.prototype.attach=function(t){var e=this.target();e&&(e.on("pointerdown",this.onPointerDown),this._wheel&&e.on("wheel",this.onWheel))},e.prototype.detach=function(t){var e=this.target();e&&(e.off("pointerdown",this.onPointerDown),e.off("wheel",this.onWheel))},e.prototype.startTracking=function(t){var e=this.target();e&&(e.on("pointermove",this.onPointerMove),e.on("pointerup",this.onPointerUp))},e.prototype.endTracking=function(t){var e=this.target();e&&(e.off("pointermove",this.onPointerMove),e.off("pointerup",this.onPointerUp))},e.prototype.trackDidStart=function(e,i,r){t.prototype.trackDidStart.call(this,e,i,r);var n=this.target();n&&n.node.setPointerCapture&&n.node.setPointerCapture(+e.identifier)},e.prototype.trackDidEnd=function(e,i,r){t.prototype.trackDidEnd.call(this,e,i,r);var n=this.target();n&&n.node.releasePointerCapture&&n.node.releasePointerCapture(+e.identifier)},e.prototype.onPointerDown=function(t){this.trackStart(""+t.pointerId,t.clientX,t.clientY,t)},e.prototype.onPointerMove=function(t){this.trackMove(""+t.pointerId,t.clientX,t.clientY,t)},e.prototype.onPointerUp=function(t){this.trackEnd(""+t.pointerId,t.clientX,t.clientY,t)},e.prototype.onWheel=function(t){t.preventDefault(),this.zoom(t.clientX,t.clientY,t.deltaY)},e}(Ar),Vr=function(t){function e(){var e=t.call(this)||this;return e.onTouchStart=e.onTouchStart.bind(e),e.onTouchMove=e.onTouchMove.bind(e),e.onTouchCancel=e.onTouchCancel.bind(e),e.onTouchEnd=e.onTouchEnd.bind(e),e}return h(e,t),e.prototype.attach=function(t){var e=this.target();e&&e.on("touchstart",this.onTouchStart)},e.prototype.detach=function(t){var e=this.target();e&&e.off("touchstart",this.onTouchStart)},e.prototype.startTracking=function(t){var e=this.target();e&&(e.on("touchmove",this.onTouchMove),e.on("touchcancel",this.onTouchCancel),e.on("touchend",this.onTouchEnd))},e.prototype.endTracking=function(t){var e=this.target();e&&(e.off("touchmove",this.onTouchMove),e.off("touchcancel",this.onTouchCancel),e.off("touchend",this.onTouchEnd))},e.prototype.onTouchStart=function(t){for(var e=0;e<t.changedTouches.length;e+=1){var i=t.changedTouches[e];this.trackStart(""+i.identifier,i.clientX,i.clientY,t)}(t.changedTouches.length>1||this._trackCount>1)&&t.preventDefault()},e.prototype.onTouchMove=function(t){for(var e=0;e<t.changedTouches.length;e+=1){var i=t.changedTouches[e];this.trackMove(""+i.identifier,i.clientX,i.clientY,t)}},e.prototype.onTouchCancel=function(t){for(var e=0;e<t.changedTouches.length;e+=1){var i=t.changedTouches[e];this.trackCancel(""+i.identifier,i.clientX,i.clientY,t)}},e.prototype.onTouchEnd=function(t){for(var e=0;e<t.changedTouches.length;e+=1){var i=t.changedTouches[e];this.trackEnd(""+i.identifier,i.clientX,i.clientY,t)}},e}(Ar),Pr=function(t){function e(){var e=t.call(this)||this;return e.onMouseDown=e.onMouseDown.bind(e),e.onMouseMove=e.onMouseMove.bind(e),e.onMouseUp=e.onMouseUp.bind(e),e.onWheel=e.onWheel.bind(e),e._wheel=!0,e}return h(e,t),e.prototype.wheel=function(t){if(void 0===t)return this._wheel;if(this._wheel!==t){this._wheel=t;var e=this.target();e&&(t?e.on("wheel",this.onWheel):e.off("wheel",this.onWheel))}return this},e.prototype.attach=function(t){var e=this.target();e&&(e.on("mousedown",this.onMouseDown),this._wheel&&e.on("wheel",this.onWheel))},e.prototype.detach=function(t){var e=this.target();e&&(e.off("mousedown",this.onMouseDown),e.off("wheel",this.onWheel))},e.prototype.startTracking=function(t){document.body.addEventListener("mousemove",this.onMouseMove),document.body.addEventListener("mouseup",this.onMouseUp)},e.prototype.endTracking=function(t){document.body.removeEventListener("mousemove",this.onMouseMove),document.body.removeEventListener("mouseup",this.onMouseUp)},e.prototype.onMouseDown=function(t){this.trackStart("mouse",t.clientX,t.clientY,t)},e.prototype.onMouseMove=function(t){this.trackMove("mouse",t.clientX,t.clientY,t)},e.prototype.onMouseUp=function(t){this.trackEnd("mouse",t.clientX,t.clientY,t)},e.prototype.onWheel=function(t){t.preventDefault(),this.zoom(t.clientX,t.clientY,t.deltaY)},e}(Ar),Mr=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r.gesture=i.gesture,r.multitouch=i.multitouch,r.ruler=i.ruler,r.scale=i.scale,r}return h(e,t),e}(ke),Rr=function(){function t(){this._multitouch=null,this._ruler=null,this._scale=null,this._xMin=null,this._xMax=null,this._zMin=null,this._zMax=null,this._points=[],this.onMultitouchStart=this.onMultitouchStart.bind(this),this.onMultitouchChange=this.onMultitouchChange.bind(this),this.onMultitouchEnd=this.onMultitouchEnd.bind(this)}return t.prototype.multitouch=function(t){return void 0===t?this._multitouch:(this._multitouch&&this.detach(this._multitouch),this._multitouch=t,this)},t.prototype.hysteresis=function(t){return void 0===t?this._multitouch.hysteresis():(this._multitouch.hysteresis(t),this)},t.prototype.acceleration=function(t){return void 0===t?this._multitouch.acceleration():(this._multitouch.acceleration(t),this)},t.prototype.velocityMax=function(t){return void 0===t?this._multitouch.velocityMax():(this._multitouch.velocityMax(t),this)},t.prototype.distanceMin=function(t){return void 0===t?this._multitouch.distanceMin():(this._multitouch.distanceMin(t),this)},t.prototype.wheel=function(t){return void 0===t?this._multitouch.wheel():(this._multitouch.wheel(t),this)},t.prototype.ruler=function(t){return void 0===t?this._ruler:(this._ruler=t,this)},t.prototype.scale=function(t){if(void 0===t)return this._scale;var e=this._scale;return this._scale=t,null===e&&this.zoomBounds(!0),this},t.prototype.domainMin=function(t){return void 0===t?this._xMin:(this._xMin=t,this)},t.prototype.domainMax=function(t){return void 0===t?this._xMax:(this._xMax=t,this)},t.prototype.domainBounds=function(t,e){return void 0===t?[this._xMin,this._xMax]:void 0===e?(t=t,this._xMin=t[0],this._xMax=t[1],this):(this._xMin=t,this._xMax=e,this)},t.prototype.zoomMin=function(t){return void 0===t?this._zMin:(this._zMin=t,this)},t.prototype.zoomMax=function(t){return void 0===t?this._zMax:(this._zMax=t,this)},t.prototype.zoomBounds=function(t,e){return void 0===t?[this._zMin,this._zMax]:void 0===e?("boolean"==typeof t?this._scale instanceof Lt?(this._zMin=1e6,this._zMax=.001):this._scale instanceof Ht&&(this._zMin=864e5,this._zMax=1):(t=t,this._zMin=t[0],this._zMax=t[1]),this):(this._zMin=t,this._zMax=e,this)},t.prototype.attach=function(t){var e=this._multitouch&&this._multitouch.surface();e&&(e.on("multitouchstart",this.onMultitouchStart),e.on("multitouchchange",this.onMultitouchChange),e.on("multitouchend",this.onMultitouchEnd))},t.prototype.detach=function(t){var e=this._multitouch&&this._multitouch.surface();e&&(e.off("multitouchstart",this.onMultitouchStart),e.off("multitouchchange",this.onMultitouchChange),e.off("multitouchend",this.onMultitouchEnd))},t.prototype.createPoint=function(t){var e=this.coords(t.cx,t.cy);return{identifier:t.identifier,domainCoord:e.domainCoord,rangeCoord:e.rangeCoord}},t.prototype.updatePoint=function(t,e){e.rangeCoord=this.rangeCoord(t.cx,t.cy)},t.prototype.updatePoints=function(t){var e=this._points;t:for(var i=0;i<t.length;i+=1){for(var n=t[i],o=0;o<e.length;o+=1){var s=e[o];if(r.Objects.equal(n.identifier,s.identifier)){this.updatePoint(n,s);continue t}}var a=this.createPoint(n);e.push(a)}var u=0;t:for(;u<e.length;){for(a=e[u],i=0;i<t.length;i+=1){n=t[i];if(r.Objects.equal(a.identifier,n.identifier)){u+=1;continue t}}e.splice(u,1)}},t.prototype.clampScale=function(){var t=null!==this._xMin?this._xMin:void 0,e=null!==this._xMax?this._xMax:void 0,i=null!==this._zMin?this._zMin:void 0,r=null!==this._zMax?this._zMax:void 0,n=this._scale;if(this._scale=n.clampDomain(t,e,i,r),this._scale!==n){for(var o=0;o<this._points.length;o+=1){var s=this._points[o];s.domainCoord=this._scale.unscale(s.rangeCoord)}return!0}return!1},t.prototype.rescale=function(){var t=this._points[0],e=this._points[1],i=this._scale;if(t&&e){var r=t.domainCoord,n=t.rangeCoord,o=e.domainCoord,s=e.rangeCoord;this._scale=i.solveDomain(r,n,o,s),this.clampScale()}else if(t){r=t.domainCoord,n=t.rangeCoord;this._scale=i.solveDomain(r,n),this.clampScale()}return!i.equals(this._scale)},t.prototype.onMultitouchStart=function(t){this.scaleStart()},t.prototype.onMultitouchChange=function(t){this.updatePoints(t.points),this.rescale()&&this.scaleChange()},t.prototype.onMultitouchEnd=function(t){this.scaleEnd()},t.prototype.scaleStart=function(){var t=new Mr("scalestart",{bubbles:!0,cancelable:!0,composed:!0,gesture:this,multitouch:this._multitouch,ruler:this._ruler,scale:this._scale});this._ruler.dispatchEvent(t)},t.prototype.scaleChange=function(){var t=new Mr("scalechange",{bubbles:!0,cancelable:!0,composed:!0,gesture:this,multitouch:this._multitouch,ruler:this._ruler,scale:this._scale});this._ruler.dispatchEvent(t)},t.prototype.scaleEnd=function(){var t=new Mr("scaleend",{bubbles:!0,cancelable:!0,composed:!0,gesture:this,multitouch:this._multitouch,ruler:this._ruler,scale:this._scale});this._ruler.dispatchEvent(t),this._points.length=0},t.horizontal=function(){return new Or},t.vertical=function(){return new Dr},t}(),Or=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.coords=function(t,e){for(var i=this._ruler,r=Wi.is(i)?i.bounds.x:0;;){if(i instanceof mi){var n=t-i.node.getBoundingClientRect().left-r;return{domainCoord:this._scale.unscale(n),rangeCoord:n}}if(!i)break;i=i.parentView}throw new Error(""+this._ruler)},e.prototype.rangeCoord=function(t,e){for(var i=this._ruler,r=Wi.is(i)?i.bounds.x:0;;){if(i instanceof mi)return t-i.node.getBoundingClientRect().left-r;if(!i)break;i=i.parentView}throw new Error(""+this._ruler)},e.prototype.isParallel=function(t,e,i,r){return Math.abs(i-t)>=Math.abs(r-e)},e}(Rr),Dr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.coords=function(t,e){for(var i=this._ruler,r=Wi.is(i)?i.bounds.y:0;;){if(i instanceof mi){var n=e-i.node.getBoundingClientRect().top-r;return{domainCoord:this._scale.unscale(n),rangeCoord:n}}if(!i)break;i=i.parentView}throw new Error(""+this._ruler)},e.prototype.rangeCoord=function(t,e){for(var i=this._ruler,r=Wi.is(i)?i.bounds.y:0;;){if(i instanceof mi)return e-i.node.getBoundingClientRect().top-r;if(!i)break;i=i.parentView}throw new Error(""+this._ruler)},e.prototype.isParallel=function(t,e,i,r){return Math.abs(r-e)>=Math.abs(i-t)},e}(Rr);t.Angle=a,t.DegAngle=p,t.RadAngle=c,t.GradAngle=d,t.TurnAngle=f,t.AngleParser=v,t.AngleForm=y,t.Length=m,t.PxLength=w,t.EmLength=g,t.RemLength=_,t.PctLength=b,t.UnitlessLength=x,t.LengthParser=S,t.LengthForm=A,t.Color=C,t.RgbColor=V,t.HslColor=P,t.ColorChannel=M,t.ColorChannelParser=R,t.HexColorParser=O,t.RgbColorParser=D,t.HslColorParser=E,t.ColorParser=T,t.ColorForm=k,t.FontSize=I,t.LineHeight=U,t.FontFamily=z,t.FontFamilyParser=F,t.Font=j,t.FontParser=N,t.FontForm=q,t.Transform=B,t.IdentityTransform=W,t.TranslateTransform=L,t.ScaleTransform=H,t.RotateTransform=X,t.SkewTransform=Y,t.AffineTransform=G,t.TransformList=K,t.TranslateTransformParser=Q,t.ScaleTransformParser=Z,t.RotateTransformParser=J,t.SkewTransformParser=$,t.AffineTransformParser=tt,t.TransformListParser=et,t.TransformParser=it,t.TransformForm=rt,t.Interpolator=nt,t.StepInterpolator=ot,t.NumberInterpolator=st,t.ShapeInterpolator=at,t.DateTimeInterpolator=dt,t.AngleInterpolator=ft,t.LengthInterpolator=vt,t.ColorInterpolator=yt,t.TransformInterpolator=_t,t.StructureInterpolator=Mt,t.ArrayInterpolator=jt,t.InterpolatorInterpolator=Nt,t.InterpolatorForm=qt,t.IdentityShapeInterpolator=ut,t.PointR2Interpolator=ht,t.SegmentR2Interpolator=lt,t.BoxR2Interpolator=pt,t.CircleR2Interpolator=ct,t.IdentityColorInterpolator=mt,t.RgbColorInterpolator=wt,t.HslColorInterpolator=gt,t.IdentityTransformInterpolator=bt,t.TranslateTransformInterpolator=xt,t.ScaleTransformInterpolator=St,t.RotateTransformInterpolator=At,t.SkewTransformInterpolator=Ct,t.AffineTransformInterpolator=Vt,t.TransformListInterpolator=Pt,t.AttrInterpolator=Rt,t.SlotInterpolator=Ot,t.ValueInterpolator=Dt,t.RecordInterpolator=Et,t.NumInterpolator=Tt,t.ConditionalOperatorInterpolator=kt,t.BinaryOperatorInterpolator=It,t.UnaryOperatorInterpolator=Ut,t.InvokeOperatorInterpolator=zt,t.AbsentInterpolator=Ft,t.Scale=Bt,t.ContinuousScale=Wt,t.LinearScale=Lt,t.TimeScale=Ht,t.ScaleForm=Xt,t.ScaleInterpolator=Yt,t.LinearScaleInterpolator=Kt,t.TimeScaleInterpolator=Qt,t.Ease=xe,t.EaseForm=Se,t.Transition=Ae,t.TransitionForm=Ce,t.Animator=Pe,t.FrameAnimator=Me,t.ChildAnimator=Re,t.TweenAnimator=Oe,t.TweenFrameAnimator=De,t.TweenChildAnimator=Ee,t.PropertyAnimator=Te,t.CustomEvent=ke,t.ResizeObserver=Ue,t.BoxShadow=Xe,t.BoxShadowParser=Ye,t.BoxShadowForm=Ge,t.StyleValue=Ke,t.StyleValueParser=Ze,t.StyleValueForm=Je,t.AttributeString=$e,t.StyleString=ti,t.PathContext=ri,t.View=ni,t.ViewController=Ni,t.AppView=qi,t.AnimatedView=Bi,t.RenderView=Wi,t.FillView=Li,t.StrokeView=Hi,t.TypesetView=Xi,t.GraphicView=Yi,t.GraphicViewController=Gi,t.LayerView=Ki,t.LayerViewController=Qi,t.NodeView=yi,t.NodeViewController=Zi,t.TextView=Ji,t.TextViewController=$i,t.ElementView=mi,t.ElementViewController=tr,t.SvgView=er,t.SvgViewController=ir,t.HtmlView=rr,t.HtmlViewController=nr,t.CanvasView=or,t.CanvasViewController=sr,t.HtmlAppView=ar,t.HtmlAppViewController=ur,t.Popover={is:function(t){if("object"==typeof t&&t){var e=t;return void 0!==e.popoverState&&void 0!==e.popoverView&&"function"==typeof e.showPopover&&"function"==typeof e.hidePopover}return!1}},t.PopoverView=hr,t.PopoverViewController=lr,t.MemberAnimator=oi,t.AnyMemberAnimator=si,t.ObjectMemberAnimator=ai,t.StringMemberAnimator=ui,t.BooleanMemberAnimator=hi,t.NumberMemberAnimator=li,t.AngleMemberAnimator=pi,t.LengthMemberAnimator=ci,t.ColorMemberAnimator=di,t.FontMemberAnimator=fi,t.TransformMemberAnimator=vi,t.AttributeAnimator=wi,t.StringAttributeAnimator=gi,t.BooleanAttributeAnimator=_i,t.NumberAttributeAnimator=bi,t.LengthAttributeAnimator=xi,t.ColorAttributeAnimator=Si,t.TransformAttributeAnimator=Ai,t.NumberOrStringAttributeAnimator=Ci,t.LengthOrStringAttributeAnimator=Vi,t.ColorOrStringAttributeAnimator=Pi,t.StyleAnimator=Mi,t.StringStyleAnimator=Ri,t.NumberStyleAnimator=Oi,t.LengthStyleAnimator=Di,t.ColorStyleAnimator=Ei,t.LineHeightStyleAnimator=Ti,t.FontFamilyStyleAnimator=ki,t.TransformStyleAnimator=Ii,t.BoxShadowStyleAnimator=Ui,t.NumberOrStringStyleAnimator=zi,t.LengthOrStringStyleAnimator=Fi,t.ColorOrStringStyleAnimator=ji,t.Rect=pr,t.RectView=cr,t.Arc=vr,t.ArcView=yr,t.TextRun=mr,t.TextRunView=wr,t.MultitouchEvent=br,t.MultitouchTrack=xr,t.MultitouchGhost=Sr,t.Multitouch=Ar,t.MultitouchPointer=Cr,t.MultitouchTouch=Vr,t.MultitouchMouse=Pr,t.ScaleGestureEvent=Mr,t.ScaleGesture=Rr,t.HorizontalScaleGesture=Or,t.VerticalScaleGesture=Dr,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=swim-ui.js.map